const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-DPkcjMKf.js","assets/index-BVCjVRfm.js","assets/index-IHO7P-u2.css"])))=>i.map(i=>d[i]);
import{r as rs,t as op,u as is,v as ap,w as ce,x as Rt,y as oi,V as Yb,M as Zb,N as G,z as Xb,A as Wc,C as e0,K as t0,D as r0,E as xl,F as i0,G as n0,J as s0,L as Sl,$ as o0,O as a0,P as c0,R as u0,S as ts,T as Al,X as h0,U as l0,W as cp,Y as cr,Z as f0,a0 as Rl,a1 as un,a2 as Qe,a3 as ft,a4 as si,a5 as At,a6 as p0,a7 as hn,a8 as up,a9 as d0,aa as g0,ab as y0,ac as hp,ad as m0,ae as lp,af as fp,ag as fn,ah as Jc,ai as Oo,aj as dn,ak as v0,al as $o,am as w0,an as b0,ao as _0,ap as E0,aq as wo,ar as I0,as as P0,at as bc,au as Ol,av as x0,aw as S0,ax as A0,ay as $l,az as R0,aA as O0,aB as $0,aC as C0,aD as T0,aE as N0,aF as D0,aG as Qn,aH as pp,aI as _c,aJ as F0,aK as q0,_ as j0}from"./index-BVCjVRfm.js";import{r as dp}from"./events-DQ172AOg.js";var Xt=dp();const cu=rs(Xt),B0=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,z0=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,L0=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function U0(s,t){if(s==="__proto__"||s==="constructor"&&t&&typeof t=="object"&&"prototype"in t){M0(s);return}return t}function M0(s){console.warn(`[destr] Dropping "${s}" key to prevent prototype pollution.`)}function bo(s,t={}){if(typeof s!="string")return s;const r=s.trim();if(s[0]==='"'&&s.endsWith('"')&&!s.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!L0.test(s)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return s}try{if(B0.test(s)||z0.test(s)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(s,U0)}return JSON.parse(s)}catch(n){if(t.strict)throw n;return s}}function H0(s){return!s||typeof s.then!="function"?Promise.resolve(s):s}function rt(s,...t){try{return H0(s(...t))}catch(r){return Promise.reject(r)}}function k0(s){const t=typeof s;return s===null||t!=="object"&&t!=="function"}function V0(s){const t=Object.getPrototypeOf(s);return!t||t.isPrototypeOf(Object)}function Co(s){if(k0(s))return String(s);if(V0(s)||Array.isArray(s))return JSON.stringify(s);if(typeof s.toJSON=="function")return Co(s.toJSON());throw new Error("[unstorage] Cannot stringify value!")}const Qc="base64:";function K0(s){return typeof s=="string"?s:Qc+J0(s)}function G0(s){return typeof s!="string"||!s.startsWith(Qc)?s:W0(s.slice(Qc.length))}function W0(s){return globalThis.Buffer?Buffer.from(s,"base64"):Uint8Array.from(globalThis.atob(s),t=>t.codePointAt(0))}function J0(s){return globalThis.Buffer?Buffer.from(s).toString("base64"):globalThis.btoa(String.fromCodePoint(...s))}function St(s){var t;return s&&((t=s.split("?")[0])==null?void 0:t.replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""))||""}function Q0(...s){return St(s.join(":"))}function _o(s){return s=St(s),s?s+":":""}const Y0="memory",Z0=()=>{const s=new Map;return{name:Y0,getInstance:()=>s,hasItem(t){return s.has(t)},getItem(t){return s.get(t)??null},getItemRaw(t){return s.get(t)??null},setItem(t,r){s.set(t,r)},setItemRaw(t,r){s.set(t,r)},removeItem(t){s.delete(t)},getKeys(){return[...s.keys()]},clear(){s.clear()},dispose(){s.clear()}}};function X0(s={}){const t={mounts:{"":s.driver||Z0()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=y=>{for(const v of t.mountpoints)if(y.startsWith(v))return{base:v,relativeKey:y.slice(v.length),driver:t.mounts[v]};return{base:"",relativeKey:y,driver:t.mounts[""]}},n=(y,v)=>t.mountpoints.filter(_=>_.startsWith(y)||v&&y.startsWith(_)).map(_=>({relativeBase:y.length>_.length?y.slice(_.length):void 0,mountpoint:_,driver:t.mounts[_]})),a=(y,v)=>{if(t.watching){v=St(v);for(const _ of t.watchListeners)_(y,v)}},u=async()=>{if(!t.watching){t.watching=!0;for(const y in t.mounts)t.unwatch[y]=await Cl(t.mounts[y],a,y)}},h=async()=>{if(t.watching){for(const y in t.unwatch)await t.unwatch[y]();t.unwatch={},t.watching=!1}},p=(y,v,_)=>{const I=new Map,$=R=>{let C=I.get(R.base);return C||(C={driver:R.driver,base:R.base,items:[]},I.set(R.base,C)),C};for(const R of y){const C=typeof R=="string",V=St(C?R:R.key),ee=C?void 0:R.value,ie=C||!R.options?v:{...v,...R.options},B=r(V);$(B).items.push({key:V,value:ee,relativeKey:B.relativeKey,options:ie})}return Promise.all([...I.values()].map(R=>_(R))).then(R=>R.flat())},d={hasItem(y,v={}){y=St(y);const{relativeKey:_,driver:I}=r(y);return rt(I.hasItem,_,v)},getItem(y,v={}){y=St(y);const{relativeKey:_,driver:I}=r(y);return rt(I.getItem,_,v).then($=>bo($))},getItems(y,v={}){return p(y,v,_=>_.driver.getItems?rt(_.driver.getItems,_.items.map(I=>({key:I.relativeKey,options:I.options})),v).then(I=>I.map($=>({key:Q0(_.base,$.key),value:bo($.value)}))):Promise.all(_.items.map(I=>rt(_.driver.getItem,I.relativeKey,I.options).then($=>({key:I.key,value:bo($)})))))},getItemRaw(y,v={}){y=St(y);const{relativeKey:_,driver:I}=r(y);return I.getItemRaw?rt(I.getItemRaw,_,v):rt(I.getItem,_,v).then($=>G0($))},async setItem(y,v,_={}){if(v===void 0)return d.removeItem(y);y=St(y);const{relativeKey:I,driver:$}=r(y);$.setItem&&(await rt($.setItem,I,Co(v),_),$.watch||a("update",y))},async setItems(y,v){await p(y,v,async _=>{if(_.driver.setItems)return rt(_.driver.setItems,_.items.map(I=>({key:I.relativeKey,value:Co(I.value),options:I.options})),v);_.driver.setItem&&await Promise.all(_.items.map(I=>rt(_.driver.setItem,I.relativeKey,Co(I.value),I.options)))})},async setItemRaw(y,v,_={}){if(v===void 0)return d.removeItem(y,_);y=St(y);const{relativeKey:I,driver:$}=r(y);if($.setItemRaw)await rt($.setItemRaw,I,v,_);else if($.setItem)await rt($.setItem,I,K0(v),_);else return;$.watch||a("update",y)},async removeItem(y,v={}){typeof v=="boolean"&&(v={removeMeta:v}),y=St(y);const{relativeKey:_,driver:I}=r(y);I.removeItem&&(await rt(I.removeItem,_,v),(v.removeMeta||v.removeMata)&&await rt(I.removeItem,_+"$",v),I.watch||a("remove",y))},async getMeta(y,v={}){typeof v=="boolean"&&(v={nativeOnly:v}),y=St(y);const{relativeKey:_,driver:I}=r(y),$=Object.create(null);if(I.getMeta&&Object.assign($,await rt(I.getMeta,_,v)),!v.nativeOnly){const R=await rt(I.getItem,_+"$",v).then(C=>bo(C));R&&typeof R=="object"&&(typeof R.atime=="string"&&(R.atime=new Date(R.atime)),typeof R.mtime=="string"&&(R.mtime=new Date(R.mtime)),Object.assign($,R))}return $},setMeta(y,v,_={}){return this.setItem(y+"$",v,_)},removeMeta(y,v={}){return this.removeItem(y+"$",v)},async getKeys(y,v={}){y=_o(y);const _=n(y,!0);let I=[];const $=[];for(const R of _){const C=await rt(R.driver.getKeys,R.relativeBase,v);for(const V of C){const ee=R.mountpoint+St(V);I.some(ie=>ee.startsWith(ie))||$.push(ee)}I=[R.mountpoint,...I.filter(V=>!V.startsWith(R.mountpoint))]}return y?$.filter(R=>R.startsWith(y)&&R[R.length-1]!=="$"):$.filter(R=>R[R.length-1]!=="$")},async clear(y,v={}){y=_o(y),await Promise.all(n(y,!1).map(async _=>{if(_.driver.clear)return rt(_.driver.clear,_.relativeBase,v);if(_.driver.removeItem){const I=await _.driver.getKeys(_.relativeBase||"",v);return Promise.all(I.map($=>_.driver.removeItem($,v)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(y=>Tl(y)))},async watch(y){return await u(),t.watchListeners.push(y),async()=>{t.watchListeners=t.watchListeners.filter(v=>v!==y),t.watchListeners.length===0&&await h()}},async unwatch(){t.watchListeners=[],await h()},mount(y,v){if(y=_o(y),y&&t.mounts[y])throw new Error(`already mounted at ${y}`);return y&&(t.mountpoints.push(y),t.mountpoints.sort((_,I)=>I.length-_.length)),t.mounts[y]=v,t.watching&&Promise.resolve(Cl(v,a,y)).then(_=>{t.unwatch[y]=_}).catch(console.error),d},async unmount(y,v=!0){var _,I;y=_o(y),!(!y||!t.mounts[y])&&(t.watching&&y in t.unwatch&&((I=(_=t.unwatch)[y])==null||I.call(_),delete t.unwatch[y]),v&&await Tl(t.mounts[y]),t.mountpoints=t.mountpoints.filter($=>$!==y),delete t.mounts[y])},getMount(y=""){y=St(y)+":";const v=r(y);return{driver:v.driver,base:v.base}},getMounts(y="",v={}){return y=St(y),n(y,v.parents).map(I=>({driver:I.driver,base:I.mountpoint}))},keys:(y,v={})=>d.getKeys(y,v),get:(y,v={})=>d.getItem(y,v),set:(y,v,_={})=>d.setItem(y,v,_),has:(y,v={})=>d.hasItem(y,v),del:(y,v={})=>d.removeItem(y,v),remove:(y,v={})=>d.removeItem(y,v)};return d}function Cl(s,t,r){return s.watch?s.watch((n,a)=>t(n,r+a)):()=>{}}async function Tl(s){typeof s.dispose=="function"&&await rt(s.dispose)}function Ri(s){return new Promise((t,r)=>{s.oncomplete=s.onsuccess=()=>t(s.result),s.onabort=s.onerror=()=>r(s.error)})}function gp(s,t){const r=indexedDB.open(s);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=Ri(r);return(a,u)=>n.then(h=>u(h.transaction(t,a).objectStore(t)))}let Ec;function ns(){return Ec||(Ec=gp("keyval-store","keyval")),Ec}function Nl(s,t=ns()){return t("readonly",r=>Ri(r.get(s)))}function e1(s,t,r=ns()){return r("readwrite",n=>(n.put(t,s),Ri(n.transaction)))}function t1(s,t=ns()){return t("readwrite",r=>(r.delete(s),Ri(r.transaction)))}function r1(s=ns()){return s("readwrite",t=>(t.clear(),Ri(t.transaction)))}function i1(s,t){return s.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Ri(s.transaction)}function n1(s=ns()){return s("readonly",t=>{if(t.getAllKeys)return Ri(t.getAllKeys());const r=[];return i1(t,n=>r.push(n.key)).then(()=>r)})}const s1=s=>JSON.stringify(s,(t,r)=>typeof r=="bigint"?r.toString()+"n":r),o1=s=>{const t=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,r=s.replace(t,'$1"$2n"$3');return JSON.parse(r,(n,a)=>typeof a=="string"&&a.match(/^\d+n$/)?BigInt(a.substring(0,a.length-1)):a)};function ss(s){if(typeof s!="string")throw new Error(`Cannot safe json parse value of type ${typeof s}`);try{return o1(s)}catch{return s}}function Ai(s){return typeof s=="string"?s:s1(s)||""}const a1="idb-keyval";var c1=(s={})=>{const t=s.base&&s.base.length>0?`${s.base}:`:"",r=a=>t+a;let n;return s.dbName&&s.storeName&&(n=gp(s.dbName,s.storeName)),{name:a1,options:s,async hasItem(a){return!(typeof await Nl(r(a),n)>"u")},async getItem(a){return await Nl(r(a),n)??null},setItem(a,u){return e1(r(a),u,n)},removeItem(a){return t1(r(a),n)},getKeys(){return n1(n)},clear(){return r1(n)}}};const u1="WALLET_CONNECT_V2_INDEXED_DB",h1="keyvaluestorage";let l1=class{constructor(){this.indexedDb=X0({driver:c1({dbName:u1,storeName:h1})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,Ai(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var Ic=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},To={exports:{}};(function(){let s;function t(){}s=t,s.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},s.prototype.setItem=function(r,n){this[r]=String(n)},s.prototype.removeItem=function(r){delete this[r]},s.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},s.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},s.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ic<"u"&&Ic.localStorage?To.exports=Ic.localStorage:typeof window<"u"&&window.localStorage?To.exports=window.localStorage:To.exports=new t})();function f1(s){var t;return[s[0],ss((t=s[1])!=null?t:"")]}let p1=class{constructor(){this.localStorage=To.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(f1)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return ss(r)}async setItem(t,r){this.localStorage.setItem(t,Ai(r))}async removeItem(t){this.localStorage.removeItem(t)}};const d1="wc_storage_version",Dl=1,g1=async(s,t,r)=>{const n=d1,a=await t.getItem(n);if(a&&a>=Dl){r(t);return}const u=await s.getKeys();if(!u.length){r(t);return}const h=[];for(;u.length;){const p=u.shift();if(!p)continue;const d=p.toLowerCase();if(d.includes("wc@")||d.includes("walletconnect")||d.includes("wc_")||d.includes("wallet_connect")){const y=await s.getItem(p);await t.setItem(p,y),h.push(p)}}await t.setItem(n,Dl),r(t),y1(s,h)},y1=async(s,t)=>{t.length&&t.forEach(async r=>{await s.removeItem(r)})};let m1=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new p1;this.storage=t;try{const r=new l1;g1(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var Pc={},Mn={},xc={},Hn={};class Oi{}const v1=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Oi},Symbol.toStringTag,{value:"Module"})),w1=op(v1);var Fl;function b1(){if(Fl)return Hn;Fl=1,Object.defineProperty(Hn,"__esModule",{value:!0}),Hn.IHeartBeat=void 0;const s=w1;class t extends s.IEvents{constructor(n){super()}}return Hn.IHeartBeat=t,Hn}var ql;function yp(){return ql||(ql=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),is.__exportStar(b1(),s)}(xc)),xc}var Sc={},xi={},jl;function _1(){if(jl)return xi;jl=1,Object.defineProperty(xi,"__esModule",{value:!0}),xi.HEARTBEAT_EVENTS=xi.HEARTBEAT_INTERVAL=void 0;const s=ap();return xi.HEARTBEAT_INTERVAL=s.FIVE_SECONDS,xi.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},xi}var Bl;function mp(){return Bl||(Bl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),is.__exportStar(_1(),s)}(Sc)),Sc}var zl;function E1(){if(zl)return Mn;zl=1,Object.defineProperty(Mn,"__esModule",{value:!0}),Mn.HeartBeat=void 0;const s=is,t=dp(),r=ap(),n=yp(),a=mp();class u extends n.IHeartBeat{constructor(p){super(p),this.events=new t.EventEmitter,this.interval=a.HEARTBEAT_INTERVAL,this.interval=(p==null?void 0:p.interval)||a.HEARTBEAT_INTERVAL}static init(p){return s.__awaiter(this,void 0,void 0,function*(){const d=new u(p);return yield d.init(),d})}init(){return s.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(p,d){this.events.on(p,d)}once(p,d){this.events.once(p,d)}off(p,d){this.events.off(p,d)}removeListener(p,d){this.events.removeListener(p,d)}initialize(){return s.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(a.HEARTBEAT_EVENTS.pulse)}}return Mn.HeartBeat=u,Mn}var Ll;function I1(){return Ll||(Ll=1,function(s){Object.defineProperty(s,"__esModule",{value:!0});const t=is;t.__exportStar(E1(),s),t.__exportStar(yp(),s),t.__exportStar(mp(),s)}(Pc)),Pc}var os=I1(),Ac,Ul;function P1(){if(Ul)return Ac;Ul=1;function s(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}Ac=t;function t(r,n,a){var u=a&&a.stringify||s,h=1;if(typeof r=="object"&&r!==null){var p=n.length+h;if(p===1)return r;var d=new Array(p);d[0]=u(r);for(var y=1;y<p;y++)d[y]=u(n[y]);return d.join(" ")}if(typeof r!="string")return r;var v=n.length;if(v===0)return r;for(var _="",I=1-h,$=-1,R=r&&r.length||0,C=0;C<R;){if(r.charCodeAt(C)===37&&C+1<R){switch($=$>-1?$:0,r.charCodeAt(C+1)){case 100:case 102:if(I>=v||n[I]==null)break;$<C&&(_+=r.slice($,C)),_+=Number(n[I]),$=C+2,C++;break;case 105:if(I>=v||n[I]==null)break;$<C&&(_+=r.slice($,C)),_+=Math.floor(Number(n[I])),$=C+2,C++;break;case 79:case 111:case 106:if(I>=v||n[I]===void 0)break;$<C&&(_+=r.slice($,C));var V=typeof n[I];if(V==="string"){_+="'"+n[I]+"'",$=C+2,C++;break}if(V==="function"){_+=n[I].name||"<anonymous>",$=C+2,C++;break}_+=u(n[I]),$=C+2,C++;break;case 115:if(I>=v)break;$<C&&(_+=r.slice($,C)),_+=String(n[I]),$=C+2,C++;break;case 37:$<C&&(_+=r.slice($,C)),_+="%",$=C+2,C++,I--;break}++I}++C}return $===-1?r:($<R&&(_+=r.slice($)),_)}return Ac}var Rc,Ml;function x1(){if(Ml)return Rc;Ml=1;const s=P1();Rc=a;const t=re().console||{},r={mapHttpRequest:R,mapHttpResponse:R,wrapRequestSerializer:C,wrapResponseSerializer:C,wrapErrorSerializer:C,req:R,res:R,err:I};function n(T,U){return Array.isArray(T)?T.filter(function(Q){return Q!=="!stdSerializers.err"}):T===!0?Object.keys(U):!1}function a(T){T=T||{},T.browser=T.browser||{};const U=T.browser.transmit;if(U&&typeof U.send!="function")throw Error("pino: transmit option must have a send function");const H=T.browser.write||t;T.browser.write&&(T.browser.asObject=!0);const Q=T.serializers||{},ue=n(T.browser.serialize,Q);let be=T.browser.serialize;Array.isArray(T.browser.serialize)&&T.browser.serialize.indexOf("!stdSerializers.err")>-1&&(be=!1);const de=["error","fatal","warn","info","debug","trace"];typeof H=="function"&&(H.error=H.fatal=H.warn=H.info=H.debug=H.trace=H),T.enabled===!1&&(T.level="silent");const Ue=T.level||"info",te=Object.create(H);te.log||(te.log=V),Object.defineProperty(te,"levelVal",{get:A}),Object.defineProperty(te,"level",{get:z,set:M});const E={transmit:U,serialize:ue,asObject:T.browser.asObject,levels:de,timestamp:$(T)};te.levels=a.levels,te.level=Ue,te.setMaxListeners=te.getMaxListeners=te.emit=te.addListener=te.on=te.prependListener=te.once=te.prependOnceListener=te.removeListener=te.removeAllListeners=te.listeners=te.listenerCount=te.eventNames=te.write=te.flush=V,te.serializers=Q,te._serialize=ue,te._stdErrSerialize=be,te.child=Y,U&&(te._logEvent=_());function A(){return this.level==="silent"?1/0:this.levels.values[this.level]}function z(){return this._level}function M(L){if(L!=="silent"&&!this.levels.values[L])throw Error("unknown level "+L);this._level=L,u(E,te,"error","log"),u(E,te,"fatal","error"),u(E,te,"warn","error"),u(E,te,"info","log"),u(E,te,"debug","log"),u(E,te,"trace","log")}function Y(L,se){if(!L)throw new Error("missing bindings for child Pino");se=se||{},ue&&L.serializers&&(se.serializers=L.serializers);const xe=se.serializers;if(ue&&xe){var we=Object.assign({},Q,xe),he=T.browser.serialize===!0?Object.keys(we):ue;delete L.serializers,d([L],he,we,this._stdErrSerialize)}function Z(Se){this._childLevel=(Se._childLevel|0)+1,this.error=y(Se,L,"error"),this.fatal=y(Se,L,"fatal"),this.warn=y(Se,L,"warn"),this.info=y(Se,L,"info"),this.debug=y(Se,L,"debug"),this.trace=y(Se,L,"trace"),we&&(this.serializers=we,this._serialize=he),U&&(this._logEvent=_([].concat(Se._logEvent.bindings,L)))}return Z.prototype=this,new Z(this)}return te}a.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},a.stdSerializers=r,a.stdTimeFunctions=Object.assign({},{nullTime:ee,epochTime:ie,unixTime:B,isoTime:J});function u(T,U,H,Q){const ue=Object.getPrototypeOf(U);U[H]=U.levelVal>U.levels.values[H]?V:ue[H]?ue[H]:t[H]||t[Q]||V,h(T,U,H)}function h(T,U,H){!T.transmit&&U[H]===V||(U[H]=function(Q){return function(){const be=T.timestamp(),de=new Array(arguments.length),Ue=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var te=0;te<de.length;te++)de[te]=arguments[te];if(T.serialize&&!T.asObject&&d(de,this._serialize,this.serializers,this._stdErrSerialize),T.asObject?Q.call(Ue,p(this,H,de,be)):Q.apply(Ue,de),T.transmit){const E=T.transmit.level||U.level,A=a.levels.values[E],z=a.levels.values[H];if(z<A)return;v(this,{ts:be,methodLevel:H,methodValue:z,transmitLevel:E,transmitValue:a.levels.values[T.transmit.level||U.level],send:T.transmit.send,val:U.levelVal},de)}}}(U[H]))}function p(T,U,H,Q){T._serialize&&d(H,T._serialize,T.serializers,T._stdErrSerialize);const ue=H.slice();let be=ue[0];const de={};Q&&(de.time=Q),de.level=a.levels.values[U];let Ue=(T._childLevel|0)+1;if(Ue<1&&(Ue=1),be!==null&&typeof be=="object"){for(;Ue--&&typeof ue[0]=="object";)Object.assign(de,ue.shift());be=ue.length?s(ue.shift(),ue):void 0}else typeof be=="string"&&(be=s(ue.shift(),ue));return be!==void 0&&(de.msg=be),de}function d(T,U,H,Q){for(const ue in T)if(Q&&T[ue]instanceof Error)T[ue]=a.stdSerializers.err(T[ue]);else if(typeof T[ue]=="object"&&!Array.isArray(T[ue]))for(const be in T[ue])U&&U.indexOf(be)>-1&&be in H&&(T[ue][be]=H[be](T[ue][be]))}function y(T,U,H){return function(){const Q=new Array(1+arguments.length);Q[0]=U;for(var ue=1;ue<Q.length;ue++)Q[ue]=arguments[ue-1];return T[H].apply(this,Q)}}function v(T,U,H){const Q=U.send,ue=U.ts,be=U.methodLevel,de=U.methodValue,Ue=U.val,te=T._logEvent.bindings;d(H,T._serialize||Object.keys(T.serializers),T.serializers,T._stdErrSerialize===void 0?!0:T._stdErrSerialize),T._logEvent.ts=ue,T._logEvent.messages=H.filter(function(E){return te.indexOf(E)===-1}),T._logEvent.level.label=be,T._logEvent.level.value=de,Q(be,T._logEvent,Ue),T._logEvent=_(te)}function _(T){return{ts:0,messages:[],bindings:T||[],level:{label:"",value:0}}}function I(T){const U={type:T.constructor.name,msg:T.message,stack:T.stack};for(const H in T)U[H]===void 0&&(U[H]=T[H]);return U}function $(T){return typeof T.timestamp=="function"?T.timestamp:T.timestamp===!1?ee:ie}function R(){return{}}function C(T){return T}function V(){}function ee(){return!1}function ie(){return Date.now()}function B(){return Math.round(Date.now()/1e3)}function J(){return new Date(Date.now()).toISOString()}function re(){function T(U){return typeof U<"u"&&U}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return T(self)||T(window)||T(this)||{}}}return Rc}var S1=x1();const qo=rs(S1),A1={level:"info"},as="custom_context";var R1=Object.defineProperty,O1=Object.defineProperties,$1=Object.getOwnPropertyDescriptors,Hl=Object.getOwnPropertySymbols,C1=Object.prototype.hasOwnProperty,T1=Object.prototype.propertyIsEnumerable,kl=(s,t,r)=>t in s?R1(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,N1=(s,t)=>{for(var r in t||(t={}))C1.call(t,r)&&kl(s,r,t[r]);if(Hl)for(var r of Hl(t))T1.call(t,r)&&kl(s,r,t[r]);return s},D1=(s,t)=>O1(s,$1(t));function jo(s){return D1(N1({},s),{level:(s==null?void 0:s.level)||A1.level})}function F1(s,t=as){return s[t]||""}function q1(s,t,r=as){return s[r]=t,s}function Ot(s,t=as){let r="";return typeof s.bindings>"u"?r=F1(s,t):r=s.bindings().context||"",r}function j1(s,t,r=as){const n=Ot(s,r);return n.trim()?`${n}/${t}`:t}function $t(s,t,r=as){const n=j1(s,t,r),a=s.child({context:n});return q1(a,n,r)}let B1=class extends Oi{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}},z1=class extends Oi{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},L1=class{constructor(t,r){this.logger=t,this.core=r}},U1=class extends Oi{constructor(t,r){super(),this.relayer=t,this.logger=r}},M1=class extends Oi{constructor(t){super()}},H1=class{constructor(t,r,n,a){this.core=t,this.logger=r,this.name=n}},k1=class extends Oi{constructor(t,r){super(),this.relayer=t,this.logger=r}},V1=class extends Oi{constructor(t,r){super(),this.core=t,this.logger=r}},K1=class{constructor(t,r){this.projectId=t,this.logger=r}},G1=class{constructor(t,r){this.projectId=t,this.logger=r}},W1=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},J1=class{constructor(t){this.client=t}};function Q1(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function vp(s,...t){if(!Q1(s))throw new Error("Uint8Array expected");if(t.length>0&&!t.includes(s.length))throw new Error("Uint8Array expected of length "+t+", got length="+s.length)}function Vl(s,t=!0){if(s.destroyed)throw new Error("Hash instance has been destroyed");if(t&&s.finished)throw new Error("Hash#digest() has already been called")}function Y1(s,t){vp(s);const r=t.outputLen;if(s.length<r)throw new Error("digestInto() expects output buffer of length at least "+r)}const cn=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */const Oc=s=>new DataView(s.buffer,s.byteOffset,s.byteLength);function Z1(s){if(typeof s!="string")throw new Error("utf8ToBytes expected string, got "+typeof s);return new Uint8Array(new TextEncoder().encode(s))}function wp(s){return typeof s=="string"&&(s=Z1(s)),vp(s),s}class X1{clone(){return this._cloneInto()}}function e_(s){const t=n=>s().update(wp(n)).digest(),r=s();return t.outputLen=r.outputLen,t.blockLen=r.blockLen,t.create=()=>s(),t}function bp(s=32){if(cn&&typeof cn.getRandomValues=="function")return cn.getRandomValues(new Uint8Array(s));if(cn&&typeof cn.randomBytes=="function")return cn.randomBytes(s);throw new Error("crypto.getRandomValues must be defined")}function t_(s,t,r,n){if(typeof s.setBigUint64=="function")return s.setBigUint64(t,r,n);const a=BigInt(32),u=BigInt(4294967295),h=Number(r>>a&u),p=Number(r&u),d=n?4:0,y=n?0:4;s.setUint32(t+d,h,n),s.setUint32(t+y,p,n)}class r_ extends X1{constructor(t,r,n,a){super(),this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=a,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=Oc(this.buffer)}update(t){Vl(this);const{view:r,buffer:n,blockLen:a}=this;t=wp(t);const u=t.length;for(let h=0;h<u;){const p=Math.min(a-this.pos,u-h);if(p===a){const d=Oc(t);for(;a<=u-h;h+=a)this.process(d,h);continue}n.set(t.subarray(h,h+p),this.pos),this.pos+=p,h+=p,this.pos===a&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){Vl(this),Y1(t,this),this.finished=!0;const{buffer:r,view:n,blockLen:a,isLE:u}=this;let{pos:h}=this;r[h++]=128,this.buffer.subarray(h).fill(0),this.padOffset>a-h&&(this.process(n,0),h=0);for(let _=h;_<a;_++)r[_]=0;t_(n,a-8,BigInt(this.length*8),u),this.process(n,0);const p=Oc(t),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const y=d/4,v=this.get();if(y>v.length)throw new Error("_sha2: outputLen bigger than state");for(let _=0;_<y;_++)p.setUint32(4*_,v[_],u)}digest(){const{buffer:t,outputLen:r}=this;this.digestInto(t);const n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:r,buffer:n,length:a,finished:u,destroyed:h,pos:p}=this;return t.length=a,t.pos=p,t.finished=u,t.destroyed=h,a%r&&t.buffer.set(n),t}}const Eo=BigInt(2**32-1),Yc=BigInt(32);function _p(s,t=!1){return t?{h:Number(s&Eo),l:Number(s>>Yc&Eo)}:{h:Number(s>>Yc&Eo)|0,l:Number(s&Eo)|0}}function i_(s,t=!1){let r=new Uint32Array(s.length),n=new Uint32Array(s.length);for(let a=0;a<s.length;a++){const{h:u,l:h}=_p(s[a],t);[r[a],n[a]]=[u,h]}return[r,n]}const n_=(s,t)=>BigInt(s>>>0)<<Yc|BigInt(t>>>0),s_=(s,t,r)=>s>>>r,o_=(s,t,r)=>s<<32-r|t>>>r,a_=(s,t,r)=>s>>>r|t<<32-r,c_=(s,t,r)=>s<<32-r|t>>>r,u_=(s,t,r)=>s<<64-r|t>>>r-32,h_=(s,t,r)=>s>>>r-32|t<<64-r,l_=(s,t)=>t,f_=(s,t)=>s,p_=(s,t,r)=>s<<r|t>>>32-r,d_=(s,t,r)=>t<<r|s>>>32-r,g_=(s,t,r)=>t<<r-32|s>>>64-r,y_=(s,t,r)=>s<<r-32|t>>>64-r;function m_(s,t,r,n){const a=(t>>>0)+(n>>>0);return{h:s+r+(a/2**32|0)|0,l:a|0}}const v_=(s,t,r)=>(s>>>0)+(t>>>0)+(r>>>0),w_=(s,t,r,n)=>t+r+n+(s/2**32|0)|0,b_=(s,t,r,n)=>(s>>>0)+(t>>>0)+(r>>>0)+(n>>>0),__=(s,t,r,n,a)=>t+r+n+a+(s/2**32|0)|0,E_=(s,t,r,n,a)=>(s>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(a>>>0),I_=(s,t,r,n,a,u)=>t+r+n+a+u+(s/2**32|0)|0,me={fromBig:_p,split:i_,toBig:n_,shrSH:s_,shrSL:o_,rotrSH:a_,rotrSL:c_,rotrBH:u_,rotrBL:h_,rotr32H:l_,rotr32L:f_,rotlSH:p_,rotlSL:d_,rotlBH:g_,rotlBL:y_,add:m_,add3L:v_,add3H:w_,add4L:b_,add4H:__,add5H:I_,add5L:E_},[P_,x_]=me.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(s=>BigInt(s))),ii=new Uint32Array(80),ni=new Uint32Array(80);class S_ extends r_{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){const{Ah:t,Al:r,Bh:n,Bl:a,Ch:u,Cl:h,Dh:p,Dl:d,Eh:y,El:v,Fh:_,Fl:I,Gh:$,Gl:R,Hh:C,Hl:V}=this;return[t,r,n,a,u,h,p,d,y,v,_,I,$,R,C,V]}set(t,r,n,a,u,h,p,d,y,v,_,I,$,R,C,V){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=a|0,this.Ch=u|0,this.Cl=h|0,this.Dh=p|0,this.Dl=d|0,this.Eh=y|0,this.El=v|0,this.Fh=_|0,this.Fl=I|0,this.Gh=$|0,this.Gl=R|0,this.Hh=C|0,this.Hl=V|0}process(t,r){for(let B=0;B<16;B++,r+=4)ii[B]=t.getUint32(r),ni[B]=t.getUint32(r+=4);for(let B=16;B<80;B++){const J=ii[B-15]|0,re=ni[B-15]|0,T=me.rotrSH(J,re,1)^me.rotrSH(J,re,8)^me.shrSH(J,re,7),U=me.rotrSL(J,re,1)^me.rotrSL(J,re,8)^me.shrSL(J,re,7),H=ii[B-2]|0,Q=ni[B-2]|0,ue=me.rotrSH(H,Q,19)^me.rotrBH(H,Q,61)^me.shrSH(H,Q,6),be=me.rotrSL(H,Q,19)^me.rotrBL(H,Q,61)^me.shrSL(H,Q,6),de=me.add4L(U,be,ni[B-7],ni[B-16]),Ue=me.add4H(de,T,ue,ii[B-7],ii[B-16]);ii[B]=Ue|0,ni[B]=de|0}let{Ah:n,Al:a,Bh:u,Bl:h,Ch:p,Cl:d,Dh:y,Dl:v,Eh:_,El:I,Fh:$,Fl:R,Gh:C,Gl:V,Hh:ee,Hl:ie}=this;for(let B=0;B<80;B++){const J=me.rotrSH(_,I,14)^me.rotrSH(_,I,18)^me.rotrBH(_,I,41),re=me.rotrSL(_,I,14)^me.rotrSL(_,I,18)^me.rotrBL(_,I,41),T=_&$^~_&C,U=I&R^~I&V,H=me.add5L(ie,re,U,x_[B],ni[B]),Q=me.add5H(H,ee,J,T,P_[B],ii[B]),ue=H|0,be=me.rotrSH(n,a,28)^me.rotrBH(n,a,34)^me.rotrBH(n,a,39),de=me.rotrSL(n,a,28)^me.rotrBL(n,a,34)^me.rotrBL(n,a,39),Ue=n&u^n&p^u&p,te=a&h^a&d^h&d;ee=C|0,ie=V|0,C=$|0,V=R|0,$=_|0,R=I|0,{h:_,l:I}=me.add(y|0,v|0,Q|0,ue|0),y=p|0,v=d|0,p=u|0,d=h|0,u=n|0,h=a|0;const E=me.add3L(ue,de,te);n=me.add3H(E,Q,be,Ue),a=E|0}({h:n,l:a}=me.add(this.Ah|0,this.Al|0,n|0,a|0)),{h:u,l:h}=me.add(this.Bh|0,this.Bl|0,u|0,h|0),{h:p,l:d}=me.add(this.Ch|0,this.Cl|0,p|0,d|0),{h:y,l:v}=me.add(this.Dh|0,this.Dl|0,y|0,v|0),{h:_,l:I}=me.add(this.Eh|0,this.El|0,_|0,I|0),{h:$,l:R}=me.add(this.Fh|0,this.Fl|0,$|0,R|0),{h:C,l:V}=me.add(this.Gh|0,this.Gl|0,C|0,V|0),{h:ee,l:ie}=me.add(this.Hh|0,this.Hl|0,ee|0,ie|0),this.set(n,a,u,h,p,d,y,v,_,I,$,R,C,V,ee,ie)}roundClean(){ii.fill(0),ni.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}}const A_=e_(()=>new S_);/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */const uu=BigInt(0),Ep=BigInt(1),R_=BigInt(2);function hu(s){return s instanceof Uint8Array||ArrayBuffer.isView(s)&&s.constructor.name==="Uint8Array"}function lu(s){if(!hu(s))throw new Error("Uint8Array expected")}function $c(s,t){if(typeof t!="boolean")throw new Error(s+" boolean expected, got "+t)}const O_=Array.from({length:256},(s,t)=>t.toString(16).padStart(2,"0"));function fu(s){lu(s);let t="";for(let r=0;r<s.length;r++)t+=O_[s[r]];return t}function Ip(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);return s===""?uu:BigInt("0x"+s)}const Fr={_0:48,_9:57,A:65,F:70,a:97,f:102};function Kl(s){if(s>=Fr._0&&s<=Fr._9)return s-Fr._0;if(s>=Fr.A&&s<=Fr.F)return s-(Fr.A-10);if(s>=Fr.a&&s<=Fr.f)return s-(Fr.a-10)}function Pp(s){if(typeof s!="string")throw new Error("hex string expected, got "+typeof s);const t=s.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const n=new Uint8Array(r);for(let a=0,u=0;a<r;a++,u+=2){const h=Kl(s.charCodeAt(u)),p=Kl(s.charCodeAt(u+1));if(h===void 0||p===void 0){const d=s[u]+s[u+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+u)}n[a]=h*16+p}return n}function $_(s){return Ip(fu(s))}function No(s){return lu(s),Ip(fu(Uint8Array.from(s).reverse()))}function xp(s,t){return Pp(s.toString(16).padStart(t*2,"0"))}function Zc(s,t){return xp(s,t).reverse()}function qr(s,t,r){let n;if(typeof t=="string")try{n=Pp(t)}catch(u){throw new Error(s+" must be hex string or Uint8Array, cause: "+u)}else if(hu(t))n=Uint8Array.from(t);else throw new Error(s+" must be hex string or Uint8Array");const a=n.length;if(typeof r=="number"&&a!==r)throw new Error(s+" of length "+r+" expected, got "+a);return n}function Gl(...s){let t=0;for(let n=0;n<s.length;n++){const a=s[n];lu(a),t+=a.length}const r=new Uint8Array(t);for(let n=0,a=0;n<s.length;n++){const u=s[n];r.set(u,a),a+=u.length}return r}const Cc=s=>typeof s=="bigint"&&uu<=s;function C_(s,t,r){return Cc(s)&&Cc(t)&&Cc(r)&&t<=s&&s<r}function kn(s,t,r,n){if(!C_(t,r,n))throw new Error("expected valid "+s+": "+r+" <= n < "+n+", got "+t)}function T_(s){let t;for(t=0;s>uu;s>>=Ep,t+=1);return t}const N_=s=>(R_<<BigInt(s-1))-Ep,D_={bigint:s=>typeof s=="bigint",function:s=>typeof s=="function",boolean:s=>typeof s=="boolean",string:s=>typeof s=="string",stringOrUint8Array:s=>typeof s=="string"||hu(s),isSafeInteger:s=>Number.isSafeInteger(s),array:s=>Array.isArray(s),field:(s,t)=>t.Fp.isValid(s),hash:s=>typeof s=="function"&&Number.isSafeInteger(s.outputLen)};function pu(s,t,r={}){const n=(a,u,h)=>{const p=D_[u];if(typeof p!="function")throw new Error("invalid validator function");const d=s[a];if(!(h&&d===void 0)&&!p(d,s))throw new Error("param "+String(a)+" is invalid. Expected "+u+", got "+d)};for(const[a,u]of Object.entries(t))n(a,u,!1);for(const[a,u]of Object.entries(r))n(a,u,!0);return s}function Wl(s){const t=new WeakMap;return(r,...n)=>{const a=t.get(r);if(a!==void 0)return a;const u=s(r,...n);return t.set(r,u),u}}const it=BigInt(0),Ge=BigInt(1),Si=BigInt(2),F_=BigInt(3),Xc=BigInt(4),Jl=BigInt(5),Ql=BigInt(8);function Xe(s,t){const r=s%t;return r>=it?r:t+r}function q_(s,t,r){if(t<it)throw new Error("invalid exponent, negatives unsupported");if(r<=it)throw new Error("invalid modulus");if(r===Ge)return it;let n=Ge;for(;t>it;)t&Ge&&(n=n*s%r),s=s*s%r,t>>=Ge;return n}function vr(s,t,r){let n=s;for(;t-- >it;)n*=n,n%=r;return n}function Yl(s,t){if(s===it)throw new Error("invert: expected non-zero number");if(t<=it)throw new Error("invert: expected positive modulus, got "+t);let r=Xe(s,t),n=t,a=it,u=Ge;for(;r!==it;){const h=n/r,p=n%r,d=a-u*h;n=r,r=p,a=u,u=d}if(n!==Ge)throw new Error("invert: does not exist");return Xe(a,t)}function j_(s){const t=(s-Ge)/Si;let r,n,a;for(r=s-Ge,n=0;r%Si===it;r/=Si,n++);for(a=Si;a<s&&q_(a,t,s)!==s-Ge;a++)if(a>1e3)throw new Error("Cannot find square root: likely non-prime P");if(n===1){const h=(s+Ge)/Xc;return function(p,d){const y=p.pow(d,h);if(!p.eql(p.sqr(y),d))throw new Error("Cannot find square root");return y}}const u=(r+Ge)/Si;return function(h,p){if(h.pow(p,t)===h.neg(h.ONE))throw new Error("Cannot find square root");let d=n,y=h.pow(h.mul(h.ONE,a),r),v=h.pow(p,u),_=h.pow(p,r);for(;!h.eql(_,h.ONE);){if(h.eql(_,h.ZERO))return h.ZERO;let I=1;for(let R=h.sqr(_);I<d&&!h.eql(R,h.ONE);I++)R=h.sqr(R);const $=h.pow(y,Ge<<BigInt(d-I-1));y=h.sqr($),v=h.mul(v,$),_=h.mul(_,y),d=I}return v}}function B_(s){if(s%Xc===F_){const t=(s+Ge)/Xc;return function(r,n){const a=r.pow(n,t);if(!r.eql(r.sqr(a),n))throw new Error("Cannot find square root");return a}}if(s%Ql===Jl){const t=(s-Jl)/Ql;return function(r,n){const a=r.mul(n,Si),u=r.pow(a,t),h=r.mul(n,u),p=r.mul(r.mul(h,Si),u),d=r.mul(h,r.sub(p,r.ONE));if(!r.eql(r.sqr(d),n))throw new Error("Cannot find square root");return d}}return j_(s)}const z_=(s,t)=>(Xe(s,t)&Ge)===Ge,L_=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function U_(s){const t={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=L_.reduce((n,a)=>(n[a]="function",n),t);return pu(s,r)}function M_(s,t,r){if(r<it)throw new Error("invalid exponent, negatives unsupported");if(r===it)return s.ONE;if(r===Ge)return t;let n=s.ONE,a=t;for(;r>it;)r&Ge&&(n=s.mul(n,a)),a=s.sqr(a),r>>=Ge;return n}function H_(s,t){const r=new Array(t.length),n=t.reduce((u,h,p)=>s.is0(h)?u:(r[p]=u,s.mul(u,h)),s.ONE),a=s.inv(n);return t.reduceRight((u,h,p)=>s.is0(h)?u:(r[p]=s.mul(u,r[p]),s.mul(u,h)),a),r}function Sp(s,t){const r=t!==void 0?t:s.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function Ap(s,t,r=!1,n={}){if(s<=it)throw new Error("invalid field: expected ORDER > 0, got "+s);const{nBitLength:a,nByteLength:u}=Sp(s,t);if(u>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");let h;const p=Object.freeze({ORDER:s,isLE:r,BITS:a,BYTES:u,MASK:N_(a),ZERO:it,ONE:Ge,create:d=>Xe(d,s),isValid:d=>{if(typeof d!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof d);return it<=d&&d<s},is0:d=>d===it,isOdd:d=>(d&Ge)===Ge,neg:d=>Xe(-d,s),eql:(d,y)=>d===y,sqr:d=>Xe(d*d,s),add:(d,y)=>Xe(d+y,s),sub:(d,y)=>Xe(d-y,s),mul:(d,y)=>Xe(d*y,s),pow:(d,y)=>M_(p,d,y),div:(d,y)=>Xe(d*Yl(y,s),s),sqrN:d=>d*d,addN:(d,y)=>d+y,subN:(d,y)=>d-y,mulN:(d,y)=>d*y,inv:d=>Yl(d,s),sqrt:n.sqrt||(d=>(h||(h=B_(s)),h(p,d))),invertBatch:d=>H_(p,d),cmov:(d,y,v)=>v?y:d,toBytes:d=>r?Zc(d,u):xp(d,u),fromBytes:d=>{if(d.length!==u)throw new Error("Field.fromBytes: expected "+u+" bytes, got "+d.length);return r?No(d):$_(d)}});return Object.freeze(p)}const Zl=BigInt(0),Io=BigInt(1);function Tc(s,t){const r=t.negate();return s?r:t}function Rp(s,t){if(!Number.isSafeInteger(s)||s<=0||s>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+s)}function Nc(s,t){Rp(s,t);const r=Math.ceil(t/s)+1,n=2**(s-1);return{windows:r,windowSize:n}}function k_(s,t){if(!Array.isArray(s))throw new Error("array expected");s.forEach((r,n)=>{if(!(r instanceof t))throw new Error("invalid point at index "+n)})}function V_(s,t){if(!Array.isArray(s))throw new Error("array of scalars expected");s.forEach((r,n)=>{if(!t.isValid(r))throw new Error("invalid scalar at index "+n)})}const Dc=new WeakMap,Op=new WeakMap;function Fc(s){return Op.get(s)||1}function K_(s,t){return{constTimeNegate:Tc,hasPrecomputes(r){return Fc(r)!==1},unsafeLadder(r,n,a=s.ZERO){let u=r;for(;n>Zl;)n&Io&&(a=a.add(u)),u=u.double(),n>>=Io;return a},precomputeWindow(r,n){const{windows:a,windowSize:u}=Nc(n,t),h=[];let p=r,d=p;for(let y=0;y<a;y++){d=p,h.push(d);for(let v=1;v<u;v++)d=d.add(p),h.push(d);p=d.double()}return h},wNAF(r,n,a){const{windows:u,windowSize:h}=Nc(r,t);let p=s.ZERO,d=s.BASE;const y=BigInt(2**r-1),v=2**r,_=BigInt(r);for(let I=0;I<u;I++){const $=I*h;let R=Number(a&y);a>>=_,R>h&&(R-=v,a+=Io);const C=$,V=$+Math.abs(R)-1,ee=I%2!==0,ie=R<0;R===0?d=d.add(Tc(ee,n[C])):p=p.add(Tc(ie,n[V]))}return{p,f:d}},wNAFUnsafe(r,n,a,u=s.ZERO){const{windows:h,windowSize:p}=Nc(r,t),d=BigInt(2**r-1),y=2**r,v=BigInt(r);for(let _=0;_<h;_++){const I=_*p;if(a===Zl)break;let $=Number(a&d);if(a>>=v,$>p&&($-=y,a+=Io),$===0)continue;let R=n[I+Math.abs($)-1];$<0&&(R=R.negate()),u=u.add(R)}return u},getPrecomputes(r,n,a){let u=Dc.get(n);return u||(u=this.precomputeWindow(n,r),r!==1&&Dc.set(n,a(u))),u},wNAFCached(r,n,a){const u=Fc(r);return this.wNAF(u,this.getPrecomputes(u,r,a),n)},wNAFCachedUnsafe(r,n,a,u){const h=Fc(r);return h===1?this.unsafeLadder(r,n,u):this.wNAFUnsafe(h,this.getPrecomputes(h,r,a),n,u)},setWindowSize(r,n){Rp(n,t),Op.set(r,n),Dc.delete(r)}}}function G_(s,t,r,n){if(k_(r,s),V_(n,t),r.length!==n.length)throw new Error("arrays of points and scalars must have equal length");const a=s.ZERO,u=T_(BigInt(r.length)),h=u>12?u-3:u>4?u-2:u?2:1,p=(1<<h)-1,d=new Array(p+1).fill(a),y=Math.floor((t.BITS-1)/h)*h;let v=a;for(let _=y;_>=0;_-=h){d.fill(a);for(let $=0;$<n.length;$++){const R=n[$],C=Number(R>>BigInt(_)&BigInt(p));d[C]=d[C].add(r[$])}let I=a;for(let $=d.length-1,R=a;$>0;$--)R=R.add(d[$]),I=I.add(R);if(v=v.add(I),_!==0)for(let $=0;$<h;$++)v=v.double()}return v}function W_(s){return U_(s.Fp),pu(s,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Sp(s.n,s.nBitLength),...s,p:s.Fp.ORDER})}const or=BigInt(0),Pt=BigInt(1),Po=BigInt(2),J_=BigInt(8),Q_={zip215:!0};function Y_(s){const t=W_(s);return pu(s,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...t})}function Z_(s){const t=Y_(s),{Fp:r,n,prehash:a,hash:u,randomBytes:h,nByteLength:p,h:d}=t,y=Po<<BigInt(p*8)-Pt,v=r.create,_=Ap(t.n,t.nBitLength),I=t.uvRatio||((E,A)=>{try{return{isValid:!0,value:r.sqrt(E*r.inv(A))}}catch{return{isValid:!1,value:or}}}),$=t.adjustScalarBytes||(E=>E),R=t.domain||((E,A,z)=>{if($c("phflag",z),A.length||z)throw new Error("Contexts/pre-hash are not supported");return E});function C(E,A){kn("coordinate "+E,A,or,y)}function V(E){if(!(E instanceof B))throw new Error("ExtendedPoint expected")}const ee=Wl((E,A)=>{const{ex:z,ey:M,ez:Y}=E,L=E.is0();A==null&&(A=L?J_:r.inv(Y));const se=v(z*A),xe=v(M*A),we=v(Y*A);if(L)return{x:or,y:Pt};if(we!==Pt)throw new Error("invZ was invalid");return{x:se,y:xe}}),ie=Wl(E=>{const{a:A,d:z}=t;if(E.is0())throw new Error("bad point: ZERO");const{ex:M,ey:Y,ez:L,et:se}=E,xe=v(M*M),we=v(Y*Y),he=v(L*L),Z=v(he*he),Se=v(xe*A),Ct=v(he*v(Se+we)),Fe=v(Z+v(z*v(xe*we)));if(Ct!==Fe)throw new Error("bad point: equation left != right (1)");const He=v(M*Y),Tt=v(L*se);if(He!==Tt)throw new Error("bad point: equation left != right (2)");return!0});class B{constructor(A,z,M,Y){this.ex=A,this.ey=z,this.ez=M,this.et=Y,C("x",A),C("y",z),C("z",M),C("t",Y),Object.freeze(this)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(A){if(A instanceof B)throw new Error("extended point not allowed");const{x:z,y:M}=A||{};return C("x",z),C("y",M),new B(z,M,Pt,v(z*M))}static normalizeZ(A){const z=r.invertBatch(A.map(M=>M.ez));return A.map((M,Y)=>M.toAffine(z[Y])).map(B.fromAffine)}static msm(A,z){return G_(B,_,A,z)}_setWindowSize(A){T.setWindowSize(this,A)}assertValidity(){ie(this)}equals(A){V(A);const{ex:z,ey:M,ez:Y}=this,{ex:L,ey:se,ez:xe}=A,we=v(z*xe),he=v(L*Y),Z=v(M*xe),Se=v(se*Y);return we===he&&Z===Se}is0(){return this.equals(B.ZERO)}negate(){return new B(v(-this.ex),this.ey,this.ez,v(-this.et))}double(){const{a:A}=t,{ex:z,ey:M,ez:Y}=this,L=v(z*z),se=v(M*M),xe=v(Po*v(Y*Y)),we=v(A*L),he=z+M,Z=v(v(he*he)-L-se),Se=we+se,Ct=Se-xe,Fe=we-se,He=v(Z*Ct),Tt=v(Se*Fe),dt=v(Z*Fe),Nt=v(Ct*Se);return new B(He,Tt,Nt,dt)}add(A){V(A);const{a:z,d:M}=t,{ex:Y,ey:L,ez:se,et:xe}=this,{ex:we,ey:he,ez:Z,et:Se}=A;if(z===BigInt(-1)){const Ti=v((L-Y)*(he+we)),hr=v((L+Y)*(he-we)),st=v(hr-Ti);if(st===or)return this.double();const lr=v(se*Po*Se),_r=v(xe*Po*Z),Ni=_r+lr,fr=hr+Ti,Di=_r-lr,Ut=v(Ni*st),Mt=v(fr*Di),Vr=v(Ni*Di),ut=v(st*fr);return new B(Ut,Mt,ut,Vr)}const Ct=v(Y*we),Fe=v(L*he),He=v(xe*M*Se),Tt=v(se*Z),dt=v((Y+L)*(we+he)-Ct-Fe),Nt=Tt-He,kr=Tt+He,nt=v(Fe-z*Ct),br=v(dt*Nt),gn=v(kr*nt),Dt=v(dt*nt),Ci=v(Nt*kr);return new B(br,gn,Ci,Dt)}subtract(A){return this.add(A.negate())}wNAF(A){return T.wNAFCached(this,A,B.normalizeZ)}multiply(A){const z=A;kn("scalar",z,Pt,n);const{p:M,f:Y}=this.wNAF(z);return B.normalizeZ([M,Y])[0]}multiplyUnsafe(A,z=B.ZERO){const M=A;return kn("scalar",M,or,n),M===or?re:this.is0()||M===Pt?this:T.wNAFCachedUnsafe(this,M,B.normalizeZ,z)}isSmallOrder(){return this.multiplyUnsafe(d).is0()}isTorsionFree(){return T.unsafeLadder(this,n).is0()}toAffine(A){return ee(this,A)}clearCofactor(){const{h:A}=t;return A===Pt?this:this.multiplyUnsafe(A)}static fromHex(A,z=!1){const{d:M,a:Y}=t,L=r.BYTES;A=qr("pointHex",A,L),$c("zip215",z);const se=A.slice(),xe=A[L-1];se[L-1]=xe&-129;const we=No(se),he=z?y:r.ORDER;kn("pointHex.y",we,or,he);const Z=v(we*we),Se=v(Z-Pt),Ct=v(M*Z-Y);let{isValid:Fe,value:He}=I(Se,Ct);if(!Fe)throw new Error("Point.fromHex: invalid y coordinate");const Tt=(He&Pt)===Pt,dt=(xe&128)!==0;if(!z&&He===or&&dt)throw new Error("Point.fromHex: x=0 and x_0=1");return dt!==Tt&&(He=v(-He)),B.fromAffine({x:He,y:we})}static fromPrivateKey(A){return Q(A).point}toRawBytes(){const{x:A,y:z}=this.toAffine(),M=Zc(z,r.BYTES);return M[M.length-1]|=A&Pt?128:0,M}toHex(){return fu(this.toRawBytes())}}B.BASE=new B(t.Gx,t.Gy,Pt,v(t.Gx*t.Gy)),B.ZERO=new B(or,Pt,Pt,or);const{BASE:J,ZERO:re}=B,T=K_(B,p*8);function U(E){return Xe(E,n)}function H(E){return U(No(E))}function Q(E){const A=r.BYTES;E=qr("private key",E,A);const z=qr("hashed private key",u(E),2*A),M=$(z.slice(0,A)),Y=z.slice(A,2*A),L=H(M),se=J.multiply(L),xe=se.toRawBytes();return{head:M,prefix:Y,scalar:L,point:se,pointBytes:xe}}function ue(E){return Q(E).pointBytes}function be(E=new Uint8Array,...A){const z=Gl(...A);return H(u(R(z,qr("context",E),!!a)))}function de(E,A,z={}){E=qr("message",E),a&&(E=a(E));const{prefix:M,scalar:Y,pointBytes:L}=Q(A),se=be(z.context,M,E),xe=J.multiply(se).toRawBytes(),we=be(z.context,xe,L,E),he=U(se+we*Y);kn("signature.s",he,or,n);const Z=Gl(xe,Zc(he,r.BYTES));return qr("result",Z,r.BYTES*2)}const Ue=Q_;function te(E,A,z,M=Ue){const{context:Y,zip215:L}=M,se=r.BYTES;E=qr("signature",E,2*se),A=qr("message",A),z=qr("publicKey",z,se),L!==void 0&&$c("zip215",L),a&&(A=a(A));const xe=No(E.slice(se,2*se));let we,he,Z;try{we=B.fromHex(z,L),he=B.fromHex(E.slice(0,se),L),Z=J.multiplyUnsafe(xe)}catch{return!1}if(!L&&we.isSmallOrder())return!1;const Se=be(Y,he.toRawBytes(),we.toRawBytes(),A);return he.add(we.multiplyUnsafe(Se)).subtract(Z).clearCofactor().equals(B.ZERO)}return J._setWindowSize(8),{CURVE:t,getPublicKey:ue,sign:de,verify:te,ExtendedPoint:B,utils:{getExtendedPublicKey:Q,randomPrivateKey:()=>h(r.BYTES),precompute(E=8,A=B.BASE){return A._setWindowSize(E),A.multiply(BigInt(3)),A}}}}BigInt(0),BigInt(1);const du=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),Xl=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");BigInt(0);const X_=BigInt(1),ef=BigInt(2);BigInt(3);const eE=BigInt(5),tE=BigInt(8);function rE(s){const t=BigInt(10),r=BigInt(20),n=BigInt(40),a=BigInt(80),u=du,h=s*s%u*s%u,p=vr(h,ef,u)*h%u,d=vr(p,X_,u)*s%u,y=vr(d,eE,u)*d%u,v=vr(y,t,u)*y%u,_=vr(v,r,u)*v%u,I=vr(_,n,u)*_%u,$=vr(I,a,u)*I%u,R=vr($,a,u)*I%u,C=vr(R,t,u)*y%u;return{pow_p_5_8:vr(C,ef,u)*s%u,b2:h}}function iE(s){return s[0]&=248,s[31]&=127,s[31]|=64,s}function nE(s,t){const r=du,n=Xe(t*t*t,r),a=Xe(n*n*t,r),u=rE(s*a).pow_p_5_8;let h=Xe(s*n*u,r);const p=Xe(t*h*h,r),d=h,y=Xe(h*Xl,r),v=p===s,_=p===Xe(-s,r),I=p===Xe(-s*Xl,r);return v&&(h=d),(_||I)&&(h=y),z_(h,r)&&(h=Xe(-h,r)),{isValid:v||_,value:h}}const sE=Ap(du,void 0,!0),oE={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:sE,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:tE,Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:A_,randomBytes:bp,adjustScalarBytes:iE,uvRatio:nE},$p=Z_(oE),aE="EdDSA",cE="JWT",Cp=".",Tp="base64url",uE="utf8",hE="utf8",lE=":",fE="did",pE="key",tf="base58btc",dE="z",gE="K36",yE=32;function gu(s){return globalThis.Buffer!=null?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):s}function Np(s=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?gu(globalThis.Buffer.allocUnsafe(s)):new Uint8Array(s)}function Dp(s,t){t||(t=s.reduce((a,u)=>a+u.length,0));const r=Np(t);let n=0;for(const a of s)r.set(a,n),n+=a.length;return gu(r)}function mE(s,t){if(s.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var a=0;a<s.length;a++){var u=s.charAt(a),h=u.charCodeAt(0);if(r[h]!==255)throw new TypeError(u+" is ambiguous");r[h]=a}var p=s.length,d=s.charAt(0),y=Math.log(p)/Math.log(256),v=Math.log(256)/Math.log(p);function _(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var C=0,V=0,ee=0,ie=R.length;ee!==ie&&R[ee]===0;)ee++,C++;for(var B=(ie-ee)*v+1>>>0,J=new Uint8Array(B);ee!==ie;){for(var re=R[ee],T=0,U=B-1;(re!==0||T<V)&&U!==-1;U--,T++)re+=256*J[U]>>>0,J[U]=re%p>>>0,re=re/p>>>0;if(re!==0)throw new Error("Non-zero carry");V=T,ee++}for(var H=B-V;H!==B&&J[H]===0;)H++;for(var Q=d.repeat(C);H<B;++H)Q+=s.charAt(J[H]);return Q}function I(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var C=0;if(R[C]!==" "){for(var V=0,ee=0;R[C]===d;)V++,C++;for(var ie=(R.length-C)*y+1>>>0,B=new Uint8Array(ie);R[C];){var J=r[R.charCodeAt(C)];if(J===255)return;for(var re=0,T=ie-1;(J!==0||re<ee)&&T!==-1;T--,re++)J+=p*B[T]>>>0,B[T]=J%256>>>0,J=J/256>>>0;if(J!==0)throw new Error("Non-zero carry");ee=re,C++}if(R[C]!==" "){for(var U=ie-ee;U!==ie&&B[U]===0;)U++;for(var H=new Uint8Array(V+(ie-U)),Q=V;U!==ie;)H[Q++]=B[U++];return H}}}function $(R){var C=I(R);if(C)return C;throw new Error(`Non-${t} character`)}return{encode:_,decodeUnsafe:I,decode:$}}var vE=mE,wE=vE;const Fp=s=>{if(s instanceof Uint8Array&&s.constructor.name==="Uint8Array")return s;if(s instanceof ArrayBuffer)return new Uint8Array(s);if(ArrayBuffer.isView(s))return new Uint8Array(s.buffer,s.byteOffset,s.byteLength);throw new Error("Unknown type, must be binary type")},bE=s=>new TextEncoder().encode(s),_E=s=>new TextDecoder().decode(s);let EE=class{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},IE=class{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return qp(this,t)}};class PE{constructor(t){this.decoders=t}or(t){return qp(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const qp=(s,t)=>new PE({...s.decoders||{[s.prefix]:s},...t.decoders||{[t.prefix]:t}});let xE=class{constructor(t,r,n,a){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=a,this.encoder=new EE(t,r,n),this.decoder=new IE(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};const Bo=({name:s,prefix:t,encode:r,decode:n})=>new xE(s,t,r,n),cs=({prefix:s,name:t,alphabet:r})=>{const{encode:n,decode:a}=wE(r,t);return Bo({prefix:s,name:t,encode:n,decode:u=>Fp(a(u))})},SE=(s,t,r,n)=>{const a={};for(let v=0;v<t.length;++v)a[t[v]]=v;let u=s.length;for(;s[u-1]==="=";)--u;const h=new Uint8Array(u*r/8|0);let p=0,d=0,y=0;for(let v=0;v<u;++v){const _=a[s[v]];if(_===void 0)throw new SyntaxError(`Non-${n} character`);d=d<<r|_,p+=r,p>=8&&(p-=8,h[y++]=255&d>>p)}if(p>=r||255&d<<8-p)throw new SyntaxError("Unexpected end of data");return h},AE=(s,t,r)=>{const n=t[t.length-1]==="=",a=(1<<r)-1;let u="",h=0,p=0;for(let d=0;d<s.length;++d)for(p=p<<8|s[d],h+=8;h>r;)h-=r,u+=t[a&p>>h];if(h&&(u+=t[a&p<<r-h]),n)for(;u.length*r&7;)u+="=";return u},at=({name:s,prefix:t,bitsPerChar:r,alphabet:n})=>Bo({prefix:t,name:s,encode(a){return AE(a,n,r)},decode(a){return SE(a,n,r,s)}}),RE=Bo({prefix:"\0",name:"identity",encode:s=>_E(s),decode:s=>bE(s)});var OE=Object.freeze({__proto__:null,identity:RE});const $E=at({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var CE=Object.freeze({__proto__:null,base2:$E});const TE=at({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var NE=Object.freeze({__proto__:null,base8:TE});const DE=cs({prefix:"9",name:"base10",alphabet:"0123456789"});var FE=Object.freeze({__proto__:null,base10:DE});const qE=at({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),jE=at({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var BE=Object.freeze({__proto__:null,base16:qE,base16upper:jE});const zE=at({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),LE=at({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),UE=at({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),ME=at({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),HE=at({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kE=at({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),VE=at({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),KE=at({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),GE=at({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var WE=Object.freeze({__proto__:null,base32:zE,base32upper:LE,base32pad:UE,base32padupper:ME,base32hex:HE,base32hexupper:kE,base32hexpad:VE,base32hexpadupper:KE,base32z:GE});const JE=cs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),QE=cs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var YE=Object.freeze({__proto__:null,base36:JE,base36upper:QE});const ZE=cs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),XE=cs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var eI=Object.freeze({__proto__:null,base58btc:ZE,base58flickr:XE});const tI=at({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),rI=at({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),iI=at({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),nI=at({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var sI=Object.freeze({__proto__:null,base64:tI,base64pad:rI,base64url:iI,base64urlpad:nI});const jp=Array.from(""),oI=jp.reduce((s,t,r)=>(s[r]=t,s),[]),aI=jp.reduce((s,t,r)=>(s[t.codePointAt(0)]=r,s),[]);function cI(s){return s.reduce((t,r)=>(t+=oI[r],t),"")}function uI(s){const t=[];for(const r of s){const n=aI[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const hI=Bo({prefix:"",name:"base256emoji",encode:cI,decode:uI});var lI=Object.freeze({__proto__:null,base256emoji:hI}),fI=Bp,rf=128,pI=-128,dI=Math.pow(2,31);function Bp(s,t,r){t=t||[],r=r||0;for(var n=r;s>=dI;)t[r++]=s&255|rf,s/=128;for(;s&pI;)t[r++]=s&255|rf,s>>>=7;return t[r]=s|0,Bp.bytes=r-n+1,t}var gI=eu,yI=128,nf=127;function eu(s,n){var r=0,n=n||0,a=0,u=n,h,p=s.length;do{if(u>=p)throw eu.bytes=0,new RangeError("Could not decode varint");h=s[u++],r+=a<28?(h&nf)<<a:(h&nf)*Math.pow(2,a),a+=7}while(h>=yI);return eu.bytes=u-n,r}var mI=Math.pow(2,7),vI=Math.pow(2,14),wI=Math.pow(2,21),bI=Math.pow(2,28),_I=Math.pow(2,35),EI=Math.pow(2,42),II=Math.pow(2,49),PI=Math.pow(2,56),xI=Math.pow(2,63),SI=function(s){return s<mI?1:s<vI?2:s<wI?3:s<bI?4:s<_I?5:s<EI?6:s<II?7:s<PI?8:s<xI?9:10},AI={encode:fI,decode:gI,encodingLength:SI},zp=AI;const sf=(s,t,r=0)=>(zp.encode(s,t,r),t),of=s=>zp.encodingLength(s),tu=(s,t)=>{const r=t.byteLength,n=of(s),a=n+of(r),u=new Uint8Array(a+r);return sf(s,u,0),sf(r,u,n),u.set(t,a),new RI(s,r,t,u)};class RI{constructor(t,r,n,a){this.code=t,this.size=r,this.digest=n,this.bytes=a}}const Lp=({name:s,code:t,encode:r})=>new OI(s,t,r);class OI{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?tu(this.code,r):r.then(n=>tu(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Up=s=>async t=>new Uint8Array(await crypto.subtle.digest(s,t)),$I=Lp({name:"sha2-256",code:18,encode:Up("SHA-256")}),CI=Lp({name:"sha2-512",code:19,encode:Up("SHA-512")});var TI=Object.freeze({__proto__:null,sha256:$I,sha512:CI});const Mp=0,NI="identity",Hp=Fp,DI=s=>tu(Mp,Hp(s)),FI={code:Mp,name:NI,encode:Hp,digest:DI};var qI=Object.freeze({__proto__:null,identity:FI});new TextEncoder,new TextDecoder;const af={...OE,...CE,...NE,...FE,...BE,...WE,...YE,...eI,...sI,...lI};({...TI,...qI});function kp(s,t,r,n){return{name:s,prefix:t,encoder:{name:s,prefix:t,encode:r},decoder:{decode:n}}}const cf=kp("utf8","u",s=>"u"+new TextDecoder("utf8").decode(s),s=>new TextEncoder().encode(s.substring(1))),qc=kp("ascii","a",s=>{let t="a";for(let r=0;r<s.length;r++)t+=String.fromCharCode(s[r]);return t},s=>{s=s.substring(1);const t=Np(s.length);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);return t}),Vp={utf8:cf,"utf-8":cf,hex:af.base16,latin1:qc,ascii:qc,binary:qc,...af};function yu(s,t="utf8"){const r=Vp[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(s.buffer,s.byteOffset,s.byteLength).toString("utf8"):r.encoder.encode(s).substring(1)}function mu(s,t="utf8"){const r=Vp[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?gu(globalThis.Buffer.from(s,"utf-8")):r.decoder.decode(`${r.prefix}${s}`)}function Do(s){return yu(mu(Ai(s),uE),Tp)}function Kp(s){const t=mu(gE,tf),r=dE+yu(Dp([t,s]),tf);return[fE,pE,r].join(lE)}function jI(s){return yu(s,Tp)}function BI(s){return mu([Do(s.header),Do(s.payload)].join(Cp),hE)}function zI(s){return[Do(s.header),Do(s.payload),jI(s.signature)].join(Cp)}function uf(s=bp(yE)){const t=$p.getPublicKey(s);return{secretKey:Dp([s,t]),publicKey:t}}async function LI(s,t,r,n,a=ce.fromMiliseconds(Date.now())){const u={alg:aE,typ:cE},h=Kp(n.publicKey),p=a+r,d={iss:h,sub:s,aud:t,iat:a,exp:p},y=BI({header:u,payload:d}),v=$p.sign(y,n.secretKey.slice(0,32));return zI({header:u,payload:d,signature:v})}const UI="PARSE_ERROR",MI="INVALID_REQUEST",HI="METHOD_NOT_FOUND",kI="INVALID_PARAMS",Gp="INTERNAL_ERROR",vu="SERVER_ERROR",VI=[-32700,-32600,-32601,-32602,-32603],es={[UI]:{code:-32700,message:"Parse error"},[MI]:{code:-32600,message:"Invalid Request"},[HI]:{code:-32601,message:"Method not found"},[kI]:{code:-32602,message:"Invalid params"},[Gp]:{code:-32603,message:"Internal error"},[vu]:{code:-32e3,message:"Server error"}},Wp=vu;function KI(s){return VI.includes(s)}function hf(s){return Object.keys(es).includes(s)?es[s]:es[Wp]}function GI(s){const t=Object.values(es).find(r=>r.code===s);return t||es[Wp]}function Jp(s,t,r){return s.message.includes("getaddrinfo ENOTFOUND")||s.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):s}var jc={},jr={},lf;function WI(){if(lf)return jr;lf=1,Object.defineProperty(jr,"__esModule",{value:!0}),jr.isBrowserCryptoAvailable=jr.getSubtleCrypto=jr.getBrowerCrypto=void 0;function s(){return(Rt===null||Rt===void 0?void 0:Rt.crypto)||(Rt===null||Rt===void 0?void 0:Rt.msCrypto)||{}}jr.getBrowerCrypto=s;function t(){const n=s();return n.subtle||n.webkitSubtle}jr.getSubtleCrypto=t;function r(){return!!s()&&!!t()}return jr.isBrowserCryptoAvailable=r,jr}var Br={},ff;function JI(){if(ff)return Br;ff=1,Object.defineProperty(Br,"__esModule",{value:!0}),Br.isBrowser=Br.isNode=Br.isReactNative=void 0;function s(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Br.isReactNative=s;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Br.isNode=t;function r(){return!s()&&!t()}return Br.isBrowser=r,Br}var pf;function QI(){return pf||(pf=1,function(s){Object.defineProperty(s,"__esModule",{value:!0});const t=is;t.__exportStar(WI(),s),t.__exportStar(JI(),s)}(jc)),jc}var YI=QI();function wu(s=3){const t=Date.now()*Math.pow(10,s),r=Math.floor(Math.random()*Math.pow(10,s));return t+r}function Qp(s=6){return BigInt(wu(s))}function pn(s,t,r){return{id:r||wu(),jsonrpc:"2.0",method:s,params:t}}function zo(s,t){return{id:s,jsonrpc:"2.0",result:t}}function Lo(s,t,r){return{id:s,jsonrpc:"2.0",error:ZI(t)}}function ZI(s,t){return typeof s>"u"?hf(Gp):(typeof s=="string"&&(s=Object.assign(Object.assign({},hf(vu)),{message:s})),KI(s.code)&&(s=GI(s.code)),s)}class XI{}class eP extends XI{constructor(){super()}}class tP extends eP{constructor(t){super()}}const rP="^https?:",iP="^wss?:";function nP(s){const t=s.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function Yp(s,t){const r=nP(s);return typeof r>"u"?!1:new RegExp(t).test(r)}function df(s){return Yp(s,rP)}function gf(s){return Yp(s,iP)}function sP(s){return new RegExp("wss?://localhost(:d{2,5})?").test(s)}function Zp(s){return typeof s=="object"&&"id"in s&&"jsonrpc"in s&&s.jsonrpc==="2.0"}function bu(s){return Zp(s)&&"method"in s}function Uo(s){return Zp(s)&&(Ur(s)||ur(s))}function Ur(s){return"result"in s}function ur(s){return"error"in s}class Mr extends tP{constructor(t){super(t),this.events=new Xt.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(pn(t.method,t.params||[],t.id||Qp().toString()),r)}async requestStrict(t,r){return new Promise(async(n,a)=>{if(!this.connection.connected)try{await this.open()}catch(u){a(u)}this.events.on(`${t.id}`,u=>{ur(u)?a(u.error):n(u.result)});try{await this.connection.send(t,r)}catch(u){a(u)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Uo(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}onClose(t){t&&t.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${t.code} ${t.reason?`(${t.reason})`:""}`)),this.events.emit("disconnect")}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",t=>this.onClose(t)),this.connection.on("error",t=>this.events.emit("error",t)),this.connection.on("register_error",t=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const oP=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),aP=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",yf=s=>s.split("?")[0],mf=10,cP=oP();let uP=class{constructor(t){if(this.url=t,this.events=new Xt.EventEmitter,this.registering=!1,!gf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Ai(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!gf(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,a)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),a(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return a(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const a=new URLSearchParams(t).get("origin"),u=YI.isReactNative()?{headers:{origin:a}}:{rejectUnauthorized:!sP(t)},h=new cP(t,[],u);aP()?h.onerror=p=>{const d=p;n(this.emitError(d.error))}:h.on("error",p=>{n(this.emitError(p))}),h.onopen=()=>{this.onOpen(h),r(h)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ss(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),a=n.message||n.toString(),u=Lo(t,a);this.events.emit("payload",u)}parseError(t,r=this.url){return Jp(t,yf(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>mf&&this.events.setMaxListeners(mf)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${yf(this.url)}`));return this.events.emit("register_error",r),r}};var Yn={exports:{}};Yn.exports;var vf;function hP(){return vf||(vf=1,function(s,t){var r=200,n="__lodash_hash_undefined__",a=1,u=2,h=9007199254740991,p="[object Arguments]",d="[object Array]",y="[object AsyncFunction]",v="[object Boolean]",_="[object Date]",I="[object Error]",$="[object Function]",R="[object GeneratorFunction]",C="[object Map]",V="[object Number]",ee="[object Null]",ie="[object Object]",B="[object Promise]",J="[object Proxy]",re="[object RegExp]",T="[object Set]",U="[object String]",H="[object Symbol]",Q="[object Undefined]",ue="[object WeakMap]",be="[object ArrayBuffer]",de="[object DataView]",Ue="[object Float32Array]",te="[object Float64Array]",E="[object Int8Array]",A="[object Int16Array]",z="[object Int32Array]",M="[object Uint8Array]",Y="[object Uint8ClampedArray]",L="[object Uint16Array]",se="[object Uint32Array]",xe=/[\\^$.*+?()[\]{}|]/g,we=/^\[object .+?Constructor\]$/,he=/^(?:0|[1-9]\d*)$/,Z={};Z[Ue]=Z[te]=Z[E]=Z[A]=Z[z]=Z[M]=Z[Y]=Z[L]=Z[se]=!0,Z[p]=Z[d]=Z[be]=Z[v]=Z[de]=Z[_]=Z[I]=Z[$]=Z[C]=Z[V]=Z[ie]=Z[re]=Z[T]=Z[U]=Z[ue]=!1;var Se=typeof Rt=="object"&&Rt&&Rt.Object===Object&&Rt,Ct=typeof self=="object"&&self&&self.Object===Object&&self,Fe=Se||Ct||Function("return this")(),He=t&&!t.nodeType&&t,Tt=He&&!0&&s&&!s.nodeType&&s,dt=Tt&&Tt.exports===He,Nt=dt&&Se.process,kr=function(){try{return Nt&&Nt.binding&&Nt.binding("util")}catch{}}(),nt=kr&&kr.isTypedArray;function br(m,P){for(var q=-1,K=m==null?0:m.length,Te=0,fe=[];++q<K;){var qe=m[q];P(qe,q,m)&&(fe[Te++]=qe)}return fe}function gn(m,P){for(var q=-1,K=P.length,Te=m.length;++q<K;)m[Te+q]=P[q];return m}function Dt(m,P){for(var q=-1,K=m==null?0:m.length;++q<K;)if(P(m[q],q,m))return!0;return!1}function Ci(m,P){for(var q=-1,K=Array(m);++q<m;)K[q]=P(q);return K}function Ti(m){return function(P){return m(P)}}function hr(m,P){return m.has(P)}function st(m,P){return m==null?void 0:m[P]}function lr(m){var P=-1,q=Array(m.size);return m.forEach(function(K,Te){q[++P]=[Te,K]}),q}function _r(m,P){return function(q){return m(P(q))}}function Ni(m){var P=-1,q=Array(m.size);return m.forEach(function(K){q[++P]=K}),q}var fr=Array.prototype,Di=Function.prototype,Ut=Object.prototype,Mt=Fe["__core-js_shared__"],Vr=Di.toString,ut=Ut.hasOwnProperty,Fi=function(){var m=/[^.]+$/.exec(Mt&&Mt.keys&&Mt.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),qi=Ut.toString,yn=RegExp("^"+Vr.call(ut).replace(xe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ji=dt?Fe.Buffer:void 0,Kr=Fe.Symbol,Bi=Fe.Uint8Array,zi=Ut.propertyIsEnumerable,ko=fr.splice,Er=Kr?Kr.toStringTag:void 0,hs=Object.getOwnPropertySymbols,ls=ji?ji.isBuffer:void 0,fs=_r(Object.keys,Object),mn=Ft(Fe,"DataView"),hi=Ft(Fe,"Map"),vn=Ft(Fe,"Promise"),wn=Ft(Fe,"Set"),Li=Ft(Fe,"WeakMap"),li=Ft(Object,"create"),Vo=xr(mn),Ko=xr(hi),bn=xr(vn),Go=xr(wn),_n=xr(Li),ps=Kr?Kr.prototype:void 0,En=ps?ps.valueOf:void 0;function Ir(m){var P=-1,q=m==null?0:m.length;for(this.clear();++P<q;){var K=m[P];this.set(K[0],K[1])}}function Wo(){this.__data__=li?li(null):{},this.size=0}function Jo(m){var P=this.has(m)&&delete this.__data__[m];return this.size-=P?1:0,P}function Qo(m){var P=this.__data__;if(li){var q=P[m];return q===n?void 0:q}return ut.call(P,m)?P[m]:void 0}function Yo(m){var P=this.__data__;return li?P[m]!==void 0:ut.call(P,m)}function Zo(m,P){var q=this.__data__;return this.size+=this.has(m)?0:1,q[m]=li&&P===void 0?n:P,this}Ir.prototype.clear=Wo,Ir.prototype.delete=Jo,Ir.prototype.get=Qo,Ir.prototype.has=Yo,Ir.prototype.set=Zo;function Ht(m){var P=-1,q=m==null?0:m.length;for(this.clear();++P<q;){var K=m[P];this.set(K[0],K[1])}}function Xo(){this.__data__=[],this.size=0}function ea(m){var P=this.__data__,q=fi(P,m);if(q<0)return!1;var K=P.length-1;return q==K?P.pop():ko.call(P,q,1),--this.size,!0}function ta(m){var P=this.__data__,q=fi(P,m);return q<0?void 0:P[q][1]}function ra(m){return fi(this.__data__,m)>-1}function ia(m,P){var q=this.__data__,K=fi(q,m);return K<0?(++this.size,q.push([m,P])):q[K][1]=P,this}Ht.prototype.clear=Xo,Ht.prototype.delete=ea,Ht.prototype.get=ta,Ht.prototype.has=ra,Ht.prototype.set=ia;function Pr(m){var P=-1,q=m==null?0:m.length;for(this.clear();++P<q;){var K=m[P];this.set(K[0],K[1])}}function Ui(){this.size=0,this.__data__={hash:new Ir,map:new(hi||Ht),string:new Ir}}function na(m){var P=Gr(this,m).delete(m);return this.size-=P?1:0,P}function Mi(m){return Gr(this,m).get(m)}function sa(m){return Gr(this,m).has(m)}function oa(m,P){var q=Gr(this,m),K=q.size;return q.set(m,P),this.size+=q.size==K?0:1,this}Pr.prototype.clear=Ui,Pr.prototype.delete=na,Pr.prototype.get=Mi,Pr.prototype.has=sa,Pr.prototype.set=oa;function Hi(m){var P=-1,q=m==null?0:m.length;for(this.__data__=new Pr;++P<q;)this.add(m[P])}function ds(m){return this.__data__.set(m,n),this}function gs(m){return this.__data__.has(m)}Hi.prototype.add=Hi.prototype.push=ds,Hi.prototype.has=gs;function er(m){var P=this.__data__=new Ht(m);this.size=P.size}function aa(){this.__data__=new Ht,this.size=0}function ca(m){var P=this.__data__,q=P.delete(m);return this.size=P.size,q}function ua(m){return this.__data__.get(m)}function ha(m){return this.__data__.has(m)}function ys(m,P){var q=this.__data__;if(q instanceof Ht){var K=q.__data__;if(!hi||K.length<r-1)return K.push([m,P]),this.size=++q.size,this;q=this.__data__=new Pr(K)}return q.set(m,P),this.size=q.size,this}er.prototype.clear=aa,er.prototype.delete=ca,er.prototype.get=ua,er.prototype.has=ha,er.prototype.set=ys;function ms(m,P){var q=Ki(m),K=!q&&Os(m),Te=!q&&!K&&xn(m),fe=!q&&!K&&!Te&&Ts(m),qe=q||K||Te||fe,We=qe?Ci(m.length,String):[],Ie=We.length;for(var Ne in m)ut.call(m,Ne)&&!(qe&&(Ne=="length"||Te&&(Ne=="offset"||Ne=="parent")||fe&&(Ne=="buffer"||Ne=="byteLength"||Ne=="byteOffset")||Ps(Ne,Ie)))&&We.push(Ne);return We}function fi(m,P){for(var q=m.length;q--;)if(Rs(m[q][0],P))return q;return-1}function In(m,P,q){var K=P(m);return Ki(m)?K:gn(K,q(m))}function pi(m){return m==null?m===void 0?Q:ee:Er&&Er in Object(m)?Es(m):pa(m)}function Pn(m){return gi(m)&&pi(m)==p}function di(m,P,q,K,Te){return m===P?!0:m==null||P==null||!gi(m)&&!gi(P)?m!==m&&P!==P:vs(m,P,q,K,di,Te)}function vs(m,P,q,K,Te,fe){var qe=Ki(m),We=Ki(P),Ie=qe?d:pr(m),Ne=We?d:pr(P);Ie=Ie==p?ie:Ie,Ne=Ne==p?ie:Ne;var ke=Ie==ie,wt=Ne==ie,Je=Ie==Ne;if(Je&&xn(m)){if(!xn(P))return!1;qe=!0,ke=!1}if(Je&&!ke)return fe||(fe=new er),qe||Ts(m)?ki(m,P,q,K,Te,fe):fa(m,P,Ie,q,K,Te,fe);if(!(q&a)){var je=ke&&ut.call(m,"__wrapped__"),gt=wt&&ut.call(P,"__wrapped__");if(je||gt){var tr=je?m.value():m,kt=gt?P.value():P;return fe||(fe=new er),Te(tr,kt,q,K,fe)}}return Je?(fe||(fe=new er),_s(m,P,q,K,Te,fe)):!1}function la(m){if(!Cs(m)||Ss(m))return!1;var P=Gi(m)?yn:we;return P.test(xr(m))}function ws(m){return gi(m)&&$s(m.length)&&!!Z[pi(m)]}function bs(m){if(!As(m))return fs(m);var P=[];for(var q in Object(m))ut.call(m,q)&&q!="constructor"&&P.push(q);return P}function ki(m,P,q,K,Te,fe){var qe=q&a,We=m.length,Ie=P.length;if(We!=Ie&&!(qe&&Ie>We))return!1;var Ne=fe.get(m);if(Ne&&fe.get(P))return Ne==P;var ke=-1,wt=!0,Je=q&u?new Hi:void 0;for(fe.set(m,P),fe.set(P,m);++ke<We;){var je=m[ke],gt=P[ke];if(K)var tr=qe?K(gt,je,ke,P,m,fe):K(je,gt,ke,m,P,fe);if(tr!==void 0){if(tr)continue;wt=!1;break}if(Je){if(!Dt(P,function(kt,dr){if(!hr(Je,dr)&&(je===kt||Te(je,kt,q,K,fe)))return Je.push(dr)})){wt=!1;break}}else if(!(je===gt||Te(je,gt,q,K,fe))){wt=!1;break}}return fe.delete(m),fe.delete(P),wt}function fa(m,P,q,K,Te,fe,qe){switch(q){case de:if(m.byteLength!=P.byteLength||m.byteOffset!=P.byteOffset)return!1;m=m.buffer,P=P.buffer;case be:return!(m.byteLength!=P.byteLength||!fe(new Bi(m),new Bi(P)));case v:case _:case V:return Rs(+m,+P);case I:return m.name==P.name&&m.message==P.message;case re:case U:return m==P+"";case C:var We=lr;case T:var Ie=K&a;if(We||(We=Ni),m.size!=P.size&&!Ie)return!1;var Ne=qe.get(m);if(Ne)return Ne==P;K|=u,qe.set(m,P);var ke=ki(We(m),We(P),K,Te,fe,qe);return qe.delete(m),ke;case H:if(En)return En.call(m)==En.call(P)}return!1}function _s(m,P,q,K,Te,fe){var qe=q&a,We=Vi(m),Ie=We.length,Ne=Vi(P),ke=Ne.length;if(Ie!=ke&&!qe)return!1;for(var wt=Ie;wt--;){var Je=We[wt];if(!(qe?Je in P:ut.call(P,Je)))return!1}var je=fe.get(m);if(je&&fe.get(P))return je==P;var gt=!0;fe.set(m,P),fe.set(P,m);for(var tr=qe;++wt<Ie;){Je=We[wt];var kt=m[Je],dr=P[Je];if(K)var Sn=qe?K(dr,kt,Je,P,m,fe):K(kt,dr,Je,m,P,fe);if(!(Sn===void 0?kt===dr||Te(kt,dr,q,K,fe):Sn)){gt=!1;break}tr||(tr=Je=="constructor")}if(gt&&!tr){var yi=m.constructor,et=P.constructor;yi!=et&&"constructor"in m&&"constructor"in P&&!(typeof yi=="function"&&yi instanceof yi&&typeof et=="function"&&et instanceof et)&&(gt=!1)}return fe.delete(m),fe.delete(P),gt}function Vi(m){return In(m,ya,Is)}function Gr(m,P){var q=m.__data__;return xs(P)?q[typeof P=="string"?"string":"hash"]:q.map}function Ft(m,P){var q=st(m,P);return la(q)?q:void 0}function Es(m){var P=ut.call(m,Er),q=m[Er];try{m[Er]=void 0;var K=!0}catch{}var Te=qi.call(m);return K&&(P?m[Er]=q:delete m[Er]),Te}var Is=hs?function(m){return m==null?[]:(m=Object(m),br(hs(m),function(P){return zi.call(m,P)}))}:Ce,pr=pi;(mn&&pr(new mn(new ArrayBuffer(1)))!=de||hi&&pr(new hi)!=C||vn&&pr(vn.resolve())!=B||wn&&pr(new wn)!=T||Li&&pr(new Li)!=ue)&&(pr=function(m){var P=pi(m),q=P==ie?m.constructor:void 0,K=q?xr(q):"";if(K)switch(K){case Vo:return de;case Ko:return C;case bn:return B;case Go:return T;case _n:return ue}return P});function Ps(m,P){return P=P??h,!!P&&(typeof m=="number"||he.test(m))&&m>-1&&m%1==0&&m<P}function xs(m){var P=typeof m;return P=="string"||P=="number"||P=="symbol"||P=="boolean"?m!=="__proto__":m===null}function Ss(m){return!!Fi&&Fi in m}function As(m){var P=m&&m.constructor,q=typeof P=="function"&&P.prototype||Ut;return m===q}function pa(m){return qi.call(m)}function xr(m){if(m!=null){try{return Vr.call(m)}catch{}try{return m+""}catch{}}return""}function Rs(m,P){return m===P||m!==m&&P!==P}var Os=Pn(function(){return arguments}())?Pn:function(m){return gi(m)&&ut.call(m,"callee")&&!zi.call(m,"callee")},Ki=Array.isArray;function da(m){return m!=null&&$s(m.length)&&!Gi(m)}var xn=ls||$e;function ga(m,P){return di(m,P)}function Gi(m){if(!Cs(m))return!1;var P=pi(m);return P==$||P==R||P==y||P==J}function $s(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=h}function Cs(m){var P=typeof m;return m!=null&&(P=="object"||P=="function")}function gi(m){return m!=null&&typeof m=="object"}var Ts=nt?Ti(nt):ws;function ya(m){return da(m)?ms(m):bs(m)}function Ce(){return[]}function $e(){return!1}s.exports=ga}(Yn,Yn.exports)),Yn.exports}var lP=hP();const fP=rs(lP);function pP(s,t){return t=t||{},new Promise(function(r,n){var a=new XMLHttpRequest,u=[],h=[],p={},d=function(){return{ok:(a.status/100|0)==2,statusText:a.statusText,status:a.status,url:a.responseURL,text:function(){return Promise.resolve(a.responseText)},json:function(){return Promise.resolve(a.responseText).then(JSON.parse)},blob:function(){return Promise.resolve(new Blob([a.response]))},clone:d,headers:{keys:function(){return u},entries:function(){return h},get:function(v){return p[v.toLowerCase()]},has:function(v){return v.toLowerCase()in p}}}};for(var y in a.open(t.method||"get",s,!0),a.onload=function(){a.getAllResponseHeaders().replace(/^(.*?):[^\S\n]*([\s\S]*?)$/gm,function(v,_,I){u.push(_=_.toLowerCase()),h.push([_,I]),p[_]=p[_]?p[_]+","+I:I}),r(d())},a.onerror=n,a.withCredentials=t.credentials=="include",t.headers)a.setRequestHeader(y,t.headers[y]);a.send(t.body||null)})}const dP=Object.freeze(Object.defineProperty({__proto__:null,default:pP},Symbol.toStringTag,{value:"Module"})),wf=op(dP);var Bc,bf;function gP(){return bf||(bf=1,Bc=self.fetch||(self.fetch=wf.default||wf)),Bc}var yP=gP();const mP=rs(yP);var vP={};function wP(s,t){if(s.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var a=0;a<s.length;a++){var u=s.charAt(a),h=u.charCodeAt(0);if(r[h]!==255)throw new TypeError(u+" is ambiguous");r[h]=a}var p=s.length,d=s.charAt(0),y=Math.log(p)/Math.log(256),v=Math.log(256)/Math.log(p);function _(R){if(R instanceof Uint8Array||(ArrayBuffer.isView(R)?R=new Uint8Array(R.buffer,R.byteOffset,R.byteLength):Array.isArray(R)&&(R=Uint8Array.from(R))),!(R instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(R.length===0)return"";for(var C=0,V=0,ee=0,ie=R.length;ee!==ie&&R[ee]===0;)ee++,C++;for(var B=(ie-ee)*v+1>>>0,J=new Uint8Array(B);ee!==ie;){for(var re=R[ee],T=0,U=B-1;(re!==0||T<V)&&U!==-1;U--,T++)re+=256*J[U]>>>0,J[U]=re%p>>>0,re=re/p>>>0;if(re!==0)throw new Error("Non-zero carry");V=T,ee++}for(var H=B-V;H!==B&&J[H]===0;)H++;for(var Q=d.repeat(C);H<B;++H)Q+=s.charAt(J[H]);return Q}function I(R){if(typeof R!="string")throw new TypeError("Expected String");if(R.length===0)return new Uint8Array;var C=0;if(R[C]!==" "){for(var V=0,ee=0;R[C]===d;)V++,C++;for(var ie=(R.length-C)*y+1>>>0,B=new Uint8Array(ie);R[C];){var J=r[R.charCodeAt(C)];if(J===255)return;for(var re=0,T=ie-1;(J!==0||re<ee)&&T!==-1;T--,re++)J+=p*B[T]>>>0,B[T]=J%256>>>0,J=J/256>>>0;if(J!==0)throw new Error("Non-zero carry");ee=re,C++}if(R[C]!==" "){for(var U=ie-ee;U!==ie&&B[U]===0;)U++;for(var H=new Uint8Array(V+(ie-U)),Q=V;U!==ie;)H[Q++]=B[U++];return H}}}function $(R){var C=I(R);if(C)return C;throw new Error(`Non-${t} character`)}return{encode:_,decodeUnsafe:I,decode:$}}var bP=wP,_P=bP;const Xp=s=>{if(s instanceof Uint8Array&&s.constructor.name==="Uint8Array")return s;if(s instanceof ArrayBuffer)return new Uint8Array(s);if(ArrayBuffer.isView(s))return new Uint8Array(s.buffer,s.byteOffset,s.byteLength);throw new Error("Unknown type, must be binary type")},EP=s=>new TextEncoder().encode(s),IP=s=>new TextDecoder().decode(s);class PP{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class xP{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return ed(this,t)}}class SP{constructor(t){this.decoders=t}or(t){return ed(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const ed=(s,t)=>new SP({...s.decoders||{[s.prefix]:s},...t.decoders||{[t.prefix]:t}});class AP{constructor(t,r,n,a){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=a,this.encoder=new PP(t,r,n),this.decoder=new xP(t,r,a)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Mo=({name:s,prefix:t,encode:r,decode:n})=>new AP(s,t,r,n),us=({prefix:s,name:t,alphabet:r})=>{const{encode:n,decode:a}=_P(r,t);return Mo({prefix:s,name:t,encode:n,decode:u=>Xp(a(u))})},RP=(s,t,r,n)=>{const a={};for(let v=0;v<t.length;++v)a[t[v]]=v;let u=s.length;for(;s[u-1]==="=";)--u;const h=new Uint8Array(u*r/8|0);let p=0,d=0,y=0;for(let v=0;v<u;++v){const _=a[s[v]];if(_===void 0)throw new SyntaxError(`Non-${n} character`);d=d<<r|_,p+=r,p>=8&&(p-=8,h[y++]=255&d>>p)}if(p>=r||255&d<<8-p)throw new SyntaxError("Unexpected end of data");return h},OP=(s,t,r)=>{const n=t[t.length-1]==="=",a=(1<<r)-1;let u="",h=0,p=0;for(let d=0;d<s.length;++d)for(p=p<<8|s[d],h+=8;h>r;)h-=r,u+=t[a&p>>h];if(h&&(u+=t[a&p<<r-h]),n)for(;u.length*r&7;)u+="=";return u},ct=({name:s,prefix:t,bitsPerChar:r,alphabet:n})=>Mo({prefix:t,name:s,encode(a){return OP(a,n,r)},decode(a){return RP(a,n,r,s)}}),$P=Mo({prefix:"\0",name:"identity",encode:s=>IP(s),decode:s=>EP(s)});var CP=Object.freeze({__proto__:null,identity:$P});const TP=ct({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var NP=Object.freeze({__proto__:null,base2:TP});const DP=ct({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var FP=Object.freeze({__proto__:null,base8:DP});const qP=us({prefix:"9",name:"base10",alphabet:"0123456789"});var jP=Object.freeze({__proto__:null,base10:qP});const BP=ct({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),zP=ct({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var LP=Object.freeze({__proto__:null,base16:BP,base16upper:zP});const UP=ct({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),MP=ct({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),HP=ct({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),kP=ct({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),VP=ct({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),KP=ct({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),GP=ct({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),WP=ct({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),JP=ct({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var QP=Object.freeze({__proto__:null,base32:UP,base32upper:MP,base32pad:HP,base32padupper:kP,base32hex:VP,base32hexupper:KP,base32hexpad:GP,base32hexpadupper:WP,base32z:JP});const YP=us({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),ZP=us({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var XP=Object.freeze({__proto__:null,base36:YP,base36upper:ZP});const e2=us({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),t2=us({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var r2=Object.freeze({__proto__:null,base58btc:e2,base58flickr:t2});const i2=ct({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),n2=ct({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),s2=ct({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),o2=ct({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var a2=Object.freeze({__proto__:null,base64:i2,base64pad:n2,base64url:s2,base64urlpad:o2});const td=Array.from(""),c2=td.reduce((s,t,r)=>(s[r]=t,s),[]),u2=td.reduce((s,t,r)=>(s[t.codePointAt(0)]=r,s),[]);function h2(s){return s.reduce((t,r)=>(t+=c2[r],t),"")}function l2(s){const t=[];for(const r of s){const n=u2[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const f2=Mo({prefix:"",name:"base256emoji",encode:h2,decode:l2});var p2=Object.freeze({__proto__:null,base256emoji:f2}),d2=rd,_f=128,g2=-128,y2=Math.pow(2,31);function rd(s,t,r){t=t||[],r=r||0;for(var n=r;s>=y2;)t[r++]=s&255|_f,s/=128;for(;s&g2;)t[r++]=s&255|_f,s>>>=7;return t[r]=s|0,rd.bytes=r-n+1,t}var m2=ru,v2=128,Ef=127;function ru(s,n){var r=0,n=n||0,a=0,u=n,h,p=s.length;do{if(u>=p)throw ru.bytes=0,new RangeError("Could not decode varint");h=s[u++],r+=a<28?(h&Ef)<<a:(h&Ef)*Math.pow(2,a),a+=7}while(h>=v2);return ru.bytes=u-n,r}var w2=Math.pow(2,7),b2=Math.pow(2,14),_2=Math.pow(2,21),E2=Math.pow(2,28),I2=Math.pow(2,35),P2=Math.pow(2,42),x2=Math.pow(2,49),S2=Math.pow(2,56),A2=Math.pow(2,63),R2=function(s){return s<w2?1:s<b2?2:s<_2?3:s<E2?4:s<I2?5:s<P2?6:s<x2?7:s<S2?8:s<A2?9:10},O2={encode:d2,decode:m2,encodingLength:R2},id=O2;const If=(s,t,r=0)=>(id.encode(s,t,r),t),Pf=s=>id.encodingLength(s),iu=(s,t)=>{const r=t.byteLength,n=Pf(s),a=n+Pf(r),u=new Uint8Array(a+r);return If(s,u,0),If(r,u,n),u.set(t,a),new $2(s,r,t,u)};class $2{constructor(t,r,n,a){this.code=t,this.size=r,this.digest=n,this.bytes=a}}const nd=({name:s,code:t,encode:r})=>new C2(s,t,r);class C2{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?iu(this.code,r):r.then(n=>iu(this.code,n))}else throw Error("Unknown type, must be binary type")}}const sd=s=>async t=>new Uint8Array(await crypto.subtle.digest(s,t)),T2=nd({name:"sha2-256",code:18,encode:sd("SHA-256")}),N2=nd({name:"sha2-512",code:19,encode:sd("SHA-512")});var D2=Object.freeze({__proto__:null,sha256:T2,sha512:N2});const od=0,F2="identity",ad=Xp,q2=s=>iu(od,ad(s)),j2={code:od,name:F2,encode:ad,digest:q2};var B2=Object.freeze({__proto__:null,identity:j2});new TextEncoder,new TextDecoder;const xf={...CP,...NP,...FP,...jP,...LP,...QP,...XP,...r2,...a2,...p2};({...D2,...B2});function cd(s){return globalThis.Buffer!=null?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):s}function z2(s=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?cd(globalThis.Buffer.allocUnsafe(s)):new Uint8Array(s)}function ud(s,t,r,n){return{name:s,prefix:t,encoder:{name:s,prefix:t,encode:r},decoder:{decode:n}}}const Sf=ud("utf8","u",s=>"u"+new TextDecoder("utf8").decode(s),s=>new TextEncoder().encode(s.substring(1))),zc=ud("ascii","a",s=>{let t="a";for(let r=0;r<s.length;r++)t+=String.fromCharCode(s[r]);return t},s=>{s=s.substring(1);const t=z2(s.length);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);return t}),L2={utf8:Sf,"utf-8":Sf,hex:xf.base16,latin1:zc,ascii:zc,binary:zc,...xf};function U2(s,t="utf8"){const r=L2[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?cd(globalThis.Buffer.from(s,"utf-8")):r.decoder.decode(`${r.prefix}${s}`)}const hd="wc",M2=2,_u="core",ai=`${hd}@2:${_u}:`,H2={name:_u,logger:"error"},k2={database:":memory:"},V2="crypto",Af="client_ed25519_seed",K2=ce.ONE_DAY,G2="keychain",W2="0.3",J2="messages",Q2="0.3",Y2=ce.SIX_HOURS,Z2="publisher",ld="irn",X2="error",fd="wss://relay.walletconnect.com",Rf="wss://relay.walletconnect.org",ex="relayer",pt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},tx="_subscription",zr={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},rx=ce.ONE_SECOND,ix="2.11.0",nx=1e4,sx="0.3",ox="WALLETCONNECT_CLIENT_ID",ar={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},ax="subscription",cx="0.3",ux=ce.FIVE_SECONDS*1e3,hx="pairing",lx="0.3",Vn={wc_pairingDelete:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:0},res:{ttl:ce.ONE_DAY,prompt:!1,tag:0}}},Zn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},wr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},fx="history",px="0.3",dx="expirer",Zt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},gx="0.3",Lc="verify-api",ln="https://verify.walletconnect.com",nu="https://verify.walletconnect.org",yx=[ln,nu],mx="echo",vx="https://echo.walletconnect.com";class wx{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=G2,this.version=W2,this.initialized=!1,this.storagePrefix=ai,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,a)=>{this.isInitialized(),this.keychain.set(n,a),await this.persist()},this.get=n=>{this.isInitialized();const a=this.keychain.get(n);if(typeof a>"u"){const{message:u}=G("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(u)}return a},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=$t(r,this.name)}get context(){return Ot(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,lp(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?fp(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class bx{constructor(t,r,n){this.core=t,this.logger=r,this.name=V2,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=a=>(this.isInitialized(),this.keychain.has(a)),this.getClientId=async()=>{this.isInitialized();const a=await this.getClientSeed(),u=uf(a);return Kp(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const a=Xb();return this.setPrivateKey(a.publicKey,a.privateKey)},this.signJWT=async a=>{this.isInitialized();const u=await this.getClientSeed(),h=uf(u),p=Wc();return await LI(p,a,K2,h)},this.generateSharedKey=(a,u,h)=>{this.isInitialized();const p=this.getPrivateKey(a),d=e0(p,u);return this.setSymKey(d,h)},this.setSymKey=async(a,u)=>{this.isInitialized();const h=u||t0(a);return await this.keychain.set(h,a),h},this.deleteKeyPair=async a=>{this.isInitialized(),await this.keychain.del(a)},this.deleteSymKey=async a=>{this.isInitialized(),await this.keychain.del(a)},this.encode=async(a,u,h)=>{this.isInitialized();const p=r0(h),d=Ai(u);if(xl(p)){const I=p.senderPublicKey,$=p.receiverPublicKey;a=await this.generateSharedKey(I,$)}const y=this.getSymKey(a),{type:v,senderPublicKey:_}=p;return i0({type:v,symKey:y,message:d,senderPublicKey:_})},this.decode=async(a,u,h)=>{this.isInitialized();const p=n0(u,h);if(xl(p)){const d=p.receiverPublicKey,y=p.senderPublicKey;a=await this.generateSharedKey(d,y)}try{const d=this.getSymKey(a),y=s0({symKey:d,encoded:u});return ss(y)}catch(d){this.logger.error(`Failed to decode message from topic: '${a}', clientId: '${await this.getClientId()}'`),this.logger.error(d)}},this.getPayloadType=a=>{const u=Sl(a);return o0(u.type)},this.getPayloadSenderPublicKey=a=>{const u=Sl(a);return u.senderPublicKey?a0(u.senderPublicKey,c0):void 0},this.core=t,this.logger=$t(r,this.name),this.keychain=n||new wx(this.core,this.logger)}get context(){return Ot(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Af)}catch{t=Wc(),await this.keychain.set(Af,t)}return U2(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class _x extends L1{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=J2,this.version=Q2,this.initialized=!1,this.storagePrefix=ai,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,a)=>{this.isInitialized();const u=fn(a);let h=this.messages.get(n);return typeof h>"u"&&(h={}),typeof h[u]<"u"||(h[u]=a,this.messages.set(n,h),await this.persist()),u},this.get=n=>{this.isInitialized();let a=this.messages.get(n);return typeof a>"u"&&(a={}),a},this.has=(n,a)=>{this.isInitialized();const u=this.get(n),h=fn(a);return typeof u[h]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=$t(t,this.name),this.core=r}get context(){return Ot(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,lp(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?fp(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Ex extends U1{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Xt.EventEmitter,this.name=Z2,this.queue=new Map,this.publishTimeout=ce.toMiliseconds(ce.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,a,u)=>{var h;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:u}});try{const p=(u==null?void 0:u.ttl)||Y2,d=Jc(u),y=(u==null?void 0:u.prompt)||!1,v=(u==null?void 0:u.tag)||0,_=(u==null?void 0:u.id)||Qp().toString(),I={topic:n,message:a,opts:{ttl:p,relay:d,prompt:y,tag:v,id:_}},$=setTimeout(()=>this.queue.set(_,I),this.publishTimeout);try{await await ts(this.rpcPublish(n,a,p,d,y,v,_),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(_),this.relayer.events.emit(pt.publish,I)}catch(R){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(h=u==null?void 0:u.internal)!=null&&h.throwOnFailedPublish)throw this.removeRequestFromQueue(_),R;return}finally{clearTimeout($)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:a,opts:u}})}catch(p){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(p),p}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.relayer=t,this.logger=$t(r,this.name),this.registerEventListeners()}get context(){return Ot(this.logger)}rpcPublish(t,r,n,a,u,h,p){var d,y,v,_;const I={method:Oo(a.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:u,tag:h},id:p};return oi((d=I.params)==null?void 0:d.prompt)&&((y=I.params)==null||delete y.prompt),oi((v=I.params)==null?void 0:v.tag)&&((_=I.params)==null||delete _.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:I}),this.relayer.request(I)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:a}=t;await this.publish(r,n,a)})}registerEventListeners(){this.relayer.core.heartbeat.on(os.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(pt.connection_stalled);return}this.checkQueue()}),this.relayer.on(pt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class Ix{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const a=n.filter(u=>u!==r);if(!a.length){this.map.delete(t);return}this.map.set(t,a)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var Px=Object.defineProperty,xx=Object.defineProperties,Sx=Object.getOwnPropertyDescriptors,Of=Object.getOwnPropertySymbols,Ax=Object.prototype.hasOwnProperty,Rx=Object.prototype.propertyIsEnumerable,$f=(s,t,r)=>t in s?Px(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Kn=(s,t)=>{for(var r in t||(t={}))Ax.call(t,r)&&$f(s,r,t[r]);if(Of)for(var r of Of(t))Rx.call(t,r)&&$f(s,r,t[r]);return s},Uc=(s,t)=>xx(s,Sx(t));class Ox extends k1{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new Ix,this.events=new Xt.EventEmitter,this.name=ax,this.version=cx,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=ai,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}});try{const u=Jc(a),h={topic:n,relay:u};this.pending.set(n,h);const p=await this.rpcSubscribe(n,u);return this.onSubscribe(p,h),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:a}}),p}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(n,a)=>{await this.restartToComplete(),this.isInitialized(),typeof(a==null?void 0:a.id)<"u"?await this.unsubscribeById(n,a.id,a):await this.unsubscribeByTopic(n,a)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((a,u)=>{const h=new ce.Watch;h.start(this.pendingSubscriptionWatchLabel);const p=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(p),h.stop(this.pendingSubscriptionWatchLabel),a(!0)),h.elapsed(this.pendingSubscriptionWatchLabel)>=ux&&(clearInterval(p),h.stop(this.pendingSubscriptionWatchLabel),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=$t(r,this.name),this.clientId=""}get context(){return Ot(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async a=>await this.unsubscribeById(t,a,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const a=Jc(n);await this.rpcUnsubscribe(t,r,a);const u=ft("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(a){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(a),a}}async rpcSubscribe(t,r){const n={method:Oo(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await ts(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(pt.connection_stalled)}return fn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:Oo(r.protocol).batchSubscribe,params:{topics:t.map(a=>a.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await ts(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(pt.connection_stalled)}}rpcUnsubscribe(t,r,n){const a={method:Oo(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:a}),this.relayer.request(a)}onSubscribe(t,r){this.setSubscription(t,Uc(Kn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Kn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Kn({},r)),this.topicMap.set(r.topic,t),this.events.emit(ar.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(ar.deleted,Uc(Kn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ar.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(ar.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);dn(r)&&this.onBatchSubscribe(r.map((n,a)=>Uc(Kn({},t[a]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(os.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(pt.connect,async()=>{await this.onConnect()}),this.relayer.on(pt.disconnect,()=>{this.onDisconnect()}),this.events.on(ar.created,async t=>{const r=ar.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(ar.deleted,async t=>{const r=ar.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var $x=Object.defineProperty,Cf=Object.getOwnPropertySymbols,Cx=Object.prototype.hasOwnProperty,Tx=Object.prototype.propertyIsEnumerable,Tf=(s,t,r)=>t in s?$x(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Nx=(s,t)=>{for(var r in t)Cx.call(t,r)&&Tf(s,r,t[r]);if(Cf)for(var r of Cf(t))Tx.call(t,r)&&Tf(s,r,t[r]);return s};class Dx extends M1{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Xt.EventEmitter,this.name=ex,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(pt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(pt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(zr.payload,this.onPayloadHandler),this.provider.on(zr.connect,this.onConnectHandler),this.provider.on(zr.disconnect,this.onDisconnectHandler),this.provider.on(zr.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?$t(t.logger,this.name):qo(jo({level:t.logger||X2})),this.messages=new _x(this.logger,t.core),this.subscriber=new Ox(this,this.logger),this.publisher=new Ex(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||fd,this.projectId=t.projectId,this.bundleId=u0(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Rf}...`),await this.restartTransport(Rf)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},nx)}get context(){return Ot(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var n;this.isInitialized();let a=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";if(a)return a;let u;const h=p=>{p.topic===t&&(this.subscriber.off(ar.created,h),u())};return await Promise.all([new Promise(p=>{u=p,this.subscriber.on(ar.created,h)}),new Promise(async p=>{a=await this.subscriber.subscribe(t,r),p()})]),a}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await ts(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(ar.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await ts(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(a){n(a);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(zr.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await Al())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Mr(new uP(h0({sdkVersion:ix,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const a=this.messages.has(r,n);return a&&this.logger.debug(`Ignoring duplicate message: ${n}`),a}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),bu(t)){if(!t.method.endsWith(tx))return;const r=t.params,{topic:n,message:a,publishedAt:u}=r.data,h={topic:n,message:a,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(Nx({type:"event",event:r.id},h)),this.events.emit(r.id,h),await this.acknowledgePayload(t),await this.onMessageEvent(h)}else Uo(t)&&this.events.emit(pt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(pt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=zo(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(zr.payload,this.onPayloadHandler),this.provider.off(zr.connect,this.onConnectHandler),this.provider.off(zr.disconnect,this.onDisconnectHandler),this.provider.off(zr.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(pt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await Al();l0(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(pt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},ce.toMiliseconds(rx)))}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var Fx=Object.defineProperty,Nf=Object.getOwnPropertySymbols,qx=Object.prototype.hasOwnProperty,jx=Object.prototype.propertyIsEnumerable,Df=(s,t,r)=>t in s?Fx(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Ff=(s,t)=>{for(var r in t||(t={}))qx.call(t,r)&&Df(s,r,t[r]);if(Nf)for(var r of Nf(t))jx.call(t,r)&&Df(s,r,t[r]);return s};class Ho extends H1{constructor(t,r,n,a=ai,u=void 0){super(t,r,n,a),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=sx,this.cached=[],this.initialized=!1,this.storagePrefix=ai,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(h=>{this.getKey&&h!==null&&!oi(h)?this.map.set(this.getKey(h),h):Yb(h)?this.map.set(h.id,h):Zb(h)&&this.map.set(h.topic,h)}),this.cached=[],this.initialized=!0)},this.set=async(h,p)=>{this.isInitialized(),this.map.has(h)?await this.update(h,p):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:h,value:p}),this.map.set(h,p),await this.persist())},this.get=h=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:h}),this.getData(h)),this.getAll=h=>(this.isInitialized(),h?this.values.filter(p=>Object.keys(h).every(d=>fP(p[d],h[d]))):this.values),this.update=async(h,p)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:h,update:p});const d=Ff(Ff({},this.getData(h)),p);this.map.set(h,d),await this.persist()},this.delete=async(h,p)=>{this.isInitialized(),this.map.has(h)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:h,reason:p}),this.map.delete(h),await this.persist())},this.logger=$t(r,this.name),this.storagePrefix=a,this.getKey=u}get context(){return Ot(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Bx{constructor(t,r){this.core=t,this.logger=r,this.name=hx,this.version=lx,this.events=new cu,this.initialized=!1,this.storagePrefix=ai,this.ignoredPayloadTypes=[cp],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Wc(),a=await this.core.crypto.setSymKey(n),u=cr(ce.FIVE_MINUTES),h={protocol:ld},p={topic:a,expiry:u,relay:h,active:!1},d=f0({protocol:this.core.protocol,version:this.core.version,topic:a,symKey:n,relay:h});return await this.pairings.set(a,p),await this.core.relayer.subscribe(a),this.core.expirer.set(a,u),{topic:a,uri:d}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:a,symKey:u,relay:h}=Rl(n.uri);let p;if(this.pairings.keys.includes(a)&&(p=this.pairings.get(a),p.active))throw new Error(`Pairing already exists: ${a}. Please try again with a new connection URI.`);const d=cr(ce.FIVE_MINUTES),y={topic:a,relay:h,expiry:d,active:!1};return await this.pairings.set(a,y),this.core.expirer.set(a,d),n.activatePairing&&await this.activate({topic:a}),this.events.emit(Zn.create,y),this.core.crypto.keychain.has(a)||(await this.core.crypto.setSymKey(u,a),await this.core.relayer.subscribe(a,{relay:h})),y},this.activate=async({topic:n})=>{this.isInitialized();const a=cr(ce.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:a}),this.core.expirer.set(n,a)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:a}=n;if(this.pairings.keys.includes(a)){const u=await this.sendRequest(a,"wc_pairingPing",{}),{done:h,resolve:p,reject:d}=un();this.events.once(Qe("pairing_ping",u),({error:y})=>{y?d(y):p()}),await h()}},this.updateExpiry=async({topic:n,expiry:a})=>{this.isInitialized(),await this.pairings.update(n,{expiry:a})},this.updateMetadata=async({topic:n,metadata:a})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:a})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:a}=n;this.pairings.keys.includes(a)&&(await this.sendRequest(a,"wc_pairingDelete",ft("USER_DISCONNECTED")),await this.deletePairing(a))},this.sendRequest=async(n,a,u)=>{const h=pn(a,u),p=await this.core.crypto.encode(n,h),d=Vn[a].req;return this.core.history.set(n,h),this.core.relayer.publish(n,p,d),h.id},this.sendResult=async(n,a,u)=>{const h=zo(n,u),p=await this.core.crypto.encode(a,h),d=await this.core.history.get(a,n),y=Vn[d.request.method].res;await this.core.relayer.publish(a,p,y),await this.core.history.resolve(h)},this.sendError=async(n,a,u)=>{const h=Lo(n,u),p=await this.core.crypto.encode(a,h),d=await this.core.history.get(a,n),y=Vn[d.request.method]?Vn[d.request.method].res:Vn.unregistered_method.res;await this.core.relayer.publish(a,p,y),await this.core.history.resolve(h)},this.deletePairing=async(n,a)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,ft("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),a?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(a=>si(a.expiry));await Promise.all(n.map(a=>this.deletePairing(a.topic)))},this.onRelayEventRequest=n=>{const{topic:a,payload:u}=n;switch(u.method){case"wc_pairingPing":return this.onPairingPingRequest(a,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(a,u);default:return this.onUnknownRpcMethodRequest(a,u)}},this.onRelayEventResponse=async n=>{const{topic:a,payload:u}=n,h=(await this.core.history.get(a,u.id)).request.method;switch(h){case"wc_pairingPing":return this.onPairingPingResponse(a,u);default:return this.onUnknownRpcMethodResponse(h)}},this.onPairingPingRequest=async(n,a)=>{const{id:u}=a;try{this.isValidPing({topic:n}),await this.sendResult(u,n,!0),this.events.emit(Zn.ping,{id:u,topic:n})}catch(h){await this.sendError(u,n,h),this.logger.error(h)}},this.onPairingPingResponse=(n,a)=>{const{id:u}=a;setTimeout(()=>{Ur(a)?this.events.emit(Qe("pairing_ping",u),{}):ur(a)&&this.events.emit(Qe("pairing_ping",u),{error:a.error})},500)},this.onPairingDeleteRequest=async(n,a)=>{const{id:u}=a;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Zn.delete,{id:u,topic:n})}catch(h){await this.sendError(u,n,h),this.logger.error(h)}},this.onUnknownRpcMethodRequest=async(n,a)=>{const{id:u,method:h}=a;try{if(this.registeredMethods.includes(h))return;const p=ft("WC_METHOD_UNSUPPORTED",h);await this.sendError(u,n,p),this.logger.error(p)}catch(p){await this.sendError(u,n,p),this.logger.error(p)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(ft("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var a;if(!At(n)){const{message:h}=G("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(h)}if(!p0(n.uri)){const{message:h}=G("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(h)}const u=Rl(n.uri);if(!((a=u==null?void 0:u.relay)!=null&&a.protocol)){const{message:h}=G("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(h)}if(!(u!=null&&u.symKey)){const{message:h}=G("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(h)}},this.isValidPing=async n=>{if(!At(n)){const{message:u}=G("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(u)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidDisconnect=async n=>{if(!At(n)){const{message:u}=G("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(u)}const{topic:a}=n;await this.isValidPairingTopic(a)},this.isValidPairingTopic=async n=>{if(!hn(n,!1)){const{message:a}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(a)}if(!this.pairings.keys.includes(n)){const{message:a}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(a)}if(si(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:a}=G("EXPIRED",`pairing topic: ${n}`);throw new Error(a)}},this.core=t,this.logger=$t(r,this.name),this.pairings=new Ho(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ot(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(pt.message,async t=>{const{topic:r,message:n}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const a=await this.core.crypto.decode(r,n);try{bu(a)?(this.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Uo(a)&&(await this.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.core.history.delete(r,a.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on(Zt.expired,async t=>{const{topic:r}=up(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Zn.expire,{topic:r}))})}}class zx extends z1{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Xt.EventEmitter,this.name=fx,this.version=px,this.cached=[],this.initialized=!1,this.storagePrefix=ai,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,a,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:a,chainId:u}),this.records.has(a.id))return;const h={id:a.id,topic:n,request:{method:a.method,params:a.params||null},chainId:u,expiry:cr(ce.THIRTY_DAYS)};this.records.set(h.id,h),this.events.emit(wr.created,h)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const a=await this.getRecord(n.id);typeof a.response>"u"&&(a.response=ur(n)?{error:n.error}:{result:n.result},this.records.set(a.id,a),this.events.emit(wr.updated,a))},this.get=async(n,a)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:a}),await this.getRecord(a)),this.delete=(n,a)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:a}),this.values.forEach(u=>{if(u.topic===n){if(typeof a<"u"&&u.id!==a)return;this.records.delete(u.id),this.events.emit(wr.deleted,u)}})},this.exists=async(n,a)=>(this.isInitialized(),this.records.has(a)?(await this.getRecord(a)).topic===n:!1),this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=$t(r,this.name)}get context(){return Ot(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:pn(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(wr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(wr.created,t=>{const r=wr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(wr.updated,t=>{const r=wr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(wr.deleted,t=>{const r=wr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(os.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{ce.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Lx extends V1{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Xt.EventEmitter,this.name=dx,this.version=gx,this.cached=[],this.initialized=!1,this.storagePrefix=ai,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const a=this.formatTarget(n);return typeof this.getExpiration(a)<"u"}catch{return!1}},this.set=(n,a)=>{this.isInitialized();const u=this.formatTarget(n),h={target:u,expiry:a};this.expirations.set(u,h),this.checkExpiry(u,h),this.events.emit(Zt.created,{target:u,expiration:h})},this.get=n=>{this.isInitialized();const a=this.formatTarget(n);return this.getExpiration(a)},this.del=n=>{if(this.isInitialized(),this.has(n)){const a=this.formatTarget(n),u=this.getExpiration(a);this.expirations.delete(a),this.events.emit(Zt.deleted,{target:a,expiration:u})}},this.on=(n,a)=>{this.events.on(n,a)},this.once=(n,a)=>{this.events.once(n,a)},this.off=(n,a)=>{this.events.off(n,a)},this.removeListener=(n,a)=>{this.events.removeListener(n,a)},this.logger=$t(r,this.name)}get context(){return Ot(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return d0(t);if(typeof t=="number")return g0(t);const{message:r}=G("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Zt.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=G("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=G("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;ce.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Zt.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(os.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Zt.created,t=>{const r=Zt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Zt.expired,t=>{const r=Zt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Zt.deleted,t=>{const r=Zt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}}}class Ux extends K1{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=Lc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||y0()||!hp())return;const a=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==a&&this.removeIframe(),this.verifyUrl=a;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u)}if(!this.initialized){this.removeIframe(),this.verifyUrl=nu;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const a=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let u;try{u=await this.fetchAttestation(n.attestationId,a)}catch(h){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${a}`),this.logger.info(h),u=await this.fetchAttestation(n.attestationId,nu)}return u},this.fetchAttestation=async(n,a)=>{this.logger.info(`resolving attestation: ${n} from url: ${a}`);const u=this.startAbortTimer(ce.ONE_SECOND*2),h=await fetch(`${a}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(u),h.status===200?await h.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var a;try{if(!this.iframe)return;(a=this.iframe.contentWindow)==null||a.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const a=u=>{u.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",a),n())};await Promise.race([new Promise(u=>{if(document.getElementById(Lc))return u();window.addEventListener("message",a);const h=document.createElement("iframe");h.id=Lc,h.src=`${this.verifyUrl}/${this.projectId}`,h.style.display="none",document.body.append(h),this.iframe=h,n=u}),new Promise((u,h)=>setTimeout(()=>{window.removeEventListener("message",a),h("verify iframe load timeout")},ce.toMiliseconds(ce.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let a=n||ln;return yx.includes(a)||(this.logger.info(`verify url: ${a}, not included in trusted list, assigning default: ${ln}`),a=ln),a},this.logger=$t(r,this.name),this.verifyUrl=ln,this.abortController=new AbortController,this.isDevEnv=m0()&&vP.IS_VITEST}get context(){return Ot(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ce.toMiliseconds(t))}}class Mx extends G1{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.context=mx,this.registerDeviceToken=async n=>{const{clientId:a,token:u,notificationType:h,enableEncrypted:p=!1}=n,d=`${vx}/${this.projectId}/clients`;await mP(d,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({client_id:a,type:h,token:u,always_raw:p})})},this.logger=$t(r,this.context)}}var Hx=Object.defineProperty,qf=Object.getOwnPropertySymbols,kx=Object.prototype.hasOwnProperty,Vx=Object.prototype.propertyIsEnumerable,jf=(s,t,r)=>t in s?Hx(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Bf=(s,t)=>{for(var r in t||(t={}))kx.call(t,r)&&jf(s,r,t[r]);if(qf)for(var r of qf(t))Vx.call(t,r)&&jf(s,r,t[r]);return s};class Eu extends B1{constructor(t){super(t),this.protocol=hd,this.version=M2,this.name=_u,this.events=new Xt.EventEmitter,this.initialized=!1,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||fd,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:qo(jo({level:(t==null?void 0:t.logger)||H2.logger}));this.logger=$t(r,this.name),this.heartbeat=new os.HeartBeat,this.crypto=new bx(this,this.logger,t==null?void 0:t.keychain),this.history=new zx(this,this.logger),this.expirer=new Lx(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new m1(Bf(Bf({},k2),t==null?void 0:t.storageOptions)),this.relayer=new Dx({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new Bx(this,this.logger),this.verify=new Ux(this.projectId||"",this.logger),this.echoClient=new Mx(this.projectId||"",this.logger)}static async init(t){const r=new Eu(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(ox,n),r}get context(){return Ot(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const Kx=Eu,pd="wc",dd=2,gd="client",Iu=`${pd}@${dd}:${gd}:`,Mc={name:gd,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},zf="WALLETCONNECT_DEEPLINK_CHOICE",Gx="proposal",yd="Proposal expired",Wx="session",xo=ce.SEVEN_DAYS,Jx="engine",Gn={wc_sessionPropose:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ce.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ce.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ce.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ce.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ce.THIRTY_SECONDS,prompt:!1,tag:1115}}},Hc={min:ce.FIVE_MINUTES,max:ce.SEVEN_DAYS},Lr={idle:"IDLE",active:"ACTIVE"},Qx="request",Yx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var Zx=Object.defineProperty,Xx=Object.defineProperties,eS=Object.getOwnPropertyDescriptors,Lf=Object.getOwnPropertySymbols,tS=Object.prototype.hasOwnProperty,rS=Object.prototype.propertyIsEnumerable,Uf=(s,t,r)=>t in s?Zx(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,xt=(s,t)=>{for(var r in t||(t={}))tS.call(t,r)&&Uf(s,r,t[r]);if(Lf)for(var r of Lf(t))rS.call(t,r)&&Uf(s,r,t[r]);return s},Wn=(s,t)=>Xx(s,eS(t));class iS extends J1{constructor(t){super(t),this.name=Jx,this.events=new cu,this.initialized=!1,this.ignoredPayloadTypes=[cp],this.requestQueue={state:Lr.idle,queue:[]},this.sessionRequestQueue={state:Lr.idle,queue:[]},this.requestQueueDelay=ce.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Gn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ce.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=Wn(xt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:a,requiredNamespaces:u,optionalNamespaces:h,sessionProperties:p,relays:d}=n;let y=a,v,_=!1;if(y&&(_=this.client.core.pairing.pairings.get(y).active),!y||!_){const{topic:B,uri:J}=await this.client.core.pairing.create();y=B,v=J}const I=await this.client.core.crypto.generateKeyPair(),$=xt({requiredNamespaces:u,optionalNamespaces:h,relays:d??[{protocol:ld}],proposer:{publicKey:I,metadata:this.client.metadata}},p&&{sessionProperties:p}),{reject:R,resolve:C,done:V}=un(ce.FIVE_MINUTES,yd);if(this.events.once(Qe("session_connect"),async({error:B,session:J})=>{if(B)R(B);else if(J){J.self.publicKey=I;const re=Wn(xt({},J),{requiredNamespaces:J.requiredNamespaces,optionalNamespaces:J.optionalNamespaces});await this.client.session.set(J.topic,re),await this.setExpiry(J.topic,J.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:J.peer.metadata}),C(re)}}),!y){const{message:B}=G("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(B)}const ee=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:$}),ie=cr(ce.FIVE_MINUTES);return await this.setProposal(ee,xt({id:ee,expiry:ie},$)),{uri:v,approval:V}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:a,namespaces:u,sessionProperties:h}=r,p=this.client.proposal.get(n);let{pairingTopic:d,proposer:y,requiredNamespaces:v,optionalNamespaces:_}=p;d=d||"",$o(v)||(v=w0(u,"approve()"));const I=await this.client.core.crypto.generateKeyPair(),$=y.publicKey,R=await this.client.core.crypto.generateSharedKey(I,$);d&&n&&(await this.client.core.pairing.updateMetadata({topic:d,metadata:y.metadata}),await this.sendResult({id:n,topic:d,result:{relay:{protocol:a??"irn"},responderPublicKey:I}}),await this.client.proposal.delete(n,ft("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:d}));const C=xt({relay:{protocol:a??"irn"},namespaces:u,requiredNamespaces:v,optionalNamespaces:_,pairingTopic:d,controller:{publicKey:I,metadata:this.client.metadata},expiry:cr(xo)},h&&{sessionProperties:h});await this.client.core.relayer.subscribe(R),await this.sendRequest({topic:R,method:"wc_sessionSettle",params:C,throwOnFailedPublish:!0});const V=Wn(xt({},C),{topic:R,pairingTopic:d,acknowledged:!1,self:C.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:I});return await this.client.session.set(R,V),await this.setExpiry(R,cr(xo)),{topic:R,acknowledged:()=>new Promise(ee=>setTimeout(()=>ee(this.client.session.get(R)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:a}=r,{pairingTopic:u}=this.client.proposal.get(n);u&&(await this.sendError(n,u,a),await this.client.proposal.delete(n,ft("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:a}=r,u=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:a}}),{done:h,resolve:p,reject:d}=un();return this.events.once(Qe("session_update",u),({error:y})=>{y?d(y):p()}),await this.client.session.update(n,{namespaces:a}),{acknowledged:h}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,a=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:u,resolve:h,reject:p}=un();return this.events.once(Qe("session_extend",a),({error:d})=>{d?p(d):h()}),await this.setExpiry(n,cr(xo)),{acknowledged:u}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:a,topic:u,expiry:h}=r,p=wu(),{done:d,resolve:y,reject:v}=un(h,"Request expired. Please try again.");return this.events.once(Qe("session_request",p),({error:_,result:I})=>{_?v(_):y(I)}),await Promise.all([new Promise(async _=>{await this.sendRequest({clientRpcId:p,topic:u,method:"wc_sessionRequest",params:{request:a,chainId:n},expiry:h,throwOnFailedPublish:!0}).catch(I=>v(I)),this.client.events.emit("session_request_sent",{topic:u,request:a,chainId:n,id:p}),_()}),new Promise(async _=>{const I=await b0(this.client.core.storage,zf);_0({id:p,topic:u,wcDeepLink:I}),_()}),d()]).then(_=>_[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:a}=r,{id:u}=a;Ur(a)?await this.sendResult({id:u,topic:n,result:a.result,throwOnFailedPublish:!0}):ur(a)&&await this.sendError(u,n,a.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const a=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:u,resolve:h,reject:p}=un();this.events.once(Qe("session_ping",a),({error:d})=>{d?p(d):h()}),await u()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:a,chainId:u}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:a,chainId:u}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:ft("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>E0(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),a=this.client.core.pairing.pairings.getAll().filter(u=>{var h,p;return((h=u.peerMetadata)==null?void 0:h.url)&&((p=u.peerMetadata)==null?void 0:p.url)===r.peer.metadata.url&&u.topic&&u.topic!==n.topic});if(a.length===0)return;this.client.logger.info(`Cleaning up ${a.length} duplicate pairing(s)`),await Promise.all(a.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:a}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,ft("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(a.publicKey)&&await this.client.core.crypto.deleteKeyPair(a.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(zf).catch(u=>this.client.logger.warn(u)),this.getPendingSessionRequests().forEach(u=>{u.topic===r&&this.deletePendingSessionRequest(u.id,ft("USER_DISCONNECTED"))})},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,ft("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,a=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),a?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(u=>u.id!==r),a&&(this.sessionRequestQueue.state=Lr.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Gn.wc_sessionRequest.req.ttl,{id:a,topic:u,params:h,verifyContext:p}=r;await this.client.pendingRequest.set(a,{id:a,topic:u,params:h,verifyContext:p}),n&&this.client.core.expirer.set(a,cr(n))},this.sendRequest=async r=>{const{topic:n,method:a,params:u,expiry:h,relayRpcId:p,clientRpcId:d,throwOnFailedPublish:y}=r,v=pn(a,u,d);if(hp()&&Yx.includes(a)){const $=fn(JSON.stringify(v));this.client.core.verify.register({attestationId:$})}const _=await this.client.core.crypto.encode(n,v),I=Gn[a].req;return h&&(I.ttl=h),p&&(I.id=p),this.client.core.history.set(n,v),y?(I.internal=Wn(xt({},I.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,_,I)):this.client.core.relayer.publish(n,_,I).catch($=>this.client.logger.error($)),v.id},this.sendResult=async r=>{const{id:n,topic:a,result:u,throwOnFailedPublish:h}=r,p=zo(n,u),d=await this.client.core.crypto.encode(a,p),y=await this.client.core.history.get(a,n),v=Gn[y.request.method].res;h?(v.internal=Wn(xt({},v.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(a,d,v)):this.client.core.relayer.publish(a,d,v).catch(_=>this.client.logger.error(_)),await this.client.core.history.resolve(p)},this.sendError=async(r,n,a)=>{const u=Lo(r,a),h=await this.client.core.crypto.encode(n,u),p=await this.client.core.history.get(n,r),d=Gn[p.request.method].res;this.client.core.relayer.publish(n,h,d),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(a=>{si(a.expiry)&&r.push(a.topic)}),this.client.proposal.getAll().forEach(a=>{si(a.expiry)&&n.push(a.id)}),await Promise.all([...r.map(a=>this.deleteSession(a)),...n.map(a=>this.deleteProposal(a))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===Lr.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=Lr.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=Lr.idle},this.processRequest=r=>{const{topic:n,payload:a}=r,u=a.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(n,a);case"wc_sessionSettle":return this.onSessionSettleRequest(n,a);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,a);case"wc_sessionExtend":return this.onSessionExtendRequest(n,a);case"wc_sessionPing":return this.onSessionPingRequest(n,a);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,a);case"wc_sessionRequest":return this.onSessionRequest(n,a);case"wc_sessionEvent":return this.onSessionEventRequest(n,a);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:a}=r,u=(await this.client.core.history.get(n,a.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(n,a);case"wc_sessionSettle":return this.onSessionSettleResponse(n,a);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,a);case"wc_sessionExtend":return this.onSessionExtendResponse(n,a);case"wc_sessionPing":return this.onSessionPingResponse(n,a);case"wc_sessionRequest":return this.onSessionRequestResponse(n,a);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:a}=G("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(a)},this.onSessionProposeRequest=async(r,n)=>{const{params:a,id:u}=n;try{this.isValidConnect(xt({},n.params));const h=cr(ce.FIVE_MINUTES),p=xt({id:u,pairingTopic:r,expiry:h},a);await this.setProposal(u,p);const d=fn(JSON.stringify(n)),y=await this.getVerifyContext(d,p.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:p,verifyContext:y})}catch(h){await this.sendError(u,r,h),this.client.logger.error(h)}},this.onSessionProposeResponse=async(r,n)=>{const{id:a}=n;if(Ur(n)){const{result:u}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const h=this.client.proposal.get(a);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:h});const p=h.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:p});const d=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:d});const y=await this.client.core.crypto.generateSharedKey(p,d);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const v=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:v}),await this.client.core.pairing.activate({topic:r})}else ur(n)&&(await this.client.proposal.delete(a,ft("USER_DISCONNECTED")),this.events.emit(Qe("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:a,params:u}=n;try{this.isValidSessionSettleRequest(u);const{relay:h,controller:p,expiry:d,namespaces:y,requiredNamespaces:v,optionalNamespaces:_,sessionProperties:I,pairingTopic:$}=n.params,R=xt({topic:r,relay:h,expiry:d,namespaces:y,acknowledged:!0,pairingTopic:$,requiredNamespaces:v,optionalNamespaces:_,controller:p.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:p.publicKey,metadata:p.metadata}},I&&{sessionProperties:I});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(Qe("session_connect"),{session:R}),this.cleanupDuplicatePairings(R)}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionSettleResponse=async(r,n)=>{const{id:a}=n;Ur(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Qe("session_approve",a),{})):ur(n)&&(await this.client.session.delete(r,ft("USER_DISCONNECTED")),this.events.emit(Qe("session_approve",a),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:a,id:u}=n;try{const h=`${r}_session_update`,p=wo.get(h);if(p&&this.isRequestOutOfSync(p,u)){this.client.logger.info(`Discarding out of sync request - ${u}`);return}this.isValidUpdate(xt({topic:r},a)),await this.client.session.update(r,{namespaces:a.namespaces}),await this.sendResult({id:u,topic:r,result:!0}),this.client.events.emit("session_update",{id:u,topic:r,params:a}),wo.set(h,u)}catch(h){await this.sendError(u,r,h),this.client.logger.error(h)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:a}=n;Ur(n)?this.events.emit(Qe("session_update",a),{}):ur(n)&&this.events.emit(Qe("session_update",a),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:a}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,cr(xo)),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_extend",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(r,n)=>{const{id:a}=n;Ur(n)?this.events.emit(Qe("session_extend",a),{}):ur(n)&&this.events.emit(Qe("session_extend",a),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:a}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:a,topic:r,result:!0}),this.client.events.emit("session_ping",{id:a,topic:r})}catch(u){await this.sendError(a,r,u),this.client.logger.error(u)}},this.onSessionPingResponse=(r,n)=>{const{id:a}=n;setTimeout(()=>{Ur(n)?this.events.emit(Qe("session_ping",a),{}):ur(n)&&this.events.emit(Qe("session_ping",a),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:a}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(u=>{this.client.core.relayer.once(pt.publish,async()=>{u(await this.deleteSession(r))})}),this.sendResult({id:a,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:a,topic:r})}catch(u){this.client.logger.error(u)}},this.onSessionRequest=async(r,n)=>{const{id:a,params:u}=n;try{this.isValidRequest(xt({topic:r},u));const h=fn(JSON.stringify(pn("wc_sessionRequest",u,a))),p=this.client.session.get(r),d=await this.getVerifyContext(h,p.peer.metadata),y={id:a,topic:r,params:u,verifyContext:d};await this.setPendingSessionRequest(y),this.addSessionRequestToSessionRequestQueue(y),this.processSessionRequestQueue()}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.onSessionRequestResponse=(r,n)=>{const{id:a}=n;Ur(n)?this.events.emit(Qe("session_request",a),{result:n.result}):ur(n)&&this.events.emit(Qe("session_request",a),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:a,params:u}=n;try{const h=`${r}_session_event_${u.event.name}`,p=wo.get(h);if(p&&this.isRequestOutOfSync(p,a)){this.client.logger.info(`Discarding out of sync request - ${a}`);return}this.isValidEmit(xt({topic:r},u)),this.client.events.emit("session_event",{id:a,topic:r,params:u}),wo.set(h,a)}catch(h){await this.sendError(a,r,h),this.client.logger.error(h)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=Lr.idle,this.processSessionRequestQueue()},ce.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===Lr.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=Lr.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(a=>a.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,pn("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async r=>{if(!At(r)){const{message:d}=G("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(d)}const{pairingTopic:n,requiredNamespaces:a,optionalNamespaces:u,sessionProperties:h,relays:p}=r;if(oi(n)||await this.isValidPairingTopic(n),!I0(p)){const{message:d}=G("MISSING_OR_INVALID",`connect() relays: ${p}`);throw new Error(d)}!oi(a)&&$o(a)!==0&&this.validateNamespaces(a,"requiredNamespaces"),!oi(u)&&$o(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),oi(h)||this.validateSessionProps(h,"sessionProperties")},this.validateNamespaces=(r,n)=>{const a=P0(r,"connect()",n);if(a)throw new Error(a.message)},this.isValidApprove=async r=>{if(!At(r))throw new Error(G("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:a,relayProtocol:u,sessionProperties:h}=r;await this.isValidProposalId(n);const p=this.client.proposal.get(n),d=bc(a,"approve()");if(d)throw new Error(d.message);const y=Ol(p.requiredNamespaces,a,"approve()");if(y)throw new Error(y.message);if(!hn(u,!0)){const{message:v}=G("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(v)}oi(h)||this.validateSessionProps(h,"sessionProperties")},this.isValidReject=async r=>{if(!At(r)){const{message:u}=G("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(u)}const{id:n,reason:a}=r;if(await this.isValidProposalId(n),!x0(a)){const{message:u}=G("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(a)}`);throw new Error(u)}},this.isValidSessionSettleRequest=r=>{if(!At(r)){const{message:y}=G("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(y)}const{relay:n,controller:a,namespaces:u,expiry:h}=r;if(!S0(n)){const{message:y}=G("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const p=A0(a,"onSessionSettleRequest()");if(p)throw new Error(p.message);const d=bc(u,"onSessionSettleRequest()");if(d)throw new Error(d.message);if(si(h)){const{message:y}=G("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async r=>{if(!At(r)){const{message:d}=G("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(d)}const{topic:n,namespaces:a}=r;await this.isValidSessionTopic(n);const u=this.client.session.get(n),h=bc(a,"update()");if(h)throw new Error(h.message);const p=Ol(u.requiredNamespaces,a,"update()");if(p)throw new Error(p.message)},this.isValidExtend=async r=>{if(!At(r)){const{message:a}=G("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!At(r)){const{message:d}=G("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(d)}const{topic:n,request:a,chainId:u,expiry:h}=r;await this.isValidSessionTopic(n);const{namespaces:p}=this.client.session.get(n);if(!$l(p,u)){const{message:d}=G("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(d)}if(!R0(a)){const{message:d}=G("MISSING_OR_INVALID",`request() ${JSON.stringify(a)}`);throw new Error(d)}if(!O0(p,u,a.method)){const{message:d}=G("MISSING_OR_INVALID",`request() method: ${a.method}`);throw new Error(d)}if(h&&!$0(h,Hc)){const{message:d}=G("MISSING_OR_INVALID",`request() expiry: ${h}. Expiry must be a number (in seconds) between ${Hc.min} and ${Hc.max}`);throw new Error(d)}},this.isValidRespond=async r=>{var n;if(!At(r)){const{message:h}=G("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(h)}const{topic:a,response:u}=r;try{await this.isValidSessionTopic(a)}catch(h){throw(n=r==null?void 0:r.response)!=null&&n.id&&this.cleanupAfterResponse(r),h}if(!C0(u)){const{message:h}=G("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(u)}`);throw new Error(h)}},this.isValidPing=async r=>{if(!At(r)){const{message:a}=G("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!At(r)){const{message:p}=G("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(p)}const{topic:n,event:a,chainId:u}=r;await this.isValidSessionTopic(n);const{namespaces:h}=this.client.session.get(n);if(!$l(h,u)){const{message:p}=G("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(p)}if(!T0(a)){const{message:p}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(p)}if(!N0(h,u,a.name)){const{message:p}=G("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(a)}`);throw new Error(p)}},this.isValidDisconnect=async r=>{if(!At(r)){const{message:a}=G("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(a)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const a={verified:{verifyUrl:n.verifyUrl||ln,validation:"UNKNOWN",origin:n.url||""}};try{const u=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});u&&(a.verified.origin=u.origin,a.verified.isScam=u.isScam,a.verified.validation=u.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.info(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(a)}`),a},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(a=>{if(!hn(a,!1)){const{message:u}=G("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(a)}`);throw new Error(u)}})}}async isInitialized(){if(!this.initialized){const{message:t}=G("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(pt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const a=await this.client.core.crypto.decode(r,n);try{bu(a)?(this.client.core.history.set(r,a),this.onRelayEventRequest({topic:r,payload:a})):Uo(a)?(await this.client.core.history.resolve(a),await this.onRelayEventResponse({topic:r,payload:a}),this.client.core.history.delete(r,a.id)):this.onRelayEventUnknownPayload({topic:r,payload:a})}catch(u){this.client.logger.error(u)}})}registerExpirerEvents(){this.client.core.expirer.on(Zt.expired,async t=>{const{topic:r,id:n}=up(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,G("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Zn.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!hn(t,!1)){const{message:r}=G("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(si(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=G("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!hn(t,!1)){const{message:r}=G("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(si(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=G("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(hn(t,!1)){const{message:r}=G("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=G("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!D0(t)){const{message:r}=G("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=G("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(si(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=G("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class nS extends Ho{constructor(t,r){super(t,r,Gx,Iu),this.core=t,this.logger=r}}class sS extends Ho{constructor(t,r){super(t,r,Wx,Iu),this.core=t,this.logger=r}}class oS extends Ho{constructor(t,r){super(t,r,Qx,Iu,n=>n.id),this.core=t,this.logger=r}}let aS=class md extends W1{constructor(t){super(t),this.protocol=pd,this.version=dd,this.name=Mc.name,this.events=new Xt.EventEmitter,this.on=(n,a)=>this.events.on(n,a),this.once=(n,a)=>this.events.once(n,a),this.off=(n,a)=>this.events.off(n,a),this.removeListener=(n,a)=>this.events.removeListener(n,a),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(a){throw this.logger.error(a.message),a}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(a){throw this.logger.error(a.message),a}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(a){throw this.logger.error(a.message),a}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(a){throw this.logger.error(a.message),a}},this.update=async n=>{try{return await this.engine.update(n)}catch(a){throw this.logger.error(a.message),a}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(a){throw this.logger.error(a.message),a}},this.request=async n=>{try{return await this.engine.request(n)}catch(a){throw this.logger.error(a.message),a}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(a){throw this.logger.error(a.message),a}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(a){throw this.logger.error(a.message),a}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(a){throw this.logger.error(a.message),a}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(a){throw this.logger.error(a.message),a}},this.find=n=>{try{return this.engine.find(n)}catch(a){throw this.logger.error(a.message),a}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||Mc.name,this.metadata=(t==null?void 0:t.metadata)||v0();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:qo(jo({level:(t==null?void 0:t.logger)||Mc.logger}));this.core=(t==null?void 0:t.core)||new Kx(t),this.logger=$t(r,this.name),this.session=new sS(this.core,this.logger),this.proposal=new nS(this.core,this.logger),this.pendingRequest=new oS(this.core,this.logger),this.engine=new iS(this)}static async init(t){const r=new md(t);return await r.initialize(),r}get context(){return Ot(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};var So={exports:{}},Mf;function cS(){return Mf||(Mf=1,function(s,t){var r=typeof globalThis<"u"&&globalThis||typeof self<"u"&&self||typeof Rt<"u"&&Rt,n=function(){function u(){this.fetch=!1,this.DOMException=r.DOMException}return u.prototype=r,new u}();(function(u){(function(h){var p=typeof u<"u"&&u||typeof self<"u"&&self||typeof Rt<"u"&&Rt||{},d={searchParams:"URLSearchParams"in p,iterable:"Symbol"in p&&"iterator"in Symbol,blob:"FileReader"in p&&"Blob"in p&&function(){try{return new Blob,!0}catch{return!1}}(),formData:"FormData"in p,arrayBuffer:"ArrayBuffer"in p};function y(E){return E&&DataView.prototype.isPrototypeOf(E)}if(d.arrayBuffer)var v=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=ArrayBuffer.isView||function(E){return E&&v.indexOf(Object.prototype.toString.call(E))>-1};function I(E){if(typeof E!="string"&&(E=String(E)),/[^a-z0-9\-#$%&'*+.^_`|~!]/i.test(E)||E==="")throw new TypeError('Invalid character in header field name: "'+E+'"');return E.toLowerCase()}function $(E){return typeof E!="string"&&(E=String(E)),E}function R(E){var A={next:function(){var z=E.shift();return{done:z===void 0,value:z}}};return d.iterable&&(A[Symbol.iterator]=function(){return A}),A}function C(E){this.map={},E instanceof C?E.forEach(function(A,z){this.append(z,A)},this):Array.isArray(E)?E.forEach(function(A){if(A.length!=2)throw new TypeError("Headers constructor: expected name/value pair to be length 2, found"+A.length);this.append(A[0],A[1])},this):E&&Object.getOwnPropertyNames(E).forEach(function(A){this.append(A,E[A])},this)}C.prototype.append=function(E,A){E=I(E),A=$(A);var z=this.map[E];this.map[E]=z?z+", "+A:A},C.prototype.delete=function(E){delete this.map[I(E)]},C.prototype.get=function(E){return E=I(E),this.has(E)?this.map[E]:null},C.prototype.has=function(E){return this.map.hasOwnProperty(I(E))},C.prototype.set=function(E,A){this.map[I(E)]=$(A)},C.prototype.forEach=function(E,A){for(var z in this.map)this.map.hasOwnProperty(z)&&E.call(A,this.map[z],z,this)},C.prototype.keys=function(){var E=[];return this.forEach(function(A,z){E.push(z)}),R(E)},C.prototype.values=function(){var E=[];return this.forEach(function(A){E.push(A)}),R(E)},C.prototype.entries=function(){var E=[];return this.forEach(function(A,z){E.push([z,A])}),R(E)},d.iterable&&(C.prototype[Symbol.iterator]=C.prototype.entries);function V(E){if(!E._noBody){if(E.bodyUsed)return Promise.reject(new TypeError("Already read"));E.bodyUsed=!0}}function ee(E){return new Promise(function(A,z){E.onload=function(){A(E.result)},E.onerror=function(){z(E.error)}})}function ie(E){var A=new FileReader,z=ee(A);return A.readAsArrayBuffer(E),z}function B(E){var A=new FileReader,z=ee(A),M=/charset=([A-Za-z0-9_-]+)/.exec(E.type),Y=M?M[1]:"utf-8";return A.readAsText(E,Y),z}function J(E){for(var A=new Uint8Array(E),z=new Array(A.length),M=0;M<A.length;M++)z[M]=String.fromCharCode(A[M]);return z.join("")}function re(E){if(E.slice)return E.slice(0);var A=new Uint8Array(E.byteLength);return A.set(new Uint8Array(E)),A.buffer}function T(){return this.bodyUsed=!1,this._initBody=function(E){this.bodyUsed=this.bodyUsed,this._bodyInit=E,E?typeof E=="string"?this._bodyText=E:d.blob&&Blob.prototype.isPrototypeOf(E)?this._bodyBlob=E:d.formData&&FormData.prototype.isPrototypeOf(E)?this._bodyFormData=E:d.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)?this._bodyText=E.toString():d.arrayBuffer&&d.blob&&y(E)?(this._bodyArrayBuffer=re(E.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):d.arrayBuffer&&(ArrayBuffer.prototype.isPrototypeOf(E)||_(E))?this._bodyArrayBuffer=re(E):this._bodyText=E=Object.prototype.toString.call(E):(this._noBody=!0,this._bodyText=""),this.headers.get("content-type")||(typeof E=="string"?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):d.searchParams&&URLSearchParams.prototype.isPrototypeOf(E)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},d.blob&&(this.blob=function(){var E=V(this);if(E)return E;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))}),this.arrayBuffer=function(){if(this._bodyArrayBuffer){var E=V(this);return E||(ArrayBuffer.isView(this._bodyArrayBuffer)?Promise.resolve(this._bodyArrayBuffer.buffer.slice(this._bodyArrayBuffer.byteOffset,this._bodyArrayBuffer.byteOffset+this._bodyArrayBuffer.byteLength)):Promise.resolve(this._bodyArrayBuffer))}else{if(d.blob)return this.blob().then(ie);throw new Error("could not read as ArrayBuffer")}},this.text=function(){var E=V(this);if(E)return E;if(this._bodyBlob)return B(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(J(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},d.formData&&(this.formData=function(){return this.text().then(ue)}),this.json=function(){return this.text().then(JSON.parse)},this}var U=["CONNECT","DELETE","GET","HEAD","OPTIONS","PATCH","POST","PUT","TRACE"];function H(E){var A=E.toUpperCase();return U.indexOf(A)>-1?A:E}function Q(E,A){if(!(this instanceof Q))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');A=A||{};var z=A.body;if(E instanceof Q){if(E.bodyUsed)throw new TypeError("Already read");this.url=E.url,this.credentials=E.credentials,A.headers||(this.headers=new C(E.headers)),this.method=E.method,this.mode=E.mode,this.signal=E.signal,!z&&E._bodyInit!=null&&(z=E._bodyInit,E.bodyUsed=!0)}else this.url=String(E);if(this.credentials=A.credentials||this.credentials||"same-origin",(A.headers||!this.headers)&&(this.headers=new C(A.headers)),this.method=H(A.method||this.method||"GET"),this.mode=A.mode||this.mode||null,this.signal=A.signal||this.signal||function(){if("AbortController"in p){var L=new AbortController;return L.signal}}(),this.referrer=null,(this.method==="GET"||this.method==="HEAD")&&z)throw new TypeError("Body not allowed for GET or HEAD requests");if(this._initBody(z),(this.method==="GET"||this.method==="HEAD")&&(A.cache==="no-store"||A.cache==="no-cache")){var M=/([?&])_=[^&]*/;if(M.test(this.url))this.url=this.url.replace(M,"$1_="+new Date().getTime());else{var Y=/\?/;this.url+=(Y.test(this.url)?"&":"?")+"_="+new Date().getTime()}}}Q.prototype.clone=function(){return new Q(this,{body:this._bodyInit})};function ue(E){var A=new FormData;return E.trim().split("&").forEach(function(z){if(z){var M=z.split("="),Y=M.shift().replace(/\+/g," "),L=M.join("=").replace(/\+/g," ");A.append(decodeURIComponent(Y),decodeURIComponent(L))}}),A}function be(E){var A=new C,z=E.replace(/\r?\n[\t ]+/g," ");return z.split("\r").map(function(M){return M.indexOf(`
`)===0?M.substr(1,M.length):M}).forEach(function(M){var Y=M.split(":"),L=Y.shift().trim();if(L){var se=Y.join(":").trim();try{A.append(L,se)}catch(xe){console.warn("Response "+xe.message)}}}),A}T.call(Q.prototype);function de(E,A){if(!(this instanceof de))throw new TypeError('Please use the "new" operator, this DOM object constructor cannot be called as a function.');if(A||(A={}),this.type="default",this.status=A.status===void 0?200:A.status,this.status<200||this.status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this.ok=this.status>=200&&this.status<300,this.statusText=A.statusText===void 0?"":""+A.statusText,this.headers=new C(A.headers),this.url=A.url||"",this._initBody(E)}T.call(de.prototype),de.prototype.clone=function(){return new de(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new C(this.headers),url:this.url})},de.error=function(){var E=new de(null,{status:200,statusText:""});return E.ok=!1,E.status=0,E.type="error",E};var Ue=[301,302,303,307,308];de.redirect=function(E,A){if(Ue.indexOf(A)===-1)throw new RangeError("Invalid status code");return new de(null,{status:A,headers:{location:E}})},h.DOMException=p.DOMException;try{new h.DOMException}catch{h.DOMException=function(A,z){this.message=A,this.name=z;var M=Error(A);this.stack=M.stack},h.DOMException.prototype=Object.create(Error.prototype),h.DOMException.prototype.constructor=h.DOMException}function te(E,A){return new Promise(function(z,M){var Y=new Q(E,A);if(Y.signal&&Y.signal.aborted)return M(new h.DOMException("Aborted","AbortError"));var L=new XMLHttpRequest;function se(){L.abort()}L.onload=function(){var he={statusText:L.statusText,headers:be(L.getAllResponseHeaders()||"")};Y.url.indexOf("file://")===0&&(L.status<200||L.status>599)?he.status=200:he.status=L.status,he.url="responseURL"in L?L.responseURL:he.headers.get("X-Request-URL");var Z="response"in L?L.response:L.responseText;setTimeout(function(){z(new de(Z,he))},0)},L.onerror=function(){setTimeout(function(){M(new TypeError("Network request failed"))},0)},L.ontimeout=function(){setTimeout(function(){M(new TypeError("Network request timed out"))},0)},L.onabort=function(){setTimeout(function(){M(new h.DOMException("Aborted","AbortError"))},0)};function xe(he){try{return he===""&&p.location.href?p.location.href:he}catch{return he}}if(L.open(Y.method,xe(Y.url),!0),Y.credentials==="include"?L.withCredentials=!0:Y.credentials==="omit"&&(L.withCredentials=!1),"responseType"in L&&(d.blob?L.responseType="blob":d.arrayBuffer&&(L.responseType="arraybuffer")),A&&typeof A.headers=="object"&&!(A.headers instanceof C||p.Headers&&A.headers instanceof p.Headers)){var we=[];Object.getOwnPropertyNames(A.headers).forEach(function(he){we.push(I(he)),L.setRequestHeader(he,$(A.headers[he]))}),Y.headers.forEach(function(he,Z){we.indexOf(Z)===-1&&L.setRequestHeader(Z,he)})}else Y.headers.forEach(function(he,Z){L.setRequestHeader(Z,he)});Y.signal&&(Y.signal.addEventListener("abort",se),L.onreadystatechange=function(){L.readyState===4&&Y.signal.removeEventListener("abort",se)}),L.send(typeof Y._bodyInit>"u"?null:Y._bodyInit)})}return te.polyfill=!0,p.fetch||(p.fetch=te,p.Headers=C,p.Request=Q,p.Response=de),h.Headers=C,h.Request=Q,h.Response=de,h.fetch=te,Object.defineProperty(h,"__esModule",{value:!0}),h})({})})(n),n.fetch.ponyfill=!0,delete n.fetch.polyfill;var a=r.fetch?r:n;t=a.fetch,t.default=a.fetch,t.fetch=a.fetch,t.Headers=a.Headers,t.Request=a.Request,t.Response=a.Response,s.exports=t}(So,So.exports)),So.exports}var uS=cS();const Hf=rs(uS);var hS=Object.defineProperty,lS=Object.defineProperties,fS=Object.getOwnPropertyDescriptors,kf=Object.getOwnPropertySymbols,pS=Object.prototype.hasOwnProperty,dS=Object.prototype.propertyIsEnumerable,Vf=(s,t,r)=>t in s?hS(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Kf=(s,t)=>{for(var r in t)pS.call(t,r)&&Vf(s,r,t[r]);if(kf)for(var r of kf(t))dS.call(t,r)&&Vf(s,r,t[r]);return s},Gf=(s,t)=>lS(s,fS(t));const gS={Accept:"application/json","Content-Type":"application/json"},yS="POST",Wf={headers:gS,method:yS},Jf=10;let ui=class{constructor(t,r=!1){if(this.url=t,this.disableProviderPing=r,this.events=new Xt.EventEmitter,this.isAvailable=!1,this.registering=!1,!df(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);this.url=t,this.disableProviderPing=r}get connected(){return this.isAvailable}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(t){this.isAvailable||await this.register();try{const r=Ai(t),n=await(await Hf(this.url,Gf(Kf({},Wf),{body:r}))).json();this.onPayload({data:n})}catch(r){this.onError(t.id,r)}}async register(t=this.url){if(!df(t))throw new Error(`Provided URL is not compatible with HTTP connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,a)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),a(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return a(new Error("HTTP connection is missing or invalid"));n()})})}this.url=t,this.registering=!0;try{if(!this.disableProviderPing){const r=Ai({id:1,jsonrpc:"2.0",method:"test",params:[]});await Hf(t,Gf(Kf({},Wf),{body:r}))}this.onOpen()}catch(r){const n=this.parseError(r);throw this.events.emit("register_error",n),this.onClose(),n}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?ss(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),a=n.message||n.toString(),u=Lo(t,a);this.events.emit("payload",u)}parseError(t,r=this.url){return Jp(t,r,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Jf&&this.events.setMaxListeners(Jf)}};const Qf="error",mS="wss://relay.walletconnect.com",vS="wc",wS="universal_provider",Yf=`${vS}@2:${wS}:`,bS="https://rpc.walletconnect.com/v1/",Hr={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Jn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},su={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(s,t){(function(){var r,n="4.17.21",a=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",h="Expected a function",p="Invalid `variable` option passed into `_.template`",d="__lodash_hash_undefined__",y=500,v="__lodash_placeholder__",_=1,I=2,$=4,R=1,C=2,V=1,ee=2,ie=4,B=8,J=16,re=32,T=64,U=128,H=256,Q=512,ue=30,be="...",de=800,Ue=16,te=1,E=2,A=3,z=1/0,M=9007199254740991,Y=17976931348623157e292,L=NaN,se=4294967295,xe=se-1,we=se>>>1,he=[["ary",U],["bind",V],["bindKey",ee],["curry",B],["curryRight",J],["flip",Q],["partial",re],["partialRight",T],["rearg",H]],Z="[object Arguments]",Se="[object Array]",Ct="[object AsyncFunction]",Fe="[object Boolean]",He="[object Date]",Tt="[object DOMException]",dt="[object Error]",Nt="[object Function]",kr="[object GeneratorFunction]",nt="[object Map]",br="[object Number]",gn="[object Null]",Dt="[object Object]",Ci="[object Promise]",Ti="[object Proxy]",hr="[object RegExp]",st="[object Set]",lr="[object String]",_r="[object Symbol]",Ni="[object Undefined]",fr="[object WeakMap]",Di="[object WeakSet]",Ut="[object ArrayBuffer]",Mt="[object DataView]",Vr="[object Float32Array]",ut="[object Float64Array]",Fi="[object Int8Array]",qi="[object Int16Array]",yn="[object Int32Array]",ji="[object Uint8Array]",Kr="[object Uint8ClampedArray]",Bi="[object Uint16Array]",zi="[object Uint32Array]",ko=/\b__p \+= '';/g,Er=/\b(__p \+=) '' \+/g,hs=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ls=/&(?:amp|lt|gt|quot|#39);/g,fs=/[&<>"']/g,mn=RegExp(ls.source),hi=RegExp(fs.source),vn=/<%-([\s\S]+?)%>/g,wn=/<%([\s\S]+?)%>/g,Li=/<%=([\s\S]+?)%>/g,li=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Vo=/^\w*$/,Ko=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,bn=/[\\^$.*+?()[\]{}|]/g,Go=RegExp(bn.source),_n=/^\s+/,ps=/\s/,En=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,Ir=/\{\n\/\* \[wrapped with (.+)\] \*/,Wo=/,? & /,Jo=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Qo=/[()=,{}\[\]\/\s]/,Yo=/\\(\\)?/g,Zo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ht=/\w*$/,Xo=/^[-+]0x[0-9a-f]+$/i,ea=/^0b[01]+$/i,ta=/^\[object .+?Constructor\]$/,ra=/^0o[0-7]+$/i,ia=/^(?:0|[1-9]\d*)$/,Pr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Ui=/($^)/,na=/['\n\r\u2028\u2029\\]/g,Mi="\\ud800-\\udfff",sa="\\u0300-\\u036f",oa="\\ufe20-\\ufe2f",Hi="\\u20d0-\\u20ff",ds=sa+oa+Hi,gs="\\u2700-\\u27bf",er="a-z\\xdf-\\xf6\\xf8-\\xff",aa="\\xac\\xb1\\xd7\\xf7",ca="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",ua="\\u2000-\\u206f",ha=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ys="A-Z\\xc0-\\xd6\\xd8-\\xde",ms="\\ufe0e\\ufe0f",fi=aa+ca+ua+ha,In="[']",pi="["+Mi+"]",Pn="["+fi+"]",di="["+ds+"]",vs="\\d+",la="["+gs+"]",ws="["+er+"]",bs="[^"+Mi+fi+vs+gs+er+ys+"]",ki="\\ud83c[\\udffb-\\udfff]",fa="(?:"+di+"|"+ki+")",_s="[^"+Mi+"]",Vi="(?:\\ud83c[\\udde6-\\uddff]){2}",Gr="[\\ud800-\\udbff][\\udc00-\\udfff]",Ft="["+ys+"]",Es="\\u200d",Is="(?:"+ws+"|"+bs+")",pr="(?:"+Ft+"|"+bs+")",Ps="(?:"+In+"(?:d|ll|m|re|s|t|ve))?",xs="(?:"+In+"(?:D|LL|M|RE|S|T|VE))?",Ss=fa+"?",As="["+ms+"]?",pa="(?:"+Es+"(?:"+[_s,Vi,Gr].join("|")+")"+As+Ss+")*",xr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Rs="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Os=As+Ss+pa,Ki="(?:"+[la,Vi,Gr].join("|")+")"+Os,da="(?:"+[_s+di+"?",di,Vi,Gr,pi].join("|")+")",xn=RegExp(In,"g"),ga=RegExp(di,"g"),Gi=RegExp(ki+"(?="+ki+")|"+da+Os,"g"),$s=RegExp([Ft+"?"+ws+"+"+Ps+"(?="+[Pn,Ft,"$"].join("|")+")",pr+"+"+xs+"(?="+[Pn,Ft+Is,"$"].join("|")+")",Ft+"?"+Is+"+"+Ps,Ft+"+"+xs,Rs,xr,vs,Ki].join("|"),"g"),Cs=RegExp("["+Es+Mi+ds+ms+"]"),gi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,Ts=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ya=-1,Ce={};Ce[Vr]=Ce[ut]=Ce[Fi]=Ce[qi]=Ce[yn]=Ce[ji]=Ce[Kr]=Ce[Bi]=Ce[zi]=!0,Ce[Z]=Ce[Se]=Ce[Ut]=Ce[Fe]=Ce[Mt]=Ce[He]=Ce[dt]=Ce[Nt]=Ce[nt]=Ce[br]=Ce[Dt]=Ce[hr]=Ce[st]=Ce[lr]=Ce[fr]=!1;var $e={};$e[Z]=$e[Se]=$e[Ut]=$e[Mt]=$e[Fe]=$e[He]=$e[Vr]=$e[ut]=$e[Fi]=$e[qi]=$e[yn]=$e[nt]=$e[br]=$e[Dt]=$e[hr]=$e[st]=$e[lr]=$e[_r]=$e[ji]=$e[Kr]=$e[Bi]=$e[zi]=!0,$e[dt]=$e[Nt]=$e[fr]=!1;var m={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},P={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},q={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},K={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Te=parseFloat,fe=parseInt,qe=typeof Jn=="object"&&Jn&&Jn.Object===Object&&Jn,We=typeof self=="object"&&self&&self.Object===Object&&self,Ie=qe||We||Function("return this")(),Ne=t&&!t.nodeType&&t,ke=Ne&&!0&&s&&!s.nodeType&&s,wt=ke&&ke.exports===Ne,Je=wt&&qe.process,je=function(){try{var x=ke&&ke.require&&ke.require("util").types;return x||Je&&Je.binding&&Je.binding("util")}catch{}}(),gt=je&&je.isArrayBuffer,tr=je&&je.isDate,kt=je&&je.isMap,dr=je&&je.isRegExp,Sn=je&&je.isSet,yi=je&&je.isTypedArray;function et(x,N,O){switch(O.length){case 0:return x.call(N);case 1:return x.call(N,O[0]);case 2:return x.call(N,O[0],O[1]);case 3:return x.call(N,O[0],O[1],O[2])}return x.apply(N,O)}function bd(x,N,O,W){for(var le=-1,Ae=x==null?0:x.length;++le<Ae;){var Ye=x[le];N(W,Ye,O(Ye),x)}return W}function Vt(x,N){for(var O=-1,W=x==null?0:x.length;++O<W&&N(x[O],O,x)!==!1;);return x}function _d(x,N){for(var O=x==null?0:x.length;O--&&N(x[O],O,x)!==!1;);return x}function Su(x,N){for(var O=-1,W=x==null?0:x.length;++O<W;)if(!N(x[O],O,x))return!1;return!0}function Wr(x,N){for(var O=-1,W=x==null?0:x.length,le=0,Ae=[];++O<W;){var Ye=x[O];N(Ye,O,x)&&(Ae[le++]=Ye)}return Ae}function Ns(x,N){var O=x==null?0:x.length;return!!O&&Wi(x,N,0)>-1}function ma(x,N,O){for(var W=-1,le=x==null?0:x.length;++W<le;)if(O(N,x[W]))return!0;return!1}function Be(x,N){for(var O=-1,W=x==null?0:x.length,le=Array(W);++O<W;)le[O]=N(x[O],O,x);return le}function Jr(x,N){for(var O=-1,W=N.length,le=x.length;++O<W;)x[le+O]=N[O];return x}function va(x,N,O,W){var le=-1,Ae=x==null?0:x.length;for(W&&Ae&&(O=x[++le]);++le<Ae;)O=N(O,x[le],le,x);return O}function Ed(x,N,O,W){var le=x==null?0:x.length;for(W&&le&&(O=x[--le]);le--;)O=N(O,x[le],le,x);return O}function wa(x,N){for(var O=-1,W=x==null?0:x.length;++O<W;)if(N(x[O],O,x))return!0;return!1}var Id=ba("length");function Pd(x){return x.split("")}function xd(x){return x.match(Jo)||[]}function Au(x,N,O){var W;return O(x,function(le,Ae,Ye){if(N(le,Ae,Ye))return W=Ae,!1}),W}function Ds(x,N,O,W){for(var le=x.length,Ae=O+(W?1:-1);W?Ae--:++Ae<le;)if(N(x[Ae],Ae,x))return Ae;return-1}function Wi(x,N,O){return N===N?jd(x,N,O):Ds(x,Ru,O)}function Sd(x,N,O,W){for(var le=O-1,Ae=x.length;++le<Ae;)if(W(x[le],N))return le;return-1}function Ru(x){return x!==x}function Ou(x,N){var O=x==null?0:x.length;return O?Ea(x,N)/O:L}function ba(x){return function(N){return N==null?r:N[x]}}function _a(x){return function(N){return x==null?r:x[N]}}function $u(x,N,O,W,le){return le(x,function(Ae,Ye,De){O=W?(W=!1,Ae):N(O,Ae,Ye,De)}),O}function Ad(x,N){var O=x.length;for(x.sort(N);O--;)x[O]=x[O].value;return x}function Ea(x,N){for(var O,W=-1,le=x.length;++W<le;){var Ae=N(x[W]);Ae!==r&&(O=O===r?Ae:O+Ae)}return O}function Ia(x,N){for(var O=-1,W=Array(x);++O<x;)W[O]=N(O);return W}function Rd(x,N){return Be(N,function(O){return[O,x[O]]})}function Cu(x){return x&&x.slice(0,Fu(x)+1).replace(_n,"")}function qt(x){return function(N){return x(N)}}function Pa(x,N){return Be(N,function(O){return x[O]})}function An(x,N){return x.has(N)}function Tu(x,N){for(var O=-1,W=x.length;++O<W&&Wi(N,x[O],0)>-1;);return O}function Nu(x,N){for(var O=x.length;O--&&Wi(N,x[O],0)>-1;);return O}function Od(x,N){for(var O=x.length,W=0;O--;)x[O]===N&&++W;return W}var $d=_a(m),Cd=_a(P);function Td(x){return"\\"+K[x]}function Nd(x,N){return x==null?r:x[N]}function Ji(x){return Cs.test(x)}function Dd(x){return gi.test(x)}function Fd(x){for(var N,O=[];!(N=x.next()).done;)O.push(N.value);return O}function xa(x){var N=-1,O=Array(x.size);return x.forEach(function(W,le){O[++N]=[le,W]}),O}function Du(x,N){return function(O){return x(N(O))}}function Qr(x,N){for(var O=-1,W=x.length,le=0,Ae=[];++O<W;){var Ye=x[O];(Ye===N||Ye===v)&&(x[O]=v,Ae[le++]=O)}return Ae}function Fs(x){var N=-1,O=Array(x.size);return x.forEach(function(W){O[++N]=W}),O}function qd(x){var N=-1,O=Array(x.size);return x.forEach(function(W){O[++N]=[W,W]}),O}function jd(x,N,O){for(var W=O-1,le=x.length;++W<le;)if(x[W]===N)return W;return-1}function Bd(x,N,O){for(var W=O+1;W--;)if(x[W]===N)return W;return W}function Qi(x){return Ji(x)?Ld(x):Id(x)}function rr(x){return Ji(x)?Ud(x):Pd(x)}function Fu(x){for(var N=x.length;N--&&ps.test(x.charAt(N)););return N}var zd=_a(q);function Ld(x){for(var N=Gi.lastIndex=0;Gi.test(x);)++N;return N}function Ud(x){return x.match(Gi)||[]}function Md(x){return x.match($s)||[]}var Hd=function x(N){N=N==null?Ie:Yi.defaults(Ie.Object(),N,Yi.pick(Ie,Ts));var O=N.Array,W=N.Date,le=N.Error,Ae=N.Function,Ye=N.Math,De=N.Object,Sa=N.RegExp,kd=N.String,Kt=N.TypeError,qs=O.prototype,Vd=Ae.prototype,Zi=De.prototype,js=N["__core-js_shared__"],Bs=Vd.toString,Oe=Zi.hasOwnProperty,Kd=0,qu=function(){var e=/[^.]+$/.exec(js&&js.keys&&js.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),zs=Zi.toString,Gd=Bs.call(De),Wd=Ie._,Jd=Sa("^"+Bs.call(Oe).replace(bn,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ls=wt?N.Buffer:r,Yr=N.Symbol,Us=N.Uint8Array,ju=Ls?Ls.allocUnsafe:r,Ms=Du(De.getPrototypeOf,De),Bu=De.create,zu=Zi.propertyIsEnumerable,Hs=qs.splice,Lu=Yr?Yr.isConcatSpreadable:r,Rn=Yr?Yr.iterator:r,mi=Yr?Yr.toStringTag:r,ks=function(){try{var e=Ei(De,"defineProperty");return e({},"",{}),e}catch{}}(),Qd=N.clearTimeout!==Ie.clearTimeout&&N.clearTimeout,Yd=W&&W.now!==Ie.Date.now&&W.now,Zd=N.setTimeout!==Ie.setTimeout&&N.setTimeout,Vs=Ye.ceil,Ks=Ye.floor,Aa=De.getOwnPropertySymbols,Xd=Ls?Ls.isBuffer:r,Uu=N.isFinite,eg=qs.join,tg=Du(De.keys,De),Ze=Ye.max,ht=Ye.min,rg=W.now,ig=N.parseInt,Mu=Ye.random,ng=qs.reverse,Ra=Ei(N,"DataView"),On=Ei(N,"Map"),Oa=Ei(N,"Promise"),Xi=Ei(N,"Set"),$n=Ei(N,"WeakMap"),Cn=Ei(De,"create"),Gs=$n&&new $n,en={},sg=Ii(Ra),og=Ii(On),ag=Ii(Oa),cg=Ii(Xi),ug=Ii($n),Ws=Yr?Yr.prototype:r,Tn=Ws?Ws.valueOf:r,Hu=Ws?Ws.toString:r;function f(e){if(Me(e)&&!pe(e)&&!(e instanceof Ee)){if(e instanceof Gt)return e;if(Oe.call(e,"__wrapped__"))return kh(e)}return new Gt(e)}var tn=function(){function e(){}return function(i){if(!Le(i))return{};if(Bu)return Bu(i);e.prototype=i;var o=new e;return e.prototype=r,o}}();function Js(){}function Gt(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}f.templateSettings={escape:vn,evaluate:wn,interpolate:Li,variable:"",imports:{_:f}},f.prototype=Js.prototype,f.prototype.constructor=f,Gt.prototype=tn(Js.prototype),Gt.prototype.constructor=Gt;function Ee(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=se,this.__views__=[]}function hg(){var e=new Ee(this.__wrapped__);return e.__actions__=bt(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=bt(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=bt(this.__views__),e}function lg(){if(this.__filtered__){var e=new Ee(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function fg(){var e=this.__wrapped__.value(),i=this.__dir__,o=pe(e),c=i<0,l=o?e.length:0,g=Py(0,l,this.__views__),w=g.start,b=g.end,S=b-w,D=c?b:w-1,F=this.__iteratees__,j=F.length,k=0,X=ht(S,this.__takeCount__);if(!o||!c&&l==S&&X==S)return ph(e,this.__actions__);var oe=[];e:for(;S--&&k<X;){D+=i;for(var ye=-1,ae=e[D];++ye<j;){var _e=F[ye],Pe=_e.iteratee,zt=_e.type,vt=Pe(ae);if(zt==E)ae=vt;else if(!vt){if(zt==te)continue e;break e}}oe[k++]=ae}return oe}Ee.prototype=tn(Js.prototype),Ee.prototype.constructor=Ee;function vi(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function pg(){this.__data__=Cn?Cn(null):{},this.size=0}function dg(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function gg(e){var i=this.__data__;if(Cn){var o=i[e];return o===d?r:o}return Oe.call(i,e)?i[e]:r}function yg(e){var i=this.__data__;return Cn?i[e]!==r:Oe.call(i,e)}function mg(e,i){var o=this.__data__;return this.size+=this.has(e)?0:1,o[e]=Cn&&i===r?d:i,this}vi.prototype.clear=pg,vi.prototype.delete=dg,vi.prototype.get=gg,vi.prototype.has=yg,vi.prototype.set=mg;function Sr(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function vg(){this.__data__=[],this.size=0}function wg(e){var i=this.__data__,o=Qs(i,e);if(o<0)return!1;var c=i.length-1;return o==c?i.pop():Hs.call(i,o,1),--this.size,!0}function bg(e){var i=this.__data__,o=Qs(i,e);return o<0?r:i[o][1]}function _g(e){return Qs(this.__data__,e)>-1}function Eg(e,i){var o=this.__data__,c=Qs(o,e);return c<0?(++this.size,o.push([e,i])):o[c][1]=i,this}Sr.prototype.clear=vg,Sr.prototype.delete=wg,Sr.prototype.get=bg,Sr.prototype.has=_g,Sr.prototype.set=Eg;function Ar(e){var i=-1,o=e==null?0:e.length;for(this.clear();++i<o;){var c=e[i];this.set(c[0],c[1])}}function Ig(){this.size=0,this.__data__={hash:new vi,map:new(On||Sr),string:new vi}}function Pg(e){var i=co(this,e).delete(e);return this.size-=i?1:0,i}function xg(e){return co(this,e).get(e)}function Sg(e){return co(this,e).has(e)}function Ag(e,i){var o=co(this,e),c=o.size;return o.set(e,i),this.size+=o.size==c?0:1,this}Ar.prototype.clear=Ig,Ar.prototype.delete=Pg,Ar.prototype.get=xg,Ar.prototype.has=Sg,Ar.prototype.set=Ag;function wi(e){var i=-1,o=e==null?0:e.length;for(this.__data__=new Ar;++i<o;)this.add(e[i])}function Rg(e){return this.__data__.set(e,d),this}function Og(e){return this.__data__.has(e)}wi.prototype.add=wi.prototype.push=Rg,wi.prototype.has=Og;function ir(e){var i=this.__data__=new Sr(e);this.size=i.size}function $g(){this.__data__=new Sr,this.size=0}function Cg(e){var i=this.__data__,o=i.delete(e);return this.size=i.size,o}function Tg(e){return this.__data__.get(e)}function Ng(e){return this.__data__.has(e)}function Dg(e,i){var o=this.__data__;if(o instanceof Sr){var c=o.__data__;if(!On||c.length<a-1)return c.push([e,i]),this.size=++o.size,this;o=this.__data__=new Ar(c)}return o.set(e,i),this.size=o.size,this}ir.prototype.clear=$g,ir.prototype.delete=Cg,ir.prototype.get=Tg,ir.prototype.has=Ng,ir.prototype.set=Dg;function ku(e,i){var o=pe(e),c=!o&&Pi(e),l=!o&&!c&&ri(e),g=!o&&!c&&!l&&on(e),w=o||c||l||g,b=w?Ia(e.length,kd):[],S=b.length;for(var D in e)(i||Oe.call(e,D))&&!(w&&(D=="length"||l&&(D=="offset"||D=="parent")||g&&(D=="buffer"||D=="byteLength"||D=="byteOffset")||Cr(D,S)))&&b.push(D);return b}function Vu(e){var i=e.length;return i?e[La(0,i-1)]:r}function Fg(e,i){return uo(bt(e),bi(i,0,e.length))}function qg(e){return uo(bt(e))}function $a(e,i,o){(o!==r&&!nr(e[i],o)||o===r&&!(i in e))&&Rr(e,i,o)}function Nn(e,i,o){var c=e[i];(!(Oe.call(e,i)&&nr(c,o))||o===r&&!(i in e))&&Rr(e,i,o)}function Qs(e,i){for(var o=e.length;o--;)if(nr(e[o][0],i))return o;return-1}function jg(e,i,o,c){return Zr(e,function(l,g,w){i(c,l,o(l),w)}),c}function Ku(e,i){return e&&yr(i,tt(i),e)}function Bg(e,i){return e&&yr(i,Et(i),e)}function Rr(e,i,o){i=="__proto__"&&ks?ks(e,i,{configurable:!0,enumerable:!0,value:o,writable:!0}):e[i]=o}function Ca(e,i){for(var o=-1,c=i.length,l=O(c),g=e==null;++o<c;)l[o]=g?r:lc(e,i[o]);return l}function bi(e,i,o){return e===e&&(o!==r&&(e=e<=o?e:o),i!==r&&(e=e>=i?e:i)),e}function Wt(e,i,o,c,l,g){var w,b=i&_,S=i&I,D=i&$;if(o&&(w=l?o(e,c,l,g):o(e)),w!==r)return w;if(!Le(e))return e;var F=pe(e);if(F){if(w=Sy(e),!b)return bt(e,w)}else{var j=lt(e),k=j==Nt||j==kr;if(ri(e))return yh(e,b);if(j==Dt||j==Z||k&&!l){if(w=S||k?{}:Fh(e),!b)return S?gy(e,Bg(w,e)):dy(e,Ku(w,e))}else{if(!$e[j])return l?e:{};w=Ay(e,j,b)}}g||(g=new ir);var X=g.get(e);if(X)return X;g.set(e,w),hl(e)?e.forEach(function(ae){w.add(Wt(ae,i,o,ae,e,g))}):cl(e)&&e.forEach(function(ae,_e){w.set(_e,Wt(ae,i,o,_e,e,g))});var oe=D?S?Ya:Qa:S?Et:tt,ye=F?r:oe(e);return Vt(ye||e,function(ae,_e){ye&&(_e=ae,ae=e[_e]),Nn(w,_e,Wt(ae,i,o,_e,e,g))}),w}function zg(e){var i=tt(e);return function(o){return Gu(o,e,i)}}function Gu(e,i,o){var c=o.length;if(e==null)return!c;for(e=De(e);c--;){var l=o[c],g=i[l],w=e[l];if(w===r&&!(l in e)||!g(w))return!1}return!0}function Wu(e,i,o){if(typeof e!="function")throw new Kt(h);return Ln(function(){e.apply(r,o)},i)}function Dn(e,i,o,c){var l=-1,g=Ns,w=!0,b=e.length,S=[],D=i.length;if(!b)return S;o&&(i=Be(i,qt(o))),c?(g=ma,w=!1):i.length>=a&&(g=An,w=!1,i=new wi(i));e:for(;++l<b;){var F=e[l],j=o==null?F:o(F);if(F=c||F!==0?F:0,w&&j===j){for(var k=D;k--;)if(i[k]===j)continue e;S.push(F)}else g(i,j,c)||S.push(F)}return S}var Zr=_h(gr),Ju=_h(Na,!0);function Lg(e,i){var o=!0;return Zr(e,function(c,l,g){return o=!!i(c,l,g),o}),o}function Ys(e,i,o){for(var c=-1,l=e.length;++c<l;){var g=e[c],w=i(g);if(w!=null&&(b===r?w===w&&!Bt(w):o(w,b)))var b=w,S=g}return S}function Ug(e,i,o,c){var l=e.length;for(o=ge(o),o<0&&(o=-o>l?0:l+o),c=c===r||c>l?l:ge(c),c<0&&(c+=l),c=o>c?0:fl(c);o<c;)e[o++]=i;return e}function Qu(e,i){var o=[];return Zr(e,function(c,l,g){i(c,l,g)&&o.push(c)}),o}function ot(e,i,o,c,l){var g=-1,w=e.length;for(o||(o=Oy),l||(l=[]);++g<w;){var b=e[g];i>0&&o(b)?i>1?ot(b,i-1,o,c,l):Jr(l,b):c||(l[l.length]=b)}return l}var Ta=Eh(),Yu=Eh(!0);function gr(e,i){return e&&Ta(e,i,tt)}function Na(e,i){return e&&Yu(e,i,tt)}function Zs(e,i){return Wr(i,function(o){return Tr(e[o])})}function _i(e,i){i=ei(i,e);for(var o=0,c=i.length;e!=null&&o<c;)e=e[mr(i[o++])];return o&&o==c?e:r}function Zu(e,i,o){var c=i(e);return pe(e)?c:Jr(c,o(e))}function yt(e){return e==null?e===r?Ni:gn:mi&&mi in De(e)?Iy(e):qy(e)}function Da(e,i){return e>i}function Mg(e,i){return e!=null&&Oe.call(e,i)}function Hg(e,i){return e!=null&&i in De(e)}function kg(e,i,o){return e>=ht(i,o)&&e<Ze(i,o)}function Fa(e,i,o){for(var c=o?ma:Ns,l=e[0].length,g=e.length,w=g,b=O(g),S=1/0,D=[];w--;){var F=e[w];w&&i&&(F=Be(F,qt(i))),S=ht(F.length,S),b[w]=!o&&(i||l>=120&&F.length>=120)?new wi(w&&F):r}F=e[0];var j=-1,k=b[0];e:for(;++j<l&&D.length<S;){var X=F[j],oe=i?i(X):X;if(X=o||X!==0?X:0,!(k?An(k,oe):c(D,oe,o))){for(w=g;--w;){var ye=b[w];if(!(ye?An(ye,oe):c(e[w],oe,o)))continue e}k&&k.push(oe),D.push(X)}}return D}function Vg(e,i,o,c){return gr(e,function(l,g,w){i(c,o(l),g,w)}),c}function Fn(e,i,o){i=ei(i,e),e=zh(e,i);var c=e==null?e:e[mr(Qt(i))];return c==null?r:et(c,e,o)}function Xu(e){return Me(e)&&yt(e)==Z}function Kg(e){return Me(e)&&yt(e)==Ut}function Gg(e){return Me(e)&&yt(e)==He}function qn(e,i,o,c,l){return e===i?!0:e==null||i==null||!Me(e)&&!Me(i)?e!==e&&i!==i:Wg(e,i,o,c,qn,l)}function Wg(e,i,o,c,l,g){var w=pe(e),b=pe(i),S=w?Se:lt(e),D=b?Se:lt(i);S=S==Z?Dt:S,D=D==Z?Dt:D;var F=S==Dt,j=D==Dt,k=S==D;if(k&&ri(e)){if(!ri(i))return!1;w=!0,F=!1}if(k&&!F)return g||(g=new ir),w||on(e)?Th(e,i,o,c,l,g):_y(e,i,S,o,c,l,g);if(!(o&R)){var X=F&&Oe.call(e,"__wrapped__"),oe=j&&Oe.call(i,"__wrapped__");if(X||oe){var ye=X?e.value():e,ae=oe?i.value():i;return g||(g=new ir),l(ye,ae,o,c,g)}}return k?(g||(g=new ir),Ey(e,i,o,c,l,g)):!1}function Jg(e){return Me(e)&&lt(e)==nt}function qa(e,i,o,c){var l=o.length,g=l,w=!c;if(e==null)return!g;for(e=De(e);l--;){var b=o[l];if(w&&b[2]?b[1]!==e[b[0]]:!(b[0]in e))return!1}for(;++l<g;){b=o[l];var S=b[0],D=e[S],F=b[1];if(w&&b[2]){if(D===r&&!(S in e))return!1}else{var j=new ir;if(c)var k=c(D,F,S,e,i,j);if(!(k===r?qn(F,D,R|C,c,j):k))return!1}}return!0}function eh(e){if(!Le(e)||Cy(e))return!1;var i=Tr(e)?Jd:ta;return i.test(Ii(e))}function Qg(e){return Me(e)&&yt(e)==hr}function Yg(e){return Me(e)&&lt(e)==st}function Zg(e){return Me(e)&&yo(e.length)&&!!Ce[yt(e)]}function th(e){return typeof e=="function"?e:e==null?It:typeof e=="object"?pe(e)?nh(e[0],e[1]):ih(e):Il(e)}function ja(e){if(!zn(e))return tg(e);var i=[];for(var o in De(e))Oe.call(e,o)&&o!="constructor"&&i.push(o);return i}function Xg(e){if(!Le(e))return Fy(e);var i=zn(e),o=[];for(var c in e)c=="constructor"&&(i||!Oe.call(e,c))||o.push(c);return o}function Ba(e,i){return e<i}function rh(e,i){var o=-1,c=_t(e)?O(e.length):[];return Zr(e,function(l,g,w){c[++o]=i(l,g,w)}),c}function ih(e){var i=Xa(e);return i.length==1&&i[0][2]?jh(i[0][0],i[0][1]):function(o){return o===e||qa(o,e,i)}}function nh(e,i){return tc(e)&&qh(i)?jh(mr(e),i):function(o){var c=lc(o,e);return c===r&&c===i?fc(o,e):qn(i,c,R|C)}}function Xs(e,i,o,c,l){e!==i&&Ta(i,function(g,w){if(l||(l=new ir),Le(g))ey(e,i,w,o,Xs,c,l);else{var b=c?c(ic(e,w),g,w+"",e,i,l):r;b===r&&(b=g),$a(e,w,b)}},Et)}function ey(e,i,o,c,l,g,w){var b=ic(e,o),S=ic(i,o),D=w.get(S);if(D){$a(e,o,D);return}var F=g?g(b,S,o+"",e,i,w):r,j=F===r;if(j){var k=pe(S),X=!k&&ri(S),oe=!k&&!X&&on(S);F=S,k||X||oe?pe(b)?F=b:Ve(b)?F=bt(b):X?(j=!1,F=yh(S,!0)):oe?(j=!1,F=mh(S,!0)):F=[]:Un(S)||Pi(S)?(F=b,Pi(b)?F=pl(b):(!Le(b)||Tr(b))&&(F=Fh(S))):j=!1}j&&(w.set(S,F),l(F,S,c,g,w),w.delete(S)),$a(e,o,F)}function sh(e,i){var o=e.length;if(o)return i+=i<0?o:0,Cr(i,o)?e[i]:r}function oh(e,i,o){i.length?i=Be(i,function(g){return pe(g)?function(w){return _i(w,g.length===1?g[0]:g)}:g}):i=[It];var c=-1;i=Be(i,qt(ne()));var l=rh(e,function(g,w,b){var S=Be(i,function(D){return D(g)});return{criteria:S,index:++c,value:g}});return Ad(l,function(g,w){return py(g,w,o)})}function ty(e,i){return ah(e,i,function(o,c){return fc(e,c)})}function ah(e,i,o){for(var c=-1,l=i.length,g={};++c<l;){var w=i[c],b=_i(e,w);o(b,w)&&jn(g,ei(w,e),b)}return g}function ry(e){return function(i){return _i(i,e)}}function za(e,i,o,c){var l=c?Sd:Wi,g=-1,w=i.length,b=e;for(e===i&&(i=bt(i)),o&&(b=Be(e,qt(o)));++g<w;)for(var S=0,D=i[g],F=o?o(D):D;(S=l(b,F,S,c))>-1;)b!==e&&Hs.call(b,S,1),Hs.call(e,S,1);return e}function ch(e,i){for(var o=e?i.length:0,c=o-1;o--;){var l=i[o];if(o==c||l!==g){var g=l;Cr(l)?Hs.call(e,l,1):Ha(e,l)}}return e}function La(e,i){return e+Ks(Mu()*(i-e+1))}function iy(e,i,o,c){for(var l=-1,g=Ze(Vs((i-e)/(o||1)),0),w=O(g);g--;)w[c?g:++l]=e,e+=o;return w}function Ua(e,i){var o="";if(!e||i<1||i>M)return o;do i%2&&(o+=e),i=Ks(i/2),i&&(e+=e);while(i);return o}function ve(e,i){return nc(Bh(e,i,It),e+"")}function ny(e){return Vu(an(e))}function sy(e,i){var o=an(e);return uo(o,bi(i,0,o.length))}function jn(e,i,o,c){if(!Le(e))return e;i=ei(i,e);for(var l=-1,g=i.length,w=g-1,b=e;b!=null&&++l<g;){var S=mr(i[l]),D=o;if(S==="__proto__"||S==="constructor"||S==="prototype")return e;if(l!=w){var F=b[S];D=c?c(F,S,b):r,D===r&&(D=Le(F)?F:Cr(i[l+1])?[]:{})}Nn(b,S,D),b=b[S]}return e}var uh=Gs?function(e,i){return Gs.set(e,i),e}:It,oy=ks?function(e,i){return ks(e,"toString",{configurable:!0,enumerable:!1,value:dc(i),writable:!0})}:It;function ay(e){return uo(an(e))}function Jt(e,i,o){var c=-1,l=e.length;i<0&&(i=-i>l?0:l+i),o=o>l?l:o,o<0&&(o+=l),l=i>o?0:o-i>>>0,i>>>=0;for(var g=O(l);++c<l;)g[c]=e[c+i];return g}function cy(e,i){var o;return Zr(e,function(c,l,g){return o=i(c,l,g),!o}),!!o}function eo(e,i,o){var c=0,l=e==null?c:e.length;if(typeof i=="number"&&i===i&&l<=we){for(;c<l;){var g=c+l>>>1,w=e[g];w!==null&&!Bt(w)&&(o?w<=i:w<i)?c=g+1:l=g}return l}return Ma(e,i,It,o)}function Ma(e,i,o,c){var l=0,g=e==null?0:e.length;if(g===0)return 0;i=o(i);for(var w=i!==i,b=i===null,S=Bt(i),D=i===r;l<g;){var F=Ks((l+g)/2),j=o(e[F]),k=j!==r,X=j===null,oe=j===j,ye=Bt(j);if(w)var ae=c||oe;else D?ae=oe&&(c||k):b?ae=oe&&k&&(c||!X):S?ae=oe&&k&&!X&&(c||!ye):X||ye?ae=!1:ae=c?j<=i:j<i;ae?l=F+1:g=F}return ht(g,xe)}function hh(e,i){for(var o=-1,c=e.length,l=0,g=[];++o<c;){var w=e[o],b=i?i(w):w;if(!o||!nr(b,S)){var S=b;g[l++]=w===0?0:w}}return g}function lh(e){return typeof e=="number"?e:Bt(e)?L:+e}function jt(e){if(typeof e=="string")return e;if(pe(e))return Be(e,jt)+"";if(Bt(e))return Hu?Hu.call(e):"";var i=e+"";return i=="0"&&1/e==-1/0?"-0":i}function Xr(e,i,o){var c=-1,l=Ns,g=e.length,w=!0,b=[],S=b;if(o)w=!1,l=ma;else if(g>=a){var D=i?null:wy(e);if(D)return Fs(D);w=!1,l=An,S=new wi}else S=i?[]:b;e:for(;++c<g;){var F=e[c],j=i?i(F):F;if(F=o||F!==0?F:0,w&&j===j){for(var k=S.length;k--;)if(S[k]===j)continue e;i&&S.push(j),b.push(F)}else l(S,j,o)||(S!==b&&S.push(j),b.push(F))}return b}function Ha(e,i){return i=ei(i,e),e=zh(e,i),e==null||delete e[mr(Qt(i))]}function fh(e,i,o,c){return jn(e,i,o(_i(e,i)),c)}function to(e,i,o,c){for(var l=e.length,g=c?l:-1;(c?g--:++g<l)&&i(e[g],g,e););return o?Jt(e,c?0:g,c?g+1:l):Jt(e,c?g+1:0,c?l:g)}function ph(e,i){var o=e;return o instanceof Ee&&(o=o.value()),va(i,function(c,l){return l.func.apply(l.thisArg,Jr([c],l.args))},o)}function ka(e,i,o){var c=e.length;if(c<2)return c?Xr(e[0]):[];for(var l=-1,g=O(c);++l<c;)for(var w=e[l],b=-1;++b<c;)b!=l&&(g[l]=Dn(g[l]||w,e[b],i,o));return Xr(ot(g,1),i,o)}function dh(e,i,o){for(var c=-1,l=e.length,g=i.length,w={};++c<l;){var b=c<g?i[c]:r;o(w,e[c],b)}return w}function Va(e){return Ve(e)?e:[]}function Ka(e){return typeof e=="function"?e:It}function ei(e,i){return pe(e)?e:tc(e,i)?[e]:Hh(Re(e))}var uy=ve;function ti(e,i,o){var c=e.length;return o=o===r?c:o,!i&&o>=c?e:Jt(e,i,o)}var gh=Qd||function(e){return Ie.clearTimeout(e)};function yh(e,i){if(i)return e.slice();var o=e.length,c=ju?ju(o):new e.constructor(o);return e.copy(c),c}function Ga(e){var i=new e.constructor(e.byteLength);return new Us(i).set(new Us(e)),i}function hy(e,i){var o=i?Ga(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.byteLength)}function ly(e){var i=new e.constructor(e.source,Ht.exec(e));return i.lastIndex=e.lastIndex,i}function fy(e){return Tn?De(Tn.call(e)):{}}function mh(e,i){var o=i?Ga(e.buffer):e.buffer;return new e.constructor(o,e.byteOffset,e.length)}function vh(e,i){if(e!==i){var o=e!==r,c=e===null,l=e===e,g=Bt(e),w=i!==r,b=i===null,S=i===i,D=Bt(i);if(!b&&!D&&!g&&e>i||g&&w&&S&&!b&&!D||c&&w&&S||!o&&S||!l)return 1;if(!c&&!g&&!D&&e<i||D&&o&&l&&!c&&!g||b&&o&&l||!w&&l||!S)return-1}return 0}function py(e,i,o){for(var c=-1,l=e.criteria,g=i.criteria,w=l.length,b=o.length;++c<w;){var S=vh(l[c],g[c]);if(S){if(c>=b)return S;var D=o[c];return S*(D=="desc"?-1:1)}}return e.index-i.index}function wh(e,i,o,c){for(var l=-1,g=e.length,w=o.length,b=-1,S=i.length,D=Ze(g-w,0),F=O(S+D),j=!c;++b<S;)F[b]=i[b];for(;++l<w;)(j||l<g)&&(F[o[l]]=e[l]);for(;D--;)F[b++]=e[l++];return F}function bh(e,i,o,c){for(var l=-1,g=e.length,w=-1,b=o.length,S=-1,D=i.length,F=Ze(g-b,0),j=O(F+D),k=!c;++l<F;)j[l]=e[l];for(var X=l;++S<D;)j[X+S]=i[S];for(;++w<b;)(k||l<g)&&(j[X+o[w]]=e[l++]);return j}function bt(e,i){var o=-1,c=e.length;for(i||(i=O(c));++o<c;)i[o]=e[o];return i}function yr(e,i,o,c){var l=!o;o||(o={});for(var g=-1,w=i.length;++g<w;){var b=i[g],S=c?c(o[b],e[b],b,o,e):r;S===r&&(S=e[b]),l?Rr(o,b,S):Nn(o,b,S)}return o}function dy(e,i){return yr(e,ec(e),i)}function gy(e,i){return yr(e,Nh(e),i)}function ro(e,i){return function(o,c){var l=pe(o)?bd:jg,g=i?i():{};return l(o,e,ne(c,2),g)}}function rn(e){return ve(function(i,o){var c=-1,l=o.length,g=l>1?o[l-1]:r,w=l>2?o[2]:r;for(g=e.length>3&&typeof g=="function"?(l--,g):r,w&&mt(o[0],o[1],w)&&(g=l<3?r:g,l=1),i=De(i);++c<l;){var b=o[c];b&&e(i,b,c,g)}return i})}function _h(e,i){return function(o,c){if(o==null)return o;if(!_t(o))return e(o,c);for(var l=o.length,g=i?l:-1,w=De(o);(i?g--:++g<l)&&c(w[g],g,w)!==!1;);return o}}function Eh(e){return function(i,o,c){for(var l=-1,g=De(i),w=c(i),b=w.length;b--;){var S=w[e?b:++l];if(o(g[S],S,g)===!1)break}return i}}function yy(e,i,o){var c=i&V,l=Bn(e);function g(){var w=this&&this!==Ie&&this instanceof g?l:e;return w.apply(c?o:this,arguments)}return g}function Ih(e){return function(i){i=Re(i);var o=Ji(i)?rr(i):r,c=o?o[0]:i.charAt(0),l=o?ti(o,1).join(""):i.slice(1);return c[e]()+l}}function nn(e){return function(i){return va(_l(bl(i).replace(xn,"")),e,"")}}function Bn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var o=tn(e.prototype),c=e.apply(o,i);return Le(c)?c:o}}function my(e,i,o){var c=Bn(e);function l(){for(var g=arguments.length,w=O(g),b=g,S=sn(l);b--;)w[b]=arguments[b];var D=g<3&&w[0]!==S&&w[g-1]!==S?[]:Qr(w,S);if(g-=D.length,g<o)return Rh(e,i,io,l.placeholder,r,w,D,r,r,o-g);var F=this&&this!==Ie&&this instanceof l?c:e;return et(F,this,w)}return l}function Ph(e){return function(i,o,c){var l=De(i);if(!_t(i)){var g=ne(o,3);i=tt(i),o=function(b){return g(l[b],b,l)}}var w=e(i,o,c);return w>-1?l[g?i[w]:w]:r}}function xh(e){return $r(function(i){var o=i.length,c=o,l=Gt.prototype.thru;for(e&&i.reverse();c--;){var g=i[c];if(typeof g!="function")throw new Kt(h);if(l&&!w&&ao(g)=="wrapper")var w=new Gt([],!0)}for(c=w?c:o;++c<o;){g=i[c];var b=ao(g),S=b=="wrapper"?Za(g):r;S&&rc(S[0])&&S[1]==(U|B|re|H)&&!S[4].length&&S[9]==1?w=w[ao(S[0])].apply(w,S[3]):w=g.length==1&&rc(g)?w[b]():w.thru(g)}return function(){var D=arguments,F=D[0];if(w&&D.length==1&&pe(F))return w.plant(F).value();for(var j=0,k=o?i[j].apply(this,D):F;++j<o;)k=i[j].call(this,k);return k}})}function io(e,i,o,c,l,g,w,b,S,D){var F=i&U,j=i&V,k=i&ee,X=i&(B|J),oe=i&Q,ye=k?r:Bn(e);function ae(){for(var _e=arguments.length,Pe=O(_e),zt=_e;zt--;)Pe[zt]=arguments[zt];if(X)var vt=sn(ae),Lt=Od(Pe,vt);if(c&&(Pe=wh(Pe,c,l,X)),g&&(Pe=bh(Pe,g,w,X)),_e-=Lt,X&&_e<D){var Ke=Qr(Pe,vt);return Rh(e,i,io,ae.placeholder,o,Pe,Ke,b,S,D-_e)}var sr=j?o:this,Dr=k?sr[e]:e;return _e=Pe.length,b?Pe=jy(Pe,b):oe&&_e>1&&Pe.reverse(),F&&S<_e&&(Pe.length=S),this&&this!==Ie&&this instanceof ae&&(Dr=ye||Bn(Dr)),Dr.apply(sr,Pe)}return ae}function Sh(e,i){return function(o,c){return Vg(o,e,i(c),{})}}function no(e,i){return function(o,c){var l;if(o===r&&c===r)return i;if(o!==r&&(l=o),c!==r){if(l===r)return c;typeof o=="string"||typeof c=="string"?(o=jt(o),c=jt(c)):(o=lh(o),c=lh(c)),l=e(o,c)}return l}}function Wa(e){return $r(function(i){return i=Be(i,qt(ne())),ve(function(o){var c=this;return e(i,function(l){return et(l,c,o)})})})}function so(e,i){i=i===r?" ":jt(i);var o=i.length;if(o<2)return o?Ua(i,e):i;var c=Ua(i,Vs(e/Qi(i)));return Ji(i)?ti(rr(c),0,e).join(""):c.slice(0,e)}function vy(e,i,o,c){var l=i&V,g=Bn(e);function w(){for(var b=-1,S=arguments.length,D=-1,F=c.length,j=O(F+S),k=this&&this!==Ie&&this instanceof w?g:e;++D<F;)j[D]=c[D];for(;S--;)j[D++]=arguments[++b];return et(k,l?o:this,j)}return w}function Ah(e){return function(i,o,c){return c&&typeof c!="number"&&mt(i,o,c)&&(o=c=r),i=Nr(i),o===r?(o=i,i=0):o=Nr(o),c=c===r?i<o?1:-1:Nr(c),iy(i,o,c,e)}}function oo(e){return function(i,o){return typeof i=="string"&&typeof o=="string"||(i=Yt(i),o=Yt(o)),e(i,o)}}function Rh(e,i,o,c,l,g,w,b,S,D){var F=i&B,j=F?w:r,k=F?r:w,X=F?g:r,oe=F?r:g;i|=F?re:T,i&=~(F?T:re),i&ie||(i&=-4);var ye=[e,i,l,X,j,oe,k,b,S,D],ae=o.apply(r,ye);return rc(e)&&Lh(ae,ye),ae.placeholder=c,Uh(ae,e,i)}function Ja(e){var i=Ye[e];return function(o,c){if(o=Yt(o),c=c==null?0:ht(ge(c),292),c&&Uu(o)){var l=(Re(o)+"e").split("e"),g=i(l[0]+"e"+(+l[1]+c));return l=(Re(g)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return i(o)}}var wy=Xi&&1/Fs(new Xi([,-0]))[1]==z?function(e){return new Xi(e)}:mc;function Oh(e){return function(i){var o=lt(i);return o==nt?xa(i):o==st?qd(i):Rd(i,e(i))}}function Or(e,i,o,c,l,g,w,b){var S=i&ee;if(!S&&typeof e!="function")throw new Kt(h);var D=c?c.length:0;if(D||(i&=-97,c=l=r),w=w===r?w:Ze(ge(w),0),b=b===r?b:ge(b),D-=l?l.length:0,i&T){var F=c,j=l;c=l=r}var k=S?r:Za(e),X=[e,i,o,c,l,F,j,g,w,b];if(k&&Dy(X,k),e=X[0],i=X[1],o=X[2],c=X[3],l=X[4],b=X[9]=X[9]===r?S?0:e.length:Ze(X[9]-D,0),!b&&i&(B|J)&&(i&=-25),!i||i==V)var oe=yy(e,i,o);else i==B||i==J?oe=my(e,i,b):(i==re||i==(V|re))&&!l.length?oe=vy(e,i,o,c):oe=io.apply(r,X);var ye=k?uh:Lh;return Uh(ye(oe,X),e,i)}function $h(e,i,o,c){return e===r||nr(e,Zi[o])&&!Oe.call(c,o)?i:e}function Ch(e,i,o,c,l,g){return Le(e)&&Le(i)&&(g.set(i,e),Xs(e,i,r,Ch,g),g.delete(i)),e}function by(e){return Un(e)?r:e}function Th(e,i,o,c,l,g){var w=o&R,b=e.length,S=i.length;if(b!=S&&!(w&&S>b))return!1;var D=g.get(e),F=g.get(i);if(D&&F)return D==i&&F==e;var j=-1,k=!0,X=o&C?new wi:r;for(g.set(e,i),g.set(i,e);++j<b;){var oe=e[j],ye=i[j];if(c)var ae=w?c(ye,oe,j,i,e,g):c(oe,ye,j,e,i,g);if(ae!==r){if(ae)continue;k=!1;break}if(X){if(!wa(i,function(_e,Pe){if(!An(X,Pe)&&(oe===_e||l(oe,_e,o,c,g)))return X.push(Pe)})){k=!1;break}}else if(!(oe===ye||l(oe,ye,o,c,g))){k=!1;break}}return g.delete(e),g.delete(i),k}function _y(e,i,o,c,l,g,w){switch(o){case Mt:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ut:return!(e.byteLength!=i.byteLength||!g(new Us(e),new Us(i)));case Fe:case He:case br:return nr(+e,+i);case dt:return e.name==i.name&&e.message==i.message;case hr:case lr:return e==i+"";case nt:var b=xa;case st:var S=c&R;if(b||(b=Fs),e.size!=i.size&&!S)return!1;var D=w.get(e);if(D)return D==i;c|=C,w.set(e,i);var F=Th(b(e),b(i),c,l,g,w);return w.delete(e),F;case _r:if(Tn)return Tn.call(e)==Tn.call(i)}return!1}function Ey(e,i,o,c,l,g){var w=o&R,b=Qa(e),S=b.length,D=Qa(i),F=D.length;if(S!=F&&!w)return!1;for(var j=S;j--;){var k=b[j];if(!(w?k in i:Oe.call(i,k)))return!1}var X=g.get(e),oe=g.get(i);if(X&&oe)return X==i&&oe==e;var ye=!0;g.set(e,i),g.set(i,e);for(var ae=w;++j<S;){k=b[j];var _e=e[k],Pe=i[k];if(c)var zt=w?c(Pe,_e,k,i,e,g):c(_e,Pe,k,e,i,g);if(!(zt===r?_e===Pe||l(_e,Pe,o,c,g):zt)){ye=!1;break}ae||(ae=k=="constructor")}if(ye&&!ae){var vt=e.constructor,Lt=i.constructor;vt!=Lt&&"constructor"in e&&"constructor"in i&&!(typeof vt=="function"&&vt instanceof vt&&typeof Lt=="function"&&Lt instanceof Lt)&&(ye=!1)}return g.delete(e),g.delete(i),ye}function $r(e){return nc(Bh(e,r,Gh),e+"")}function Qa(e){return Zu(e,tt,ec)}function Ya(e){return Zu(e,Et,Nh)}var Za=Gs?function(e){return Gs.get(e)}:mc;function ao(e){for(var i=e.name+"",o=en[i],c=Oe.call(en,i)?o.length:0;c--;){var l=o[c],g=l.func;if(g==null||g==e)return l.name}return i}function sn(e){var i=Oe.call(f,"placeholder")?f:e;return i.placeholder}function ne(){var e=f.iteratee||gc;return e=e===gc?th:e,arguments.length?e(arguments[0],arguments[1]):e}function co(e,i){var o=e.__data__;return $y(i)?o[typeof i=="string"?"string":"hash"]:o.map}function Xa(e){for(var i=tt(e),o=i.length;o--;){var c=i[o],l=e[c];i[o]=[c,l,qh(l)]}return i}function Ei(e,i){var o=Nd(e,i);return eh(o)?o:r}function Iy(e){var i=Oe.call(e,mi),o=e[mi];try{e[mi]=r;var c=!0}catch{}var l=zs.call(e);return c&&(i?e[mi]=o:delete e[mi]),l}var ec=Aa?function(e){return e==null?[]:(e=De(e),Wr(Aa(e),function(i){return zu.call(e,i)}))}:vc,Nh=Aa?function(e){for(var i=[];e;)Jr(i,ec(e)),e=Ms(e);return i}:vc,lt=yt;(Ra&&lt(new Ra(new ArrayBuffer(1)))!=Mt||On&&lt(new On)!=nt||Oa&&lt(Oa.resolve())!=Ci||Xi&&lt(new Xi)!=st||$n&&lt(new $n)!=fr)&&(lt=function(e){var i=yt(e),o=i==Dt?e.constructor:r,c=o?Ii(o):"";if(c)switch(c){case sg:return Mt;case og:return nt;case ag:return Ci;case cg:return st;case ug:return fr}return i});function Py(e,i,o){for(var c=-1,l=o.length;++c<l;){var g=o[c],w=g.size;switch(g.type){case"drop":e+=w;break;case"dropRight":i-=w;break;case"take":i=ht(i,e+w);break;case"takeRight":e=Ze(e,i-w);break}}return{start:e,end:i}}function xy(e){var i=e.match(Ir);return i?i[1].split(Wo):[]}function Dh(e,i,o){i=ei(i,e);for(var c=-1,l=i.length,g=!1;++c<l;){var w=mr(i[c]);if(!(g=e!=null&&o(e,w)))break;e=e[w]}return g||++c!=l?g:(l=e==null?0:e.length,!!l&&yo(l)&&Cr(w,l)&&(pe(e)||Pi(e)))}function Sy(e){var i=e.length,o=new e.constructor(i);return i&&typeof e[0]=="string"&&Oe.call(e,"index")&&(o.index=e.index,o.input=e.input),o}function Fh(e){return typeof e.constructor=="function"&&!zn(e)?tn(Ms(e)):{}}function Ay(e,i,o){var c=e.constructor;switch(i){case Ut:return Ga(e);case Fe:case He:return new c(+e);case Mt:return hy(e,o);case Vr:case ut:case Fi:case qi:case yn:case ji:case Kr:case Bi:case zi:return mh(e,o);case nt:return new c;case br:case lr:return new c(e);case hr:return ly(e);case st:return new c;case _r:return fy(e)}}function Ry(e,i){var o=i.length;if(!o)return e;var c=o-1;return i[c]=(o>1?"& ":"")+i[c],i=i.join(o>2?", ":" "),e.replace(En,`{
/* [wrapped with `+i+`] */
`)}function Oy(e){return pe(e)||Pi(e)||!!(Lu&&e&&e[Lu])}function Cr(e,i){var o=typeof e;return i=i??M,!!i&&(o=="number"||o!="symbol"&&ia.test(e))&&e>-1&&e%1==0&&e<i}function mt(e,i,o){if(!Le(o))return!1;var c=typeof i;return(c=="number"?_t(o)&&Cr(i,o.length):c=="string"&&i in o)?nr(o[i],e):!1}function tc(e,i){if(pe(e))return!1;var o=typeof e;return o=="number"||o=="symbol"||o=="boolean"||e==null||Bt(e)?!0:Vo.test(e)||!li.test(e)||i!=null&&e in De(i)}function $y(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function rc(e){var i=ao(e),o=f[i];if(typeof o!="function"||!(i in Ee.prototype))return!1;if(e===o)return!0;var c=Za(o);return!!c&&e===c[0]}function Cy(e){return!!qu&&qu in e}var Ty=js?Tr:wc;function zn(e){var i=e&&e.constructor,o=typeof i=="function"&&i.prototype||Zi;return e===o}function qh(e){return e===e&&!Le(e)}function jh(e,i){return function(o){return o==null?!1:o[e]===i&&(i!==r||e in De(o))}}function Ny(e){var i=po(e,function(c){return o.size===y&&o.clear(),c}),o=i.cache;return i}function Dy(e,i){var o=e[1],c=i[1],l=o|c,g=l<(V|ee|U),w=c==U&&o==B||c==U&&o==H&&e[7].length<=i[8]||c==(U|H)&&i[7].length<=i[8]&&o==B;if(!(g||w))return e;c&V&&(e[2]=i[2],l|=o&V?0:ie);var b=i[3];if(b){var S=e[3];e[3]=S?wh(S,b,i[4]):b,e[4]=S?Qr(e[3],v):i[4]}return b=i[5],b&&(S=e[5],e[5]=S?bh(S,b,i[6]):b,e[6]=S?Qr(e[5],v):i[6]),b=i[7],b&&(e[7]=b),c&U&&(e[8]=e[8]==null?i[8]:ht(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function Fy(e){var i=[];if(e!=null)for(var o in De(e))i.push(o);return i}function qy(e){return zs.call(e)}function Bh(e,i,o){return i=Ze(i===r?e.length-1:i,0),function(){for(var c=arguments,l=-1,g=Ze(c.length-i,0),w=O(g);++l<g;)w[l]=c[i+l];l=-1;for(var b=O(i+1);++l<i;)b[l]=c[l];return b[i]=o(w),et(e,this,b)}}function zh(e,i){return i.length<2?e:_i(e,Jt(i,0,-1))}function jy(e,i){for(var o=e.length,c=ht(i.length,o),l=bt(e);c--;){var g=i[c];e[c]=Cr(g,o)?l[g]:r}return e}function ic(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Lh=Mh(uh),Ln=Zd||function(e,i){return Ie.setTimeout(e,i)},nc=Mh(oy);function Uh(e,i,o){var c=i+"";return nc(e,Ry(c,By(xy(c),o)))}function Mh(e){var i=0,o=0;return function(){var c=rg(),l=Ue-(c-o);if(o=c,l>0){if(++i>=de)return arguments[0]}else i=0;return e.apply(r,arguments)}}function uo(e,i){var o=-1,c=e.length,l=c-1;for(i=i===r?c:i;++o<i;){var g=La(o,l),w=e[g];e[g]=e[o],e[o]=w}return e.length=i,e}var Hh=Ny(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Ko,function(o,c,l,g){i.push(l?g.replace(Yo,"$1"):c||o)}),i});function mr(e){if(typeof e=="string"||Bt(e))return e;var i=e+"";return i=="0"&&1/e==-1/0?"-0":i}function Ii(e){if(e!=null){try{return Bs.call(e)}catch{}try{return e+""}catch{}}return""}function By(e,i){return Vt(he,function(o){var c="_."+o[0];i&o[1]&&!Ns(e,c)&&e.push(c)}),e.sort()}function kh(e){if(e instanceof Ee)return e.clone();var i=new Gt(e.__wrapped__,e.__chain__);return i.__actions__=bt(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function zy(e,i,o){(o?mt(e,i,o):i===r)?i=1:i=Ze(ge(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var l=0,g=0,w=O(Vs(c/i));l<c;)w[g++]=Jt(e,l,l+=i);return w}function Ly(e){for(var i=-1,o=e==null?0:e.length,c=0,l=[];++i<o;){var g=e[i];g&&(l[c++]=g)}return l}function Uy(){var e=arguments.length;if(!e)return[];for(var i=O(e-1),o=arguments[0],c=e;c--;)i[c-1]=arguments[c];return Jr(pe(o)?bt(o):[o],ot(i,1))}var My=ve(function(e,i){return Ve(e)?Dn(e,ot(i,1,Ve,!0)):[]}),Hy=ve(function(e,i){var o=Qt(i);return Ve(o)&&(o=r),Ve(e)?Dn(e,ot(i,1,Ve,!0),ne(o,2)):[]}),ky=ve(function(e,i){var o=Qt(i);return Ve(o)&&(o=r),Ve(e)?Dn(e,ot(i,1,Ve,!0),r,o):[]});function Vy(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:ge(i),Jt(e,i<0?0:i,c)):[]}function Ky(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:ge(i),i=c-i,Jt(e,0,i<0?0:i)):[]}function Gy(e,i){return e&&e.length?to(e,ne(i,3),!0,!0):[]}function Wy(e,i){return e&&e.length?to(e,ne(i,3),!0):[]}function Jy(e,i,o,c){var l=e==null?0:e.length;return l?(o&&typeof o!="number"&&mt(e,i,o)&&(o=0,c=l),Ug(e,i,o,c)):[]}function Vh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:ge(o);return l<0&&(l=Ze(c+l,0)),Ds(e,ne(i,3),l)}function Kh(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return o!==r&&(l=ge(o),l=o<0?Ze(c+l,0):ht(l,c-1)),Ds(e,ne(i,3),l,!0)}function Gh(e){var i=e==null?0:e.length;return i?ot(e,1):[]}function Qy(e){var i=e==null?0:e.length;return i?ot(e,z):[]}function Yy(e,i){var o=e==null?0:e.length;return o?(i=i===r?1:ge(i),ot(e,i)):[]}function Zy(e){for(var i=-1,o=e==null?0:e.length,c={};++i<o;){var l=e[i];c[l[0]]=l[1]}return c}function Wh(e){return e&&e.length?e[0]:r}function Xy(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=o==null?0:ge(o);return l<0&&(l=Ze(c+l,0)),Wi(e,i,l)}function em(e){var i=e==null?0:e.length;return i?Jt(e,0,-1):[]}var tm=ve(function(e){var i=Be(e,Va);return i.length&&i[0]===e[0]?Fa(i):[]}),rm=ve(function(e){var i=Qt(e),o=Be(e,Va);return i===Qt(o)?i=r:o.pop(),o.length&&o[0]===e[0]?Fa(o,ne(i,2)):[]}),im=ve(function(e){var i=Qt(e),o=Be(e,Va);return i=typeof i=="function"?i:r,i&&o.pop(),o.length&&o[0]===e[0]?Fa(o,r,i):[]});function nm(e,i){return e==null?"":eg.call(e,i)}function Qt(e){var i=e==null?0:e.length;return i?e[i-1]:r}function sm(e,i,o){var c=e==null?0:e.length;if(!c)return-1;var l=c;return o!==r&&(l=ge(o),l=l<0?Ze(c+l,0):ht(l,c-1)),i===i?Bd(e,i,l):Ds(e,Ru,l,!0)}function om(e,i){return e&&e.length?sh(e,ge(i)):r}var am=ve(Jh);function Jh(e,i){return e&&e.length&&i&&i.length?za(e,i):e}function cm(e,i,o){return e&&e.length&&i&&i.length?za(e,i,ne(o,2)):e}function um(e,i,o){return e&&e.length&&i&&i.length?za(e,i,r,o):e}var hm=$r(function(e,i){var o=e==null?0:e.length,c=Ca(e,i);return ch(e,Be(i,function(l){return Cr(l,o)?+l:l}).sort(vh)),c});function lm(e,i){var o=[];if(!(e&&e.length))return o;var c=-1,l=[],g=e.length;for(i=ne(i,3);++c<g;){var w=e[c];i(w,c,e)&&(o.push(w),l.push(c))}return ch(e,l),o}function sc(e){return e==null?e:ng.call(e)}function fm(e,i,o){var c=e==null?0:e.length;return c?(o&&typeof o!="number"&&mt(e,i,o)?(i=0,o=c):(i=i==null?0:ge(i),o=o===r?c:ge(o)),Jt(e,i,o)):[]}function pm(e,i){return eo(e,i)}function dm(e,i,o){return Ma(e,i,ne(o,2))}function gm(e,i){var o=e==null?0:e.length;if(o){var c=eo(e,i);if(c<o&&nr(e[c],i))return c}return-1}function ym(e,i){return eo(e,i,!0)}function mm(e,i,o){return Ma(e,i,ne(o,2),!0)}function vm(e,i){var o=e==null?0:e.length;if(o){var c=eo(e,i,!0)-1;if(nr(e[c],i))return c}return-1}function wm(e){return e&&e.length?hh(e):[]}function bm(e,i){return e&&e.length?hh(e,ne(i,2)):[]}function _m(e){var i=e==null?0:e.length;return i?Jt(e,1,i):[]}function Em(e,i,o){return e&&e.length?(i=o||i===r?1:ge(i),Jt(e,0,i<0?0:i)):[]}function Im(e,i,o){var c=e==null?0:e.length;return c?(i=o||i===r?1:ge(i),i=c-i,Jt(e,i<0?0:i,c)):[]}function Pm(e,i){return e&&e.length?to(e,ne(i,3),!1,!0):[]}function xm(e,i){return e&&e.length?to(e,ne(i,3)):[]}var Sm=ve(function(e){return Xr(ot(e,1,Ve,!0))}),Am=ve(function(e){var i=Qt(e);return Ve(i)&&(i=r),Xr(ot(e,1,Ve,!0),ne(i,2))}),Rm=ve(function(e){var i=Qt(e);return i=typeof i=="function"?i:r,Xr(ot(e,1,Ve,!0),r,i)});function Om(e){return e&&e.length?Xr(e):[]}function $m(e,i){return e&&e.length?Xr(e,ne(i,2)):[]}function Cm(e,i){return i=typeof i=="function"?i:r,e&&e.length?Xr(e,r,i):[]}function oc(e){if(!(e&&e.length))return[];var i=0;return e=Wr(e,function(o){if(Ve(o))return i=Ze(o.length,i),!0}),Ia(i,function(o){return Be(e,ba(o))})}function Qh(e,i){if(!(e&&e.length))return[];var o=oc(e);return i==null?o:Be(o,function(c){return et(i,r,c)})}var Tm=ve(function(e,i){return Ve(e)?Dn(e,i):[]}),Nm=ve(function(e){return ka(Wr(e,Ve))}),Dm=ve(function(e){var i=Qt(e);return Ve(i)&&(i=r),ka(Wr(e,Ve),ne(i,2))}),Fm=ve(function(e){var i=Qt(e);return i=typeof i=="function"?i:r,ka(Wr(e,Ve),r,i)}),qm=ve(oc);function jm(e,i){return dh(e||[],i||[],Nn)}function Bm(e,i){return dh(e||[],i||[],jn)}var zm=ve(function(e){var i=e.length,o=i>1?e[i-1]:r;return o=typeof o=="function"?(e.pop(),o):r,Qh(e,o)});function Yh(e){var i=f(e);return i.__chain__=!0,i}function Lm(e,i){return i(e),e}function ho(e,i){return i(e)}var Um=$r(function(e){var i=e.length,o=i?e[0]:0,c=this.__wrapped__,l=function(g){return Ca(g,e)};return i>1||this.__actions__.length||!(c instanceof Ee)||!Cr(o)?this.thru(l):(c=c.slice(o,+o+(i?1:0)),c.__actions__.push({func:ho,args:[l],thisArg:r}),new Gt(c,this.__chain__).thru(function(g){return i&&!g.length&&g.push(r),g}))});function Mm(){return Yh(this)}function Hm(){return new Gt(this.value(),this.__chain__)}function km(){this.__values__===r&&(this.__values__=ll(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function Vm(){return this}function Km(e){for(var i,o=this;o instanceof Js;){var c=kh(o);c.__index__=0,c.__values__=r,i?l.__wrapped__=c:i=c;var l=c;o=o.__wrapped__}return l.__wrapped__=e,i}function Gm(){var e=this.__wrapped__;if(e instanceof Ee){var i=e;return this.__actions__.length&&(i=new Ee(this)),i=i.reverse(),i.__actions__.push({func:ho,args:[sc],thisArg:r}),new Gt(i,this.__chain__)}return this.thru(sc)}function Wm(){return ph(this.__wrapped__,this.__actions__)}var Jm=ro(function(e,i,o){Oe.call(e,o)?++e[o]:Rr(e,o,1)});function Qm(e,i,o){var c=pe(e)?Su:Lg;return o&&mt(e,i,o)&&(i=r),c(e,ne(i,3))}function Ym(e,i){var o=pe(e)?Wr:Qu;return o(e,ne(i,3))}var Zm=Ph(Vh),Xm=Ph(Kh);function ev(e,i){return ot(lo(e,i),1)}function tv(e,i){return ot(lo(e,i),z)}function rv(e,i,o){return o=o===r?1:ge(o),ot(lo(e,i),o)}function Zh(e,i){var o=pe(e)?Vt:Zr;return o(e,ne(i,3))}function Xh(e,i){var o=pe(e)?_d:Ju;return o(e,ne(i,3))}var iv=ro(function(e,i,o){Oe.call(e,o)?e[o].push(i):Rr(e,o,[i])});function nv(e,i,o,c){e=_t(e)?e:an(e),o=o&&!c?ge(o):0;var l=e.length;return o<0&&(o=Ze(l+o,0)),mo(e)?o<=l&&e.indexOf(i,o)>-1:!!l&&Wi(e,i,o)>-1}var sv=ve(function(e,i,o){var c=-1,l=typeof i=="function",g=_t(e)?O(e.length):[];return Zr(e,function(w){g[++c]=l?et(i,w,o):Fn(w,i,o)}),g}),ov=ro(function(e,i,o){Rr(e,o,i)});function lo(e,i){var o=pe(e)?Be:rh;return o(e,ne(i,3))}function av(e,i,o,c){return e==null?[]:(pe(i)||(i=i==null?[]:[i]),o=c?r:o,pe(o)||(o=o==null?[]:[o]),oh(e,i,o))}var cv=ro(function(e,i,o){e[o?0:1].push(i)},function(){return[[],[]]});function uv(e,i,o){var c=pe(e)?va:$u,l=arguments.length<3;return c(e,ne(i,4),o,l,Zr)}function hv(e,i,o){var c=pe(e)?Ed:$u,l=arguments.length<3;return c(e,ne(i,4),o,l,Ju)}function lv(e,i){var o=pe(e)?Wr:Qu;return o(e,go(ne(i,3)))}function fv(e){var i=pe(e)?Vu:ny;return i(e)}function pv(e,i,o){(o?mt(e,i,o):i===r)?i=1:i=ge(i);var c=pe(e)?Fg:sy;return c(e,i)}function dv(e){var i=pe(e)?qg:ay;return i(e)}function gv(e){if(e==null)return 0;if(_t(e))return mo(e)?Qi(e):e.length;var i=lt(e);return i==nt||i==st?e.size:ja(e).length}function yv(e,i,o){var c=pe(e)?wa:cy;return o&&mt(e,i,o)&&(i=r),c(e,ne(i,3))}var mv=ve(function(e,i){if(e==null)return[];var o=i.length;return o>1&&mt(e,i[0],i[1])?i=[]:o>2&&mt(i[0],i[1],i[2])&&(i=[i[0]]),oh(e,ot(i,1),[])}),fo=Yd||function(){return Ie.Date.now()};function vv(e,i){if(typeof i!="function")throw new Kt(h);return e=ge(e),function(){if(--e<1)return i.apply(this,arguments)}}function el(e,i,o){return i=o?r:i,i=e&&i==null?e.length:i,Or(e,U,r,r,r,r,i)}function tl(e,i){var o;if(typeof i!="function")throw new Kt(h);return e=ge(e),function(){return--e>0&&(o=i.apply(this,arguments)),e<=1&&(i=r),o}}var ac=ve(function(e,i,o){var c=V;if(o.length){var l=Qr(o,sn(ac));c|=re}return Or(e,c,i,o,l)}),rl=ve(function(e,i,o){var c=V|ee;if(o.length){var l=Qr(o,sn(rl));c|=re}return Or(i,c,e,o,l)});function il(e,i,o){i=o?r:i;var c=Or(e,B,r,r,r,r,r,i);return c.placeholder=il.placeholder,c}function nl(e,i,o){i=o?r:i;var c=Or(e,J,r,r,r,r,r,i);return c.placeholder=nl.placeholder,c}function sl(e,i,o){var c,l,g,w,b,S,D=0,F=!1,j=!1,k=!0;if(typeof e!="function")throw new Kt(h);i=Yt(i)||0,Le(o)&&(F=!!o.leading,j="maxWait"in o,g=j?Ze(Yt(o.maxWait)||0,i):g,k="trailing"in o?!!o.trailing:k);function X(Ke){var sr=c,Dr=l;return c=l=r,D=Ke,w=e.apply(Dr,sr),w}function oe(Ke){return D=Ke,b=Ln(_e,i),F?X(Ke):w}function ye(Ke){var sr=Ke-S,Dr=Ke-D,Pl=i-sr;return j?ht(Pl,g-Dr):Pl}function ae(Ke){var sr=Ke-S,Dr=Ke-D;return S===r||sr>=i||sr<0||j&&Dr>=g}function _e(){var Ke=fo();if(ae(Ke))return Pe(Ke);b=Ln(_e,ye(Ke))}function Pe(Ke){return b=r,k&&c?X(Ke):(c=l=r,w)}function zt(){b!==r&&gh(b),D=0,c=S=l=b=r}function vt(){return b===r?w:Pe(fo())}function Lt(){var Ke=fo(),sr=ae(Ke);if(c=arguments,l=this,S=Ke,sr){if(b===r)return oe(S);if(j)return gh(b),b=Ln(_e,i),X(S)}return b===r&&(b=Ln(_e,i)),w}return Lt.cancel=zt,Lt.flush=vt,Lt}var wv=ve(function(e,i){return Wu(e,1,i)}),bv=ve(function(e,i,o){return Wu(e,Yt(i)||0,o)});function _v(e){return Or(e,Q)}function po(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Kt(h);var o=function(){var c=arguments,l=i?i.apply(this,c):c[0],g=o.cache;if(g.has(l))return g.get(l);var w=e.apply(this,c);return o.cache=g.set(l,w)||g,w};return o.cache=new(po.Cache||Ar),o}po.Cache=Ar;function go(e){if(typeof e!="function")throw new Kt(h);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function Ev(e){return tl(2,e)}var Iv=uy(function(e,i){i=i.length==1&&pe(i[0])?Be(i[0],qt(ne())):Be(ot(i,1),qt(ne()));var o=i.length;return ve(function(c){for(var l=-1,g=ht(c.length,o);++l<g;)c[l]=i[l].call(this,c[l]);return et(e,this,c)})}),cc=ve(function(e,i){var o=Qr(i,sn(cc));return Or(e,re,r,i,o)}),ol=ve(function(e,i){var o=Qr(i,sn(ol));return Or(e,T,r,i,o)}),Pv=$r(function(e,i){return Or(e,H,r,r,r,i)});function xv(e,i){if(typeof e!="function")throw new Kt(h);return i=i===r?i:ge(i),ve(e,i)}function Sv(e,i){if(typeof e!="function")throw new Kt(h);return i=i==null?0:Ze(ge(i),0),ve(function(o){var c=o[i],l=ti(o,0,i);return c&&Jr(l,c),et(e,this,l)})}function Av(e,i,o){var c=!0,l=!0;if(typeof e!="function")throw new Kt(h);return Le(o)&&(c="leading"in o?!!o.leading:c,l="trailing"in o?!!o.trailing:l),sl(e,i,{leading:c,maxWait:i,trailing:l})}function Rv(e){return el(e,1)}function Ov(e,i){return cc(Ka(i),e)}function $v(){if(!arguments.length)return[];var e=arguments[0];return pe(e)?e:[e]}function Cv(e){return Wt(e,$)}function Tv(e,i){return i=typeof i=="function"?i:r,Wt(e,$,i)}function Nv(e){return Wt(e,_|$)}function Dv(e,i){return i=typeof i=="function"?i:r,Wt(e,_|$,i)}function Fv(e,i){return i==null||Gu(e,i,tt(i))}function nr(e,i){return e===i||e!==e&&i!==i}var qv=oo(Da),jv=oo(function(e,i){return e>=i}),Pi=Xu(function(){return arguments}())?Xu:function(e){return Me(e)&&Oe.call(e,"callee")&&!zu.call(e,"callee")},pe=O.isArray,Bv=gt?qt(gt):Kg;function _t(e){return e!=null&&yo(e.length)&&!Tr(e)}function Ve(e){return Me(e)&&_t(e)}function zv(e){return e===!0||e===!1||Me(e)&&yt(e)==Fe}var ri=Xd||wc,Lv=tr?qt(tr):Gg;function Uv(e){return Me(e)&&e.nodeType===1&&!Un(e)}function Mv(e){if(e==null)return!0;if(_t(e)&&(pe(e)||typeof e=="string"||typeof e.splice=="function"||ri(e)||on(e)||Pi(e)))return!e.length;var i=lt(e);if(i==nt||i==st)return!e.size;if(zn(e))return!ja(e).length;for(var o in e)if(Oe.call(e,o))return!1;return!0}function Hv(e,i){return qn(e,i)}function kv(e,i,o){o=typeof o=="function"?o:r;var c=o?o(e,i):r;return c===r?qn(e,i,r,o):!!c}function uc(e){if(!Me(e))return!1;var i=yt(e);return i==dt||i==Tt||typeof e.message=="string"&&typeof e.name=="string"&&!Un(e)}function Vv(e){return typeof e=="number"&&Uu(e)}function Tr(e){if(!Le(e))return!1;var i=yt(e);return i==Nt||i==kr||i==Ct||i==Ti}function al(e){return typeof e=="number"&&e==ge(e)}function yo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=M}function Le(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function Me(e){return e!=null&&typeof e=="object"}var cl=kt?qt(kt):Jg;function Kv(e,i){return e===i||qa(e,i,Xa(i))}function Gv(e,i,o){return o=typeof o=="function"?o:r,qa(e,i,Xa(i),o)}function Wv(e){return ul(e)&&e!=+e}function Jv(e){if(Ty(e))throw new le(u);return eh(e)}function Qv(e){return e===null}function Yv(e){return e==null}function ul(e){return typeof e=="number"||Me(e)&&yt(e)==br}function Un(e){if(!Me(e)||yt(e)!=Dt)return!1;var i=Ms(e);if(i===null)return!0;var o=Oe.call(i,"constructor")&&i.constructor;return typeof o=="function"&&o instanceof o&&Bs.call(o)==Gd}var hc=dr?qt(dr):Qg;function Zv(e){return al(e)&&e>=-9007199254740991&&e<=M}var hl=Sn?qt(Sn):Yg;function mo(e){return typeof e=="string"||!pe(e)&&Me(e)&&yt(e)==lr}function Bt(e){return typeof e=="symbol"||Me(e)&&yt(e)==_r}var on=yi?qt(yi):Zg;function Xv(e){return e===r}function ew(e){return Me(e)&&lt(e)==fr}function tw(e){return Me(e)&&yt(e)==Di}var rw=oo(Ba),iw=oo(function(e,i){return e<=i});function ll(e){if(!e)return[];if(_t(e))return mo(e)?rr(e):bt(e);if(Rn&&e[Rn])return Fd(e[Rn]());var i=lt(e),o=i==nt?xa:i==st?Fs:an;return o(e)}function Nr(e){if(!e)return e===0?e:0;if(e=Yt(e),e===z||e===-1/0){var i=e<0?-1:1;return i*Y}return e===e?e:0}function ge(e){var i=Nr(e),o=i%1;return i===i?o?i-o:i:0}function fl(e){return e?bi(ge(e),0,se):0}function Yt(e){if(typeof e=="number")return e;if(Bt(e))return L;if(Le(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=Le(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=Cu(e);var o=ea.test(e);return o||ra.test(e)?fe(e.slice(2),o?2:8):Xo.test(e)?L:+e}function pl(e){return yr(e,Et(e))}function nw(e){return e?bi(ge(e),-9007199254740991,M):e===0?e:0}function Re(e){return e==null?"":jt(e)}var sw=rn(function(e,i){if(zn(i)||_t(i)){yr(i,tt(i),e);return}for(var o in i)Oe.call(i,o)&&Nn(e,o,i[o])}),dl=rn(function(e,i){yr(i,Et(i),e)}),vo=rn(function(e,i,o,c){yr(i,Et(i),e,c)}),ow=rn(function(e,i,o,c){yr(i,tt(i),e,c)}),aw=$r(Ca);function cw(e,i){var o=tn(e);return i==null?o:Ku(o,i)}var uw=ve(function(e,i){e=De(e);var o=-1,c=i.length,l=c>2?i[2]:r;for(l&&mt(i[0],i[1],l)&&(c=1);++o<c;)for(var g=i[o],w=Et(g),b=-1,S=w.length;++b<S;){var D=w[b],F=e[D];(F===r||nr(F,Zi[D])&&!Oe.call(e,D))&&(e[D]=g[D])}return e}),hw=ve(function(e){return e.push(r,Ch),et(gl,r,e)});function lw(e,i){return Au(e,ne(i,3),gr)}function fw(e,i){return Au(e,ne(i,3),Na)}function pw(e,i){return e==null?e:Ta(e,ne(i,3),Et)}function dw(e,i){return e==null?e:Yu(e,ne(i,3),Et)}function gw(e,i){return e&&gr(e,ne(i,3))}function yw(e,i){return e&&Na(e,ne(i,3))}function mw(e){return e==null?[]:Zs(e,tt(e))}function vw(e){return e==null?[]:Zs(e,Et(e))}function lc(e,i,o){var c=e==null?r:_i(e,i);return c===r?o:c}function ww(e,i){return e!=null&&Dh(e,i,Mg)}function fc(e,i){return e!=null&&Dh(e,i,Hg)}var bw=Sh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=zs.call(i)),e[i]=o},dc(It)),_w=Sh(function(e,i,o){i!=null&&typeof i.toString!="function"&&(i=zs.call(i)),Oe.call(e,i)?e[i].push(o):e[i]=[o]},ne),Ew=ve(Fn);function tt(e){return _t(e)?ku(e):ja(e)}function Et(e){return _t(e)?ku(e,!0):Xg(e)}function Iw(e,i){var o={};return i=ne(i,3),gr(e,function(c,l,g){Rr(o,i(c,l,g),c)}),o}function Pw(e,i){var o={};return i=ne(i,3),gr(e,function(c,l,g){Rr(o,l,i(c,l,g))}),o}var xw=rn(function(e,i,o){Xs(e,i,o)}),gl=rn(function(e,i,o,c){Xs(e,i,o,c)}),Sw=$r(function(e,i){var o={};if(e==null)return o;var c=!1;i=Be(i,function(g){return g=ei(g,e),c||(c=g.length>1),g}),yr(e,Ya(e),o),c&&(o=Wt(o,_|I|$,by));for(var l=i.length;l--;)Ha(o,i[l]);return o});function Aw(e,i){return yl(e,go(ne(i)))}var Rw=$r(function(e,i){return e==null?{}:ty(e,i)});function yl(e,i){if(e==null)return{};var o=Be(Ya(e),function(c){return[c]});return i=ne(i),ah(e,o,function(c,l){return i(c,l[0])})}function Ow(e,i,o){i=ei(i,e);var c=-1,l=i.length;for(l||(l=1,e=r);++c<l;){var g=e==null?r:e[mr(i[c])];g===r&&(c=l,g=o),e=Tr(g)?g.call(e):g}return e}function $w(e,i,o){return e==null?e:jn(e,i,o)}function Cw(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:jn(e,i,o,c)}var ml=Oh(tt),vl=Oh(Et);function Tw(e,i,o){var c=pe(e),l=c||ri(e)||on(e);if(i=ne(i,4),o==null){var g=e&&e.constructor;l?o=c?new g:[]:Le(e)?o=Tr(g)?tn(Ms(e)):{}:o={}}return(l?Vt:gr)(e,function(w,b,S){return i(o,w,b,S)}),o}function Nw(e,i){return e==null?!0:Ha(e,i)}function Dw(e,i,o){return e==null?e:fh(e,i,Ka(o))}function Fw(e,i,o,c){return c=typeof c=="function"?c:r,e==null?e:fh(e,i,Ka(o),c)}function an(e){return e==null?[]:Pa(e,tt(e))}function qw(e){return e==null?[]:Pa(e,Et(e))}function jw(e,i,o){return o===r&&(o=i,i=r),o!==r&&(o=Yt(o),o=o===o?o:0),i!==r&&(i=Yt(i),i=i===i?i:0),bi(Yt(e),i,o)}function Bw(e,i,o){return i=Nr(i),o===r?(o=i,i=0):o=Nr(o),e=Yt(e),kg(e,i,o)}function zw(e,i,o){if(o&&typeof o!="boolean"&&mt(e,i,o)&&(i=o=r),o===r&&(typeof i=="boolean"?(o=i,i=r):typeof e=="boolean"&&(o=e,e=r)),e===r&&i===r?(e=0,i=1):(e=Nr(e),i===r?(i=e,e=0):i=Nr(i)),e>i){var c=e;e=i,i=c}if(o||e%1||i%1){var l=Mu();return ht(e+l*(i-e+Te("1e-"+((l+"").length-1))),i)}return La(e,i)}var Lw=nn(function(e,i,o){return i=i.toLowerCase(),e+(o?wl(i):i)});function wl(e){return pc(Re(e).toLowerCase())}function bl(e){return e=Re(e),e&&e.replace(Pr,$d).replace(ga,"")}function Uw(e,i,o){e=Re(e),i=jt(i);var c=e.length;o=o===r?c:bi(ge(o),0,c);var l=o;return o-=i.length,o>=0&&e.slice(o,l)==i}function Mw(e){return e=Re(e),e&&hi.test(e)?e.replace(fs,Cd):e}function Hw(e){return e=Re(e),e&&Go.test(e)?e.replace(bn,"\\$&"):e}var kw=nn(function(e,i,o){return e+(o?"-":"")+i.toLowerCase()}),Vw=nn(function(e,i,o){return e+(o?" ":"")+i.toLowerCase()}),Kw=Ih("toLowerCase");function Gw(e,i,o){e=Re(e),i=ge(i);var c=i?Qi(e):0;if(!i||c>=i)return e;var l=(i-c)/2;return so(Ks(l),o)+e+so(Vs(l),o)}function Ww(e,i,o){e=Re(e),i=ge(i);var c=i?Qi(e):0;return i&&c<i?e+so(i-c,o):e}function Jw(e,i,o){e=Re(e),i=ge(i);var c=i?Qi(e):0;return i&&c<i?so(i-c,o)+e:e}function Qw(e,i,o){return o||i==null?i=0:i&&(i=+i),ig(Re(e).replace(_n,""),i||0)}function Yw(e,i,o){return(o?mt(e,i,o):i===r)?i=1:i=ge(i),Ua(Re(e),i)}function Zw(){var e=arguments,i=Re(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var Xw=nn(function(e,i,o){return e+(o?"_":"")+i.toLowerCase()});function eb(e,i,o){return o&&typeof o!="number"&&mt(e,i,o)&&(i=o=r),o=o===r?se:o>>>0,o?(e=Re(e),e&&(typeof i=="string"||i!=null&&!hc(i))&&(i=jt(i),!i&&Ji(e))?ti(rr(e),0,o):e.split(i,o)):[]}var tb=nn(function(e,i,o){return e+(o?" ":"")+pc(i)});function rb(e,i,o){return e=Re(e),o=o==null?0:bi(ge(o),0,e.length),i=jt(i),e.slice(o,o+i.length)==i}function ib(e,i,o){var c=f.templateSettings;o&&mt(e,i,o)&&(i=r),e=Re(e),i=vo({},i,c,$h);var l=vo({},i.imports,c.imports,$h),g=tt(l),w=Pa(l,g),b,S,D=0,F=i.interpolate||Ui,j="__p += '",k=Sa((i.escape||Ui).source+"|"+F.source+"|"+(F===Li?Zo:Ui).source+"|"+(i.evaluate||Ui).source+"|$","g"),X="//# sourceURL="+(Oe.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ya+"]")+`
`;e.replace(k,function(ae,_e,Pe,zt,vt,Lt){return Pe||(Pe=zt),j+=e.slice(D,Lt).replace(na,Td),_e&&(b=!0,j+=`' +
__e(`+_e+`) +
'`),vt&&(S=!0,j+=`';
`+vt+`;
__p += '`),Pe&&(j+=`' +
((__t = (`+Pe+`)) == null ? '' : __t) +
'`),D=Lt+ae.length,ae}),j+=`';
`;var oe=Oe.call(i,"variable")&&i.variable;if(!oe)j=`with (obj) {
`+j+`
}
`;else if(Qo.test(oe))throw new le(p);j=(S?j.replace(ko,""):j).replace(Er,"$1").replace(hs,"$1;"),j="function("+(oe||"obj")+`) {
`+(oe?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(b?", __e = _.escape":"")+(S?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+j+`return __p
}`;var ye=El(function(){return Ae(g,X+"return "+j).apply(r,w)});if(ye.source=j,uc(ye))throw ye;return ye}function nb(e){return Re(e).toLowerCase()}function sb(e){return Re(e).toUpperCase()}function ob(e,i,o){if(e=Re(e),e&&(o||i===r))return Cu(e);if(!e||!(i=jt(i)))return e;var c=rr(e),l=rr(i),g=Tu(c,l),w=Nu(c,l)+1;return ti(c,g,w).join("")}function ab(e,i,o){if(e=Re(e),e&&(o||i===r))return e.slice(0,Fu(e)+1);if(!e||!(i=jt(i)))return e;var c=rr(e),l=Nu(c,rr(i))+1;return ti(c,0,l).join("")}function cb(e,i,o){if(e=Re(e),e&&(o||i===r))return e.replace(_n,"");if(!e||!(i=jt(i)))return e;var c=rr(e),l=Tu(c,rr(i));return ti(c,l).join("")}function ub(e,i){var o=ue,c=be;if(Le(i)){var l="separator"in i?i.separator:l;o="length"in i?ge(i.length):o,c="omission"in i?jt(i.omission):c}e=Re(e);var g=e.length;if(Ji(e)){var w=rr(e);g=w.length}if(o>=g)return e;var b=o-Qi(c);if(b<1)return c;var S=w?ti(w,0,b).join(""):e.slice(0,b);if(l===r)return S+c;if(w&&(b+=S.length-b),hc(l)){if(e.slice(b).search(l)){var D,F=S;for(l.global||(l=Sa(l.source,Re(Ht.exec(l))+"g")),l.lastIndex=0;D=l.exec(F);)var j=D.index;S=S.slice(0,j===r?b:j)}}else if(e.indexOf(jt(l),b)!=b){var k=S.lastIndexOf(l);k>-1&&(S=S.slice(0,k))}return S+c}function hb(e){return e=Re(e),e&&mn.test(e)?e.replace(ls,zd):e}var lb=nn(function(e,i,o){return e+(o?" ":"")+i.toUpperCase()}),pc=Ih("toUpperCase");function _l(e,i,o){return e=Re(e),i=o?r:i,i===r?Dd(e)?Md(e):xd(e):e.match(i)||[]}var El=ve(function(e,i){try{return et(e,r,i)}catch(o){return uc(o)?o:new le(o)}}),fb=$r(function(e,i){return Vt(i,function(o){o=mr(o),Rr(e,o,ac(e[o],e))}),e});function pb(e){var i=e==null?0:e.length,o=ne();return e=i?Be(e,function(c){if(typeof c[1]!="function")throw new Kt(h);return[o(c[0]),c[1]]}):[],ve(function(c){for(var l=-1;++l<i;){var g=e[l];if(et(g[0],this,c))return et(g[1],this,c)}})}function db(e){return zg(Wt(e,_))}function dc(e){return function(){return e}}function gb(e,i){return e==null||e!==e?i:e}var yb=xh(),mb=xh(!0);function It(e){return e}function gc(e){return th(typeof e=="function"?e:Wt(e,_))}function vb(e){return ih(Wt(e,_))}function wb(e,i){return nh(e,Wt(i,_))}var bb=ve(function(e,i){return function(o){return Fn(o,e,i)}}),_b=ve(function(e,i){return function(o){return Fn(e,o,i)}});function yc(e,i,o){var c=tt(i),l=Zs(i,c);o==null&&!(Le(i)&&(l.length||!c.length))&&(o=i,i=e,e=this,l=Zs(i,tt(i)));var g=!(Le(o)&&"chain"in o)||!!o.chain,w=Tr(e);return Vt(l,function(b){var S=i[b];e[b]=S,w&&(e.prototype[b]=function(){var D=this.__chain__;if(g||D){var F=e(this.__wrapped__),j=F.__actions__=bt(this.__actions__);return j.push({func:S,args:arguments,thisArg:e}),F.__chain__=D,F}return S.apply(e,Jr([this.value()],arguments))})}),e}function Eb(){return Ie._===this&&(Ie._=Wd),this}function mc(){}function Ib(e){return e=ge(e),ve(function(i){return sh(i,e)})}var Pb=Wa(Be),xb=Wa(Su),Sb=Wa(wa);function Il(e){return tc(e)?ba(mr(e)):ry(e)}function Ab(e){return function(i){return e==null?r:_i(e,i)}}var Rb=Ah(),Ob=Ah(!0);function vc(){return[]}function wc(){return!1}function $b(){return{}}function Cb(){return""}function Tb(){return!0}function Nb(e,i){if(e=ge(e),e<1||e>M)return[];var o=se,c=ht(e,se);i=ne(i),e-=se;for(var l=Ia(c,i);++o<e;)i(o);return l}function Db(e){return pe(e)?Be(e,mr):Bt(e)?[e]:bt(Hh(Re(e)))}function Fb(e){var i=++Kd;return Re(e)+i}var qb=no(function(e,i){return e+i},0),jb=Ja("ceil"),Bb=no(function(e,i){return e/i},1),zb=Ja("floor");function Lb(e){return e&&e.length?Ys(e,It,Da):r}function Ub(e,i){return e&&e.length?Ys(e,ne(i,2),Da):r}function Mb(e){return Ou(e,It)}function Hb(e,i){return Ou(e,ne(i,2))}function kb(e){return e&&e.length?Ys(e,It,Ba):r}function Vb(e,i){return e&&e.length?Ys(e,ne(i,2),Ba):r}var Kb=no(function(e,i){return e*i},1),Gb=Ja("round"),Wb=no(function(e,i){return e-i},0);function Jb(e){return e&&e.length?Ea(e,It):0}function Qb(e,i){return e&&e.length?Ea(e,ne(i,2)):0}return f.after=vv,f.ary=el,f.assign=sw,f.assignIn=dl,f.assignInWith=vo,f.assignWith=ow,f.at=aw,f.before=tl,f.bind=ac,f.bindAll=fb,f.bindKey=rl,f.castArray=$v,f.chain=Yh,f.chunk=zy,f.compact=Ly,f.concat=Uy,f.cond=pb,f.conforms=db,f.constant=dc,f.countBy=Jm,f.create=cw,f.curry=il,f.curryRight=nl,f.debounce=sl,f.defaults=uw,f.defaultsDeep=hw,f.defer=wv,f.delay=bv,f.difference=My,f.differenceBy=Hy,f.differenceWith=ky,f.drop=Vy,f.dropRight=Ky,f.dropRightWhile=Gy,f.dropWhile=Wy,f.fill=Jy,f.filter=Ym,f.flatMap=ev,f.flatMapDeep=tv,f.flatMapDepth=rv,f.flatten=Gh,f.flattenDeep=Qy,f.flattenDepth=Yy,f.flip=_v,f.flow=yb,f.flowRight=mb,f.fromPairs=Zy,f.functions=mw,f.functionsIn=vw,f.groupBy=iv,f.initial=em,f.intersection=tm,f.intersectionBy=rm,f.intersectionWith=im,f.invert=bw,f.invertBy=_w,f.invokeMap=sv,f.iteratee=gc,f.keyBy=ov,f.keys=tt,f.keysIn=Et,f.map=lo,f.mapKeys=Iw,f.mapValues=Pw,f.matches=vb,f.matchesProperty=wb,f.memoize=po,f.merge=xw,f.mergeWith=gl,f.method=bb,f.methodOf=_b,f.mixin=yc,f.negate=go,f.nthArg=Ib,f.omit=Sw,f.omitBy=Aw,f.once=Ev,f.orderBy=av,f.over=Pb,f.overArgs=Iv,f.overEvery=xb,f.overSome=Sb,f.partial=cc,f.partialRight=ol,f.partition=cv,f.pick=Rw,f.pickBy=yl,f.property=Il,f.propertyOf=Ab,f.pull=am,f.pullAll=Jh,f.pullAllBy=cm,f.pullAllWith=um,f.pullAt=hm,f.range=Rb,f.rangeRight=Ob,f.rearg=Pv,f.reject=lv,f.remove=lm,f.rest=xv,f.reverse=sc,f.sampleSize=pv,f.set=$w,f.setWith=Cw,f.shuffle=dv,f.slice=fm,f.sortBy=mv,f.sortedUniq=wm,f.sortedUniqBy=bm,f.split=eb,f.spread=Sv,f.tail=_m,f.take=Em,f.takeRight=Im,f.takeRightWhile=Pm,f.takeWhile=xm,f.tap=Lm,f.throttle=Av,f.thru=ho,f.toArray=ll,f.toPairs=ml,f.toPairsIn=vl,f.toPath=Db,f.toPlainObject=pl,f.transform=Tw,f.unary=Rv,f.union=Sm,f.unionBy=Am,f.unionWith=Rm,f.uniq=Om,f.uniqBy=$m,f.uniqWith=Cm,f.unset=Nw,f.unzip=oc,f.unzipWith=Qh,f.update=Dw,f.updateWith=Fw,f.values=an,f.valuesIn=qw,f.without=Tm,f.words=_l,f.wrap=Ov,f.xor=Nm,f.xorBy=Dm,f.xorWith=Fm,f.zip=qm,f.zipObject=jm,f.zipObjectDeep=Bm,f.zipWith=zm,f.entries=ml,f.entriesIn=vl,f.extend=dl,f.extendWith=vo,yc(f,f),f.add=qb,f.attempt=El,f.camelCase=Lw,f.capitalize=wl,f.ceil=jb,f.clamp=jw,f.clone=Cv,f.cloneDeep=Nv,f.cloneDeepWith=Dv,f.cloneWith=Tv,f.conformsTo=Fv,f.deburr=bl,f.defaultTo=gb,f.divide=Bb,f.endsWith=Uw,f.eq=nr,f.escape=Mw,f.escapeRegExp=Hw,f.every=Qm,f.find=Zm,f.findIndex=Vh,f.findKey=lw,f.findLast=Xm,f.findLastIndex=Kh,f.findLastKey=fw,f.floor=zb,f.forEach=Zh,f.forEachRight=Xh,f.forIn=pw,f.forInRight=dw,f.forOwn=gw,f.forOwnRight=yw,f.get=lc,f.gt=qv,f.gte=jv,f.has=ww,f.hasIn=fc,f.head=Wh,f.identity=It,f.includes=nv,f.indexOf=Xy,f.inRange=Bw,f.invoke=Ew,f.isArguments=Pi,f.isArray=pe,f.isArrayBuffer=Bv,f.isArrayLike=_t,f.isArrayLikeObject=Ve,f.isBoolean=zv,f.isBuffer=ri,f.isDate=Lv,f.isElement=Uv,f.isEmpty=Mv,f.isEqual=Hv,f.isEqualWith=kv,f.isError=uc,f.isFinite=Vv,f.isFunction=Tr,f.isInteger=al,f.isLength=yo,f.isMap=cl,f.isMatch=Kv,f.isMatchWith=Gv,f.isNaN=Wv,f.isNative=Jv,f.isNil=Yv,f.isNull=Qv,f.isNumber=ul,f.isObject=Le,f.isObjectLike=Me,f.isPlainObject=Un,f.isRegExp=hc,f.isSafeInteger=Zv,f.isSet=hl,f.isString=mo,f.isSymbol=Bt,f.isTypedArray=on,f.isUndefined=Xv,f.isWeakMap=ew,f.isWeakSet=tw,f.join=nm,f.kebabCase=kw,f.last=Qt,f.lastIndexOf=sm,f.lowerCase=Vw,f.lowerFirst=Kw,f.lt=rw,f.lte=iw,f.max=Lb,f.maxBy=Ub,f.mean=Mb,f.meanBy=Hb,f.min=kb,f.minBy=Vb,f.stubArray=vc,f.stubFalse=wc,f.stubObject=$b,f.stubString=Cb,f.stubTrue=Tb,f.multiply=Kb,f.nth=om,f.noConflict=Eb,f.noop=mc,f.now=fo,f.pad=Gw,f.padEnd=Ww,f.padStart=Jw,f.parseInt=Qw,f.random=zw,f.reduce=uv,f.reduceRight=hv,f.repeat=Yw,f.replace=Zw,f.result=Ow,f.round=Gb,f.runInContext=x,f.sample=fv,f.size=gv,f.snakeCase=Xw,f.some=yv,f.sortedIndex=pm,f.sortedIndexBy=dm,f.sortedIndexOf=gm,f.sortedLastIndex=ym,f.sortedLastIndexBy=mm,f.sortedLastIndexOf=vm,f.startCase=tb,f.startsWith=rb,f.subtract=Wb,f.sum=Jb,f.sumBy=Qb,f.template=ib,f.times=Nb,f.toFinite=Nr,f.toInteger=ge,f.toLength=fl,f.toLower=nb,f.toNumber=Yt,f.toSafeInteger=nw,f.toString=Re,f.toUpper=sb,f.trim=ob,f.trimEnd=ab,f.trimStart=cb,f.truncate=ub,f.unescape=hb,f.uniqueId=Fb,f.upperCase=lb,f.upperFirst=pc,f.each=Zh,f.eachRight=Xh,f.first=Wh,yc(f,function(){var e={};return gr(f,function(i,o){Oe.call(f.prototype,o)||(e[o]=i)}),e}(),{chain:!1}),f.VERSION=n,Vt(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){f[e].placeholder=f}),Vt(["drop","take"],function(e,i){Ee.prototype[e]=function(o){o=o===r?1:Ze(ge(o),0);var c=this.__filtered__&&!i?new Ee(this):this.clone();return c.__filtered__?c.__takeCount__=ht(o,c.__takeCount__):c.__views__.push({size:ht(o,se),type:e+(c.__dir__<0?"Right":"")}),c},Ee.prototype[e+"Right"]=function(o){return this.reverse()[e](o).reverse()}}),Vt(["filter","map","takeWhile"],function(e,i){var o=i+1,c=o==te||o==A;Ee.prototype[e]=function(l){var g=this.clone();return g.__iteratees__.push({iteratee:ne(l,3),type:o}),g.__filtered__=g.__filtered__||c,g}}),Vt(["head","last"],function(e,i){var o="take"+(i?"Right":"");Ee.prototype[e]=function(){return this[o](1).value()[0]}}),Vt(["initial","tail"],function(e,i){var o="drop"+(i?"":"Right");Ee.prototype[e]=function(){return this.__filtered__?new Ee(this):this[o](1)}}),Ee.prototype.compact=function(){return this.filter(It)},Ee.prototype.find=function(e){return this.filter(e).head()},Ee.prototype.findLast=function(e){return this.reverse().find(e)},Ee.prototype.invokeMap=ve(function(e,i){return typeof e=="function"?new Ee(this):this.map(function(o){return Fn(o,e,i)})}),Ee.prototype.reject=function(e){return this.filter(go(ne(e)))},Ee.prototype.slice=function(e,i){e=ge(e);var o=this;return o.__filtered__&&(e>0||i<0)?new Ee(o):(e<0?o=o.takeRight(-e):e&&(o=o.drop(e)),i!==r&&(i=ge(i),o=i<0?o.dropRight(-i):o.take(i-e)),o)},Ee.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Ee.prototype.toArray=function(){return this.take(se)},gr(Ee.prototype,function(e,i){var o=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),l=f[c?"take"+(i=="last"?"Right":""):i],g=c||/^find/.test(i);l&&(f.prototype[i]=function(){var w=this.__wrapped__,b=c?[1]:arguments,S=w instanceof Ee,D=b[0],F=S||pe(w),j=function(_e){var Pe=l.apply(f,Jr([_e],b));return c&&k?Pe[0]:Pe};F&&o&&typeof D=="function"&&D.length!=1&&(S=F=!1);var k=this.__chain__,X=!!this.__actions__.length,oe=g&&!k,ye=S&&!X;if(!g&&F){w=ye?w:new Ee(this);var ae=e.apply(w,b);return ae.__actions__.push({func:ho,args:[j],thisArg:r}),new Gt(ae,k)}return oe&&ye?e.apply(this,b):(ae=this.thru(j),oe?c?ae.value()[0]:ae.value():ae)})}),Vt(["pop","push","shift","sort","splice","unshift"],function(e){var i=qs[e],o=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);f.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var g=this.value();return i.apply(pe(g)?g:[],l)}return this[o](function(w){return i.apply(pe(w)?w:[],l)})}}),gr(Ee.prototype,function(e,i){var o=f[i];if(o){var c=o.name+"";Oe.call(en,c)||(en[c]=[]),en[c].push({name:i,func:o})}}),en[io(r,ee).name]=[{name:"wrapper",func:r}],Ee.prototype.clone=hg,Ee.prototype.reverse=lg,Ee.prototype.value=fg,f.prototype.at=Um,f.prototype.chain=Mm,f.prototype.commit=Hm,f.prototype.next=km,f.prototype.plant=Km,f.prototype.reverse=Gm,f.prototype.toJSON=f.prototype.valueOf=f.prototype.value=Wm,f.prototype.first=f.prototype.head,Rn&&(f.prototype[Rn]=Vm),f},Yi=Hd();ke?((ke.exports=Yi)._=Yi,Ne._=Yi):Ie._=Yi}).call(Jn)})(su,su.exports);var _S=Object.defineProperty,ES=Object.defineProperties,IS=Object.getOwnPropertyDescriptors,Zf=Object.getOwnPropertySymbols,PS=Object.prototype.hasOwnProperty,xS=Object.prototype.propertyIsEnumerable,Xf=(s,t,r)=>t in s?_S(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Ao=(s,t)=>{for(var r in t||(t={}))PS.call(t,r)&&Xf(s,r,t[r]);if(Zf)for(var r of Zf(t))xS.call(t,r)&&Xf(s,r,t[r]);return s},SS=(s,t)=>ES(s,IS(t));function ci(s,t,r){var n;const a=F0(s);return((n=t.rpcMap)==null?void 0:n[a.reference])||`${bS}?chainId=${a.namespace}:${a.reference}&projectId=${r}`}function $i(s){return s.includes(":")?s.split(":")[1]:s}function vd(s){return s.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function AS(s,t){const r=Object.keys(t.namespaces).filter(a=>a.includes(s));if(!r.length)return[];const n=[];return r.forEach(a=>{const u=t.namespaces[a].accounts;n.push(...u)}),n}function RS(s={},t={}){const r=ep(s),n=ep(t);return su.exports.merge(r,n)}function ep(s){var t,r,n,a;const u={};if(!$o(s))return u;for(const[h,p]of Object.entries(s)){const d=pp(h)?[h]:p.chains,y=p.methods||[],v=p.events||[],_=p.rpcMap||{},I=Qn(h);u[I]=SS(Ao(Ao({},u[I]),p),{chains:_c(d,(t=u[I])==null?void 0:t.chains),methods:_c(y,(r=u[I])==null?void 0:r.methods),events:_c(v,(n=u[I])==null?void 0:n.events),rpcMap:Ao(Ao({},_),(a=u[I])==null?void 0:a.rpcMap)})}return u}function OS(s){return s.includes(":")?s.split(":")[2]:s}function $S(s){const t={};for(const[r,n]of Object.entries(s)){const a=n.methods||[],u=n.events||[],h=n.accounts||[],p=pp(r)?[r]:n.chains?n.chains:vd(n.accounts);t[r]={chains:p,methods:a,events:u,accounts:h}}return t}function kc(s){return typeof s=="number"?s:s.includes("0x")?parseInt(s,16):s.includes(":")?Number(s.split(":")[1]):Number(s)}const wd={},ze=s=>wd[s],Vc=(s,t)=>{wd[s]=t};class CS{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=$i(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Mr(new ui(n,ze("disableProviderPing")))}}class TS{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=ze("events"),this.client=ze("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const n=r||ci(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Mr(new ui(n,ze("disableProviderPing")))}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=parseInt($i(r));t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,n;let a=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";a=a.startsWith("0x")?a:`0x${a}`;const u=parseInt(a,16);if(this.isChainApproved(u))this.setDefaultChain(`${u}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:a}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${u}`);else throw new Error(`Failed to switch to chain 'eip155:${u}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class NS{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=$i(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Mr(new ui(n,ze("disableProviderPing")))}}class DS{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=$i(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Mr(new ui(n,ze("disableProviderPing")))}}class FS{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),a=$i(r);t[a]=this.createHttpProvider(a,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Mr(new ui(n,ze("disableProviderPing")))}}class qS{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=$i(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Mr(new ui(n,ze("disableProviderPing")))}}class jS{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const a=$i(r);t[a]=this.createHttpProvider(a,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new Mr(new ui(n,ze("disableProviderPing")))}}class BS{constructor(t){this.name="near",this.namespace=t.namespace,this.events=ze("events"),this.client=ze("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const n=r||ci(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(Hr.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;t[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||ci(t,this.namespace);return typeof n>"u"?void 0:new Mr(new ui(n,ze("disableProviderPing")))}}var zS=Object.defineProperty,LS=Object.defineProperties,US=Object.getOwnPropertyDescriptors,tp=Object.getOwnPropertySymbols,MS=Object.prototype.hasOwnProperty,HS=Object.prototype.propertyIsEnumerable,rp=(s,t,r)=>t in s?zS(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Ro=(s,t)=>{for(var r in t||(t={}))MS.call(t,r)&&rp(s,r,t[r]);if(tp)for(var r of tp(t))HS.call(t,r)&&rp(s,r,t[r]);return s},Kc=(s,t)=>LS(s,US(t));class Pu{constructor(t){this.events=new cu,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:qo(jo({level:(t==null?void 0:t.logger)||Qf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new Pu(t);return await r.initialize(),r}async request(t,r){const[n,a]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:Ro({},t),chainId:`${n}:${a}`,topic:this.session.topic})}sendAsync(t,r,n){const a=new Date().getTime();this.request(t,n).then(u=>r(null,zo(a,u))).catch(u=>r(u,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:ft("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:a}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await a().then(u=>{this.session=u,this.namespaces||(this.namespaces=$S(u.namespaces),this.persist("namespaces",this.namespaces))}).catch(u=>{if(u.message!==yd)throw u;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[n,a]=this.validateChain(t);this.getProvider(n).setDefaultChain(a,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(dn(r)){for(const n of r)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await aS.init({logger:this.providerOpts.logger||Qf,relayUrl:this.providerOpts.relayUrl||mS,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Qn(r)))];Vc("client",this.client),Vc("events",this.events),Vc("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const n=AS(r,this.session),a=vd(n),u=RS(this.namespaces,this.optionalNamespaces),h=Kc(Ro({},u[r]),{accounts:n,chains:a});switch(r){case"eip155":this.rpcProviders[r]=new TS({namespace:h});break;case"solana":this.rpcProviders[r]=new NS({namespace:h});break;case"cosmos":this.rpcProviders[r]=new DS({namespace:h});break;case"polkadot":this.rpcProviders[r]=new CS({namespace:h});break;case"cip34":this.rpcProviders[r]=new FS({namespace:h});break;case"elrond":this.rpcProviders[r]=new qS({namespace:h});break;case"multiversx":this.rpcProviders[r]=new jS({namespace:h});break;case"near":this.rpcProviders[r]=new BS({namespace:h});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:n}=r;if(n.name==="accountsChanged"){const a=n.data;a&&dn(a)&&this.events.emit("accountsChanged",a.map(OS))}else if(n.name==="chainChanged"){const a=r.chainId,u=r.event.data,h=Qn(a),p=kc(a)!==kc(u)?`${h}:${kc(u)}`:a;this.onChainChanged(p)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var n;const{namespaces:a}=r,u=(n=this.client)==null?void 0:n.session.get(t);this.session=Kc(Ro({},u),{namespaces:a}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Kc(Ro({},ft("USER_DISCONNECTED")),{data:t.topic}))}),this.on(Hr.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:n,sessionProperties:a}=t;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=a,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(t){const[r,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(h=>Qn(h)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const a=Qn(Object.keys(this.namespaces)[0]),u=this.rpcProviders[a].getDefaultChain();return[a,u]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var n;if(!this.namespaces)return;const[a,u]=this.validateChain(t);r||this.getProvider(a).setDefaultChain(u),((n=this.namespaces[a])!=null?n:this.namespaces[`${a}:${u}`]).defaultChain=u,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",u)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${Yf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${Yf}/${t}`)}}const kS=Pu,VS="wc",KS="ethereum_provider",GS=`${VS}@2:${KS}:`,WS="https://rpc.walletconnect.com/v1/",ou=["eth_sendTransaction","personal_sign"],JS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],au=["chainChanged","accountsChanged"],QS=["chainChanged","accountsChanged","message","disconnect","connect"];var YS=Object.defineProperty,ZS=Object.defineProperties,XS=Object.getOwnPropertyDescriptors,ip=Object.getOwnPropertySymbols,eA=Object.prototype.hasOwnProperty,tA=Object.prototype.propertyIsEnumerable,np=(s,t,r)=>t in s?YS(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Xn=(s,t)=>{for(var r in t||(t={}))eA.call(t,r)&&np(s,r,t[r]);if(ip)for(var r of ip(t))tA.call(t,r)&&np(s,r,t[r]);return s},sp=(s,t)=>ZS(s,XS(t));function Fo(s){return Number(s[0].split(":")[1])}function Gc(s){return`0x${s.toString(16)}`}function rA(s){const{chains:t,optionalChains:r,methods:n,optionalMethods:a,events:u,optionalEvents:h,rpcMap:p}=s;if(!dn(t))throw new Error("Invalid chains");const d={chains:t,methods:n||ou,events:u||au,rpcMap:Xn({},t.length?{[Fo(t)]:p[Fo(t)]}:{})},y=u==null?void 0:u.filter($=>!au.includes($)),v=n==null?void 0:n.filter($=>!ou.includes($));if(!r&&!h&&!a&&!(y!=null&&y.length)&&!(v!=null&&v.length))return{required:t.length?d:void 0};const _=(y==null?void 0:y.length)&&(v==null?void 0:v.length)||!r,I={chains:[...new Set(_?d.chains.concat(r||[]):r)],methods:[...new Set(d.methods.concat(a!=null&&a.length?a:JS))],events:[...new Set(d.events.concat(h!=null&&h.length?h:QS))],rpcMap:p};return{required:t.length?d:void 0,optional:r.length?I:void 0}}class xu{constructor(){this.events=new Xt.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=GS,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new xu;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:n}=rA(this.rpc);try{const a=await new Promise(async(h,p)=>{var d;this.rpc.showQrModal&&((d=this.modal)==null||d.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),p(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(sp(Xn({namespaces:Xn({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(y=>{h(y)}).catch(y=>{p(new Error(y.message))})});if(!a)return;const u=q0(a.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:u),this.setAccounts(u),this.events.emit("connect",{chainId:Gc(this.chainId)})}catch(a){throw this.signer.logger.error(a),a}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",Gc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",sp(Xn({},ft("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",Gc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,n,a]=t.split(":");return{chainId:`${r}:${n}`,address:a}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,n;const a=(r=t==null?void 0:t.chains)!=null?r:[],u=(n=t==null?void 0:t.optionalChains)!=null?n:[],h=a.concat(u);if(!h.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const p=a.length?(t==null?void 0:t.methods)||ou:[],d=a.length?(t==null?void 0:t.events)||au:[],y=(t==null?void 0:t.optionalMethods)||[],v=(t==null?void 0:t.optionalEvents)||[],_=(t==null?void 0:t.rpcMap)||this.buildRpcMap(h,t.projectId),I=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:a==null?void 0:a.map($=>this.formatChainId($)),optionalChains:u.map($=>this.formatChainId($)),methods:p,events:d,optionalMethods:y,optionalEvents:v,rpcMap:_,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:I,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const n={};return t.forEach(a=>{n[a]=this.getRpcUrl(a,r)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?Fo(this.rpc.chains):Fo(this.rpc.optionalChains),this.signer=await kS.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await j0(()=>import("./index-DPkcjMKf.js").then(a=>a.i),__vite__mapDeps([0,1,2]));r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(Xn({projectId:this.rpc.projectId},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:n,rpcMap:a}=t;r&&dn(r)&&(this.rpc.chains=r.map(u=>this.formatChainId(u)),r.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)})),n&&dn(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(u=>this.formatChainId(u)),n.forEach(u=>{this.rpc.rpcMap[u]=(a==null?void 0:a[u])||this.getRpcUrl(u)}))}getRpcUrl(t,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${WS}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const xA=xu;export{xA as EthereumProvider,QS as OPTIONAL_EVENTS,JS as OPTIONAL_METHODS,au as REQUIRED_EVENTS,ou as REQUIRED_METHODS,xu as default};
